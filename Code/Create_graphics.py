import math

import numpy as np
from simulate_asgs import main, generate_graph, L_inf_dist, generate_potential_ancestors, type_graph
import matplotlib.pyplot as plt

#This block is used for the verification of mutation rates on the AL. This take 5 hours or so.
'''
from infinite import qA10, qA01

theta = 2
nus = [0.1, 0.9]
R=30000
repeats = 1000

dark_red = (0.4, 0, 0)
dark_green = (0, 0.4, 0)

calc_mut_to0 = []
calc_mut_to1 = []
sim_mut_to0 = []
sim_mut_to1 = []
calc_sigmas = [x/10 for x in range(5, 71, 1)]
for sigma in calc_sigmas:
    calc_mut_to0.append(qA10(theta, sigma, nus))
    calc_mut_to1.append(qA01(theta, sigma, nus))
sim_sigmas = [x/10 for x in range(5, 71, 5)]
for sigma in sim_sigmas:
    mut_rates = main([sigma,0],theta, R, nus, repeats, True)[4]
    sim_mut_to0.append(mut_rates[0])
    sim_mut_to1.append(mut_rates[1])

print(sim_mut_to0)
print(sim_mut_to1)

plt.plot(calc_sigmas, calc_mut_to0, color = dark_red, label = "to type 0")
plt.plot(sim_sigmas, sim_mut_to0, "x", color = dark_red)

plt.plot(calc_sigmas, calc_mut_to1, color = dark_green, label = "to type 1")
plt.plot(sim_sigmas, sim_mut_to1, "x", color = dark_green)
plt.xlim(calc_sigmas[0]-0.1, calc_sigmas[-1]+0.1)
plt.legend()
plt.xlabel("σ\u2080")
plt.ylabel("Mutation rate")
plt.show()

#sim_mut_to0 = [0.22659663629652985, 0.25757397099650986, 0.29322035177308164, 0.3332746134132398, 0.3792379373962845, 0.4313715535905451, 0.4906113789579069, 0.5564870465252483, 0.6332850570679892, 0.7180502757199737, 0.8174027482197319, 0.9319531689826073, 1.0636290346605553, 1.2208959717135504]
#sim_mut_to1 = [1.5796894518866362, 1.3882827426847177, 1.2101430444640766, 1.0512234606606494, 0.9079994222179794, 0.780903087039587, 0.665252979531654, 0.5659210316793527, 0.47780015646929747, 0.40229150541299546, 0.3376423845993594, 0.282415499407202, 0.23643692116917686, 0.19802833654742086]
'''


#This block creates a graphic for mutation rates2
'''
sigmass = [[],[],[],[],[]]
for sigma in [x/10 for x in range(50,101,1)]:
    sigmass[0].append(sigma)
    sigmass[1].append(sigma/2)
    sigmass[2].append(sigma/4)
    sigmass[3].append(sigma/10)
    sigmass[4].append(0)


theta = 6
nus = [0.01, 0.09, 0.2, 0.3, 0.4]
mut_ratess_AL = [[], [], [], [], []] # first index is type, second index is sigma.
mut_ratess = [[], [], [], [], []]
dark_red = (0.4, 0, 0)
bright_red = (0.9, 0.1, 0.1)

dark_green = (0, 0.4, 0)
bright_green = (0.1, 0.9, 0.1)

dark_blue = (0, 0, 0.4)
bright_blue = (0.2, 0.2, 1)

dark_yellow = (0.2, 0.2, 0)
bright_yellow = (0.8, 0.8, 0)

dark_purple = (0.2, 0, 0.4)
bright_purple = (0.7, 0.2, 1)



for j in range(len(sigmass[0])):
    sigmas =[sigmass[0][j], sigmass[1][j], sigmass[2][j], sigmass[3][j], sigmass[4][j]]
    _, _, _, _, mut_rates_AL, mut_rates = main(sigmas, theta, 10000, nus, 10, False)[:6]
    for i in range(len(mut_rates_AL)):
        mut_ratess_AL[i].append(mut_rates_AL[i])
        mut_ratess[i].append(mut_rates[i])


plt.xlabel("σ\u2080")
plt.ylabel("Mutation rate")
parameters = [(dark_red, bright_red), (dark_green, bright_green),(dark_blue, bright_blue),(dark_yellow, bright_yellow),(dark_purple, bright_purple)] #(colour AL, colour graph)
for i in range(len(parameters)):
    graph_color, AL_color = parameters[i]
    plt.plot(sigmass[0], mut_ratess_AL[i], color = AL_color)
    if i == 2:
        plt.annotate("Type " + str(i) +" AL", xy=(sigmass[0][-1], mut_ratess_AL[i][-1]), xytext=(sigmass[0][-1] + 0.15, mut_ratess_AL[i][-1]-0.01), size=7, va="center", annotation_clip=False)
        plt.annotate("Type "+str(i)+" G", xy=(sigmass[0][-1], mut_ratess[i][-1]), xytext=(sigmass[0][-1]+0.15, mut_ratess[i][-1]+0.01), size=7, va="center", annotation_clip=False)
    else:
        plt.annotate("Type " + str(i) +" AL", xy=(sigmass[0][-1], mut_ratess_AL[i][-1]), xytext=(sigmass[0][-1] + 0.15, mut_ratess_AL[i][-1]), size=7, va="center", annotation_clip=False)
        plt.annotate("Type "+str(i)+" G", xy=(sigmass[0][-1], mut_ratess[i][-1]), xytext=(sigmass[0][-1]+0.15, mut_ratess[i][-1]), size=7, va="center", annotation_clip=False)

    plt.plot(sigmass[0], mut_ratess[i], color = graph_color)


plt.xlim(sigmass[0][0], sigmass[0][-1])
plt.show()

print(mut_ratess_AL)
print(mut_ratess)
#mut_ratess_AL = [[0.10964293195926372, 0.11165516039325667, 0.11180005735976965, 0.11536903658290974, 0.11452585247313106, 0.11751540093067078, 0.11874788418215582, 0.12054208807203821, 0.12236461068738134, 0.12418180488759208, 0.12550641034274537, 0.1278023185936554, 0.13102052170929473, 0.13118000213024505, 0.1312645509152756, 0.13403775240850827, 0.13421431008431237, 0.13719261647055914, 0.1397972448358699, 0.14003707377066804, 0.1423455973675023, 0.1446565163079371, 0.14594230568346764, 0.1498664306254129, 0.15337410011362307, 0.15430863854081273, 0.1549576799248811, 0.15863674004167447, 0.16062871758586772, 0.1632052591594924, 0.16683374127603368, 0.16674188930694242, 0.16672748563213372, 0.17268147228014658, 0.17100236388073928, 0.1761443024223713, 0.18002977393927921, 0.17908883295513886, 0.18358902557526632, 0.1869156798916049, 0.1888611221150543, 0.191420994191939, 0.1918844805150442, 0.19495282110086554, 0.19730421849936491, 0.19979063993003274, 0.2020827979727496, 0.20732314746228975, 0.20844450603273382, 0.21071539755577617, 0.21363693465428796], [0.6907342722431614, 0.6948141601295449, 0.697386260194272, 0.7011214325973653, 0.7014384543170018, 0.7032163395239539, 0.7093923161236066, 0.7087441105981983, 0.7130152597227298, 0.7242127311481045, 0.718153195749463, 0.7232102978715262, 0.7217260074490218, 0.7285562384230158, 0.7338198763191479, 0.7368030416217164, 0.7413856676498821, 0.7425448709798941, 0.7451525610300115, 0.742570445043214, 0.7471985424747475, 0.7511138085583783, 0.7593257945433532, 0.753201024246428, 0.764072770576668, 0.7688300968760976, 0.7702617894532173, 0.7688154075879697, 0.7736946237937871, 0.7704839133819924, 0.7742855471456184, 0.7835804795252279, 0.780836857901973, 0.7813294305515626, 0.7858078166445898, 0.7837046430004548, 0.7848443990683066, 0.7914231610654493, 0.7857913222813768, 0.7906170106563106, 0.7939338375700347, 0.7984311739233909, 0.797469931590497, 0.7997444690269123, 0.8023755242055146, 0.8015775859452396, 0.8002078531858048, 0.7936812513278416, 0.8055903335562936, 0.8005728490570404, 0.80810577915391], [1.2751175190762014, 1.2672674453709747, 1.278569343244825, 1.2687421762451052, 1.2717228868779344, 1.2694574190495085, 1.273302320338622, 1.2755774888215947, 1.2650188119441224, 1.2715824286972197, 1.2689630960093636, 1.2635549491544968, 1.2704410541798394, 1.2711885620369967, 1.2737019870879709, 1.2679252621765944, 1.2635498943121672, 1.2607780533106403, 1.2671629971744414, 1.26103496634181, 1.2562174063032798, 1.2573767594240879, 1.250720184310332, 1.2521604134302518, 1.2517356099444346, 1.2556988348483715, 1.2440266780053135, 1.2392422829850231, 1.2444326659448706, 1.240876518721371, 1.238747792943363, 1.238421516366759, 1.2299857283027191, 1.2321412825366047, 1.2301715539850893, 1.2223591665481752, 1.2127892569114167, 1.2160873932847855, 1.202727733809027, 1.208912042480001, 1.2062031345620332, 1.2000603329212136, 1.1928834553051422, 1.1927605377916877, 1.1786295546898977, 1.1840232519982465, 1.1797546118001616, 1.1672146085481847, 1.158845298281571, 1.1531602095828881, 1.1436670686002235], [1.680978547380496, 1.6752912880266568, 1.6642905210518788, 1.658869512714314, 1.6606784410266135, 1.6538834789551142, 1.6583880477895447, 1.6515430384037106, 1.6472029761528422, 1.6401717305213344, 1.6299188793083252, 1.6181994348697781, 1.6286251541508547, 1.6278872894813226, 1.6147670786875146, 1.6078145840116946, 1.6040002334674914, 1.5993414521665903, 1.597670381613973, 1.5851219684398252, 1.5688431766778228, 1.5762722172870995, 1.571962813119587, 1.565493713803467, 1.5491058819997654, 1.546558399198226, 1.5338717635318142, 1.5401921583893798, 1.5306009900419115, 1.515250157607092, 1.5138963510093002, 1.5068281918165318, 1.5019819075498193, 1.4898408324133727, 1.4857899874928782, 1.4670758980860847, 1.4646459561987297, 1.4586843368880833, 1.4484290857903672, 1.4417774040205233, 1.4409299184499245, 1.42720848986237, 1.416290754371126, 1.407602912642523, 1.3965323975632158, 1.3889068526974202, 1.3836876844779713, 1.3648034980764667, 1.3515204912012606, 1.3479726187009813, 1.3235303029816308], [2.0377046949091593, 2.011322140871824, 2.0068195082566715, 2.0085625193937324, 1.9950612558546141, 1.9824293007036342, 1.9813998197936191, 1.9685622984518873, 1.9545375046644125, 1.9487264334841112, 1.9284065761639602, 1.9261317124944561, 1.920323534693631, 1.9043321003903257, 1.9067541498178893, 1.893548102029246, 1.8791480209187397, 1.8736385242023874, 1.8729951307282187, 1.851471268752208, 1.8418332431725444, 1.8273583232630797, 1.8217875914099144, 1.8101553464789906, 1.7915437538244559, 1.7867031068563768, 1.7885419439593377, 1.767545452497186, 1.756447935276538, 1.7506688762592126, 1.7381149623945216, 1.7323011935259387, 1.7168582840062356, 1.7027730950466475, 1.7064334515019732, 1.6829780479014786, 1.6678205890643087, 1.6653427055396952, 1.6549614839767504, 1.6386972603004057, 1.628114947881598, 1.6142702910564068, 1.5995227632857816, 1.5890303136323642, 1.5799828029817355, 1.569051633467957, 1.554955562838157, 1.53182636097026, 1.5266045851079444, 1.5108407881088308, 1.5052546510964044]]
#mut_ratess = [[0.0598913643588047, 0.06076056959811029, 0.059899590977434386, 0.06011131469384113, 0.05929800662510336, 0.06022298025162037, 0.059855019391305435, 0.05959951996353522, 0.059862923033379214, 0.06019751987948922, 0.05955881513842482, 0.06037823576881039, 0.060323647939097544, 0.05998680946563041, 0.059808285988626496, 0.05993203095566187, 0.059828623988568294, 0.06004925361807482, 0.0599765895322216, 0.0597110230046434, 0.06043983791710158, 0.05997609627992527, 0.059408073937004015, 0.060021250648473266, 0.060179120718755474, 0.060468120211098694, 0.0599593217657677, 0.06048828285390786, 0.0600158074586637, 0.06037258382043607, 0.06036842157148351, 0.059658627661998684, 0.059225199005084196, 0.06013709002977688, 0.05963207314953332, 0.06019422901590349, 0.06006283984310107, 0.059593625120861686, 0.06029998482105894, 0.060304259651582454, 0.0600359542602141, 0.06045076919772958, 0.05984203226097047, 0.05990365884001112, 0.05999671410760199, 0.059870346247916484, 0.05967275666821873, 0.060122869586492884, 0.06014503693607102, 0.059914792986442075, 0.06016685294551838], [0.5418330334593645, 0.5393207776559734, 0.5420923123898992, 0.5414708471468456, 0.5400031859680292, 0.5385876791231486, 0.5414122605766416, 0.5375832774332545, 0.5393715403779207, 0.5401031706505112, 0.5402855696979818, 0.5403787339597337, 0.5387211567239226, 0.5391028763514225, 0.5399361704258622, 0.5407303284371936, 0.5414571548722912, 0.5404549710354216, 0.5416164175207584, 0.5394792368026783, 0.5383472817027785, 0.5391876639558854, 0.5407803813802686, 0.5397878631888055, 0.5411316498254026, 0.5424512336211903, 0.5406536279649853, 0.5396301192934669, 0.5398380972402818, 0.5396094851378409, 0.5401671470690689, 0.5400987377539721, 0.5397151182881947, 0.5408025961289976, 0.5405454052283992, 0.5399843436536955, 0.5405938256668582, 0.5409979231481495, 0.5399040478268313, 0.5398326568186994, 0.5420200080486767, 0.5402685852513498, 0.5402763662997535, 0.540993541590451, 0.5406085248290027, 0.5399055997872811, 0.5388737689418764, 0.5395596085894644, 0.5405534472558168, 0.5400148563992304, 0.5401724822916093], [1.1999370249706596, 1.198396569132216, 1.203232216844815, 1.1986841152821108, 1.2019899075128717, 1.199766307055899, 1.2029076808641508, 1.1993018170338097, 1.1970945315480053, 1.2008778827619062, 1.1986163689477216, 1.1975192243612478, 1.2001705256075395, 1.2002417642604515, 1.2016410926156893, 1.2012239773919113, 1.198307407264084, 1.1980083727459327, 1.2022275501176345, 1.20129710147423, 1.202954733169251, 1.200212896503183, 1.199915969168376, 1.1987794062411035, 1.2001289549551584, 1.202540362650967, 1.2002846668437188, 1.199367859042231, 1.2000887727118976, 1.2017202469165096, 1.2010340238630128, 1.2003943673829713, 1.2002314117758976, 1.2010531088838496, 1.2017301980603439, 1.2032052551951498, 1.1996675897855764, 1.1977560948797343, 1.1999350803114348, 1.19940912560731, 1.2006124235768199, 1.2012418971807863, 1.200047131044189, 1.2010481881080641, 1.200004900981275, 1.200949125247535, 1.2016336415466247, 1.2003907210718954, 1.200993809737743, 1.1993409069677803, 1.1994773055518442], [1.8020460007700352, 1.7975403453263987, 1.8016289252899844, 1.797054489341209, 1.8002858179388064, 1.8003761472439495, 1.8026446150266882, 1.7994316476057521, 1.8015085675329447, 1.7990025281600044, 1.800339666163881, 1.7997167051781255, 1.804611789366866, 1.8016248284385576, 1.8009077307500456, 1.798880308465181, 1.7992801650899568, 1.7994313844019287, 1.8005245792082578, 1.7992292745237022, 1.796088487913644, 1.8005207173724613, 1.803737628131985, 1.7982781602372508, 1.7988659311120465, 1.800695271499465, 1.7996559069106919, 1.7989750618884155, 1.8040466549289413, 1.7998129299838594, 1.7995671265829598, 1.800612992069645, 1.798783784610133, 1.7992948535247197, 1.80412595273766, 1.8016154919701484, 1.8002786305352565, 1.7993951220108062, 1.800392709789206, 1.8025516448208319, 1.7989125030079058, 1.8049485218235577, 1.8015360338348976, 1.7975574634333233, 1.7984437616768687, 1.7997667398002328, 1.800468528131728, 1.7969901926796186, 1.7993241222813885, 1.8019411536077932, 1.7975338065773976], [2.40636712147921, 2.3953032982224842, 2.3971263582476605, 2.4011119507816536, 2.4010581682874528, 2.3982732738143326, 2.4002948089419913, 2.3996317006973946, 2.399842227981262, 2.3981892880155953, 2.396375813137266, 2.4011395424944886, 2.402233593762493, 2.39520410134435, 2.4031160393469415, 2.399343578387806, 2.3989183236627123, 2.4006716434529825, 2.404262079216516, 2.3988835059475218, 2.399145816882922, 2.4035357597628484, 2.4001601176202083, 2.399522183183785, 2.398517762844447, 2.3943628272432727, 2.4013657963150163, 2.4005346052485335, 2.400772723953953, 2.399675393418572, 2.3990055574708746, 2.400380509914418, 2.3975220228822582, 2.398783882883908, 2.399052371872398, 2.401111197705314, 2.400735415074416, 2.399685190149648, 2.4025081209165395, 2.4001734195417614, 2.4024023053657455, 2.3965003103821, 2.397658035191154, 2.4033754420346147, 2.398392091936621, 2.400726797341081, 2.400009667726527, 2.399165536438342, 2.400310065262852, 2.3967487772393414, 2.4022423278936094]]
'''
#This block creates a graphic for reproduction rates from the AL, and the corresponding type distribution
'''
thetas = [x/10.0 for x in range(50, 151, 1)]

sigmas = [4, 3, 2, 1, 0]
nus = [0.05, 0.1, 0.2, 0.25, 0.4]
reproduction_tos_AL = [[], [], [], [], []] # first index is type, second index is sigma.
reproduction_froms_AL = []
reproductions = [[], [], [], [], []]

graph_dists = [[],[],[],[],[]] # first index is type, second index is theta.
AL_dists = [[],[],[],[],[]]

dark_red = (0.4, 0, 0)
bright_red = (0.9, 0.1, 0.1)

dark_green = (0, 0.4, 0)
bright_green = (0.1, 0.9, 0.1)

dark_blue = (0, 0, 0.4)
bright_blue = (0.2, 0.2, 1)

dark_yellow = (0.2, 0.2, 0)
bright_yellow = (0.8, 0.8, 0)

dark_purple = (0.2, 0, 0.4)
bright_purple = (0.7, 0.2, 1)


R = 10000
repeats = 10

for theta in thetas:
    graph_dist, AL_dist, _, _, _, _, reproduction_to_AL, reproduction_from_AL, reproduction = main(sigmas, theta, R, nus, repeats, False)[:9]
    for i in range(len(reproduction_to_AL)):
        reproduction_tos_AL[i].append(reproduction_to_AL[i]/(R*repeats))
        reproductions[i].append(reproduction[i]/(R*repeats))
        graph_dists[i].append(graph_dist[i]/sum(graph_dist))
        AL_dists[i].append(AL_dist[i]/sum(AL_dist))
    reproduction_froms_AL.append(reproduction_from_AL/(R*repeats))

plt.figure(1)
plt.xlabel("θ")
plt.ylabel("Reproduction rate")
parameters = [(dark_red, bright_red), (dark_green, bright_green),(dark_blue, bright_blue),(dark_yellow, bright_yellow),(dark_purple, bright_purple)] #(colour AL, colour graph)
for i in range(len(parameters)):
    graph_color, AL_color = parameters[i]
    plt.plot(thetas, reproduction_tos_AL[i], color = AL_color)
    plt.plot(thetas, reproductions[i], color = graph_color)
    if i == 0:
        plt.annotate("Type " + str(i) +" AL", xy=(thetas[-1], reproduction_tos_AL[i][-1]), xytext=(thetas[-1] + 0.15, reproduction_tos_AL[i][-1] + 0.007), size=7, va="center", annotation_clip=False)
        plt.annotate("Type "+str(i)+" G", xy=(thetas[-1], reproductions[i][-1]), xytext=(thetas[-1]+0.15, reproductions[i][-1] - 0.07), size=7, va="center", annotation_clip=False)

    elif i == 1:
        plt.annotate("Type " + str(i) +" AL", xy=(thetas[-1], reproduction_tos_AL[i][-1]), xytext=(thetas[-1] + 0.15, reproduction_tos_AL[i][-1] + 0.068), size=7, va="center", annotation_clip=False)
        plt.annotate("Type "+str(i)+" G", xy=(thetas[-1], reproductions[i][-1]), xytext=(thetas[-1]+0.15, reproductions[i][-1] + 0.0027), size=7, va="center", annotation_clip=False)

    elif i == 2:
        plt.annotate("Type " + str(i) +" AL", xy=(thetas[-1], reproduction_tos_AL[i][-1]), xytext=(thetas[-1] + 0.15, reproduction_tos_AL[i][-1] + 0.042), size=7, va="center", annotation_clip=False)
        plt.annotate("Type "+str(i)+" G", xy=(thetas[-1], reproductions[i][-1]), xytext=(thetas[-1]+0.15, reproductions[i][-1] - 0.02), size=7, va="center", annotation_clip=False)

    elif i == 3:
        plt.annotate("Type " + str(i) +" AL", xy=(thetas[-1], reproduction_tos_AL[i][-1]), xytext=(thetas[-1] + 0.15, reproduction_tos_AL[i][-1] + 0.033), size=7, va="center", annotation_clip=False)
        plt.annotate("Type " + str(i) +" G", xy=(thetas[-1], reproductions[i][-1]), xytext=(thetas[-1]+0.15, reproductions[i][-1] - 0.028), size=7, va="center", annotation_clip=False)

    elif i == 4:
        plt.annotate("Type " + str(i) +" AL", xy=(thetas[-1], reproduction_tos_AL[i][-1]), xytext=(thetas[-1] + 0.15, reproduction_tos_AL[i][-1] - 0.05), size=7, va="center", annotation_clip=False)
        plt.annotate("Type " + str(i) + " G", xy=(thetas[-1], reproductions[i][-1]), xytext=(thetas[-1]+0.15, reproductions[i][-1] + 0.04), size=7, va="center", annotation_clip=False)



plt.plot(thetas, reproduction_froms_AL, color = bright_purple)


plt.xlim(thetas[0], thetas[-1])
plt.show()

plt.figure(2)
plt.xlabel("θ")
plt.ylabel("Type distribution")
for i in range(len(parameters)):
    graph_color, AL_color = parameters[i]
    plt.plot(thetas, AL_dists[i], color = AL_color)

    if i == 3:
        plt.annotate("Type " + str(i) +" AL", xy=(thetas[-1], AL_dists[i][-1]), xytext=(thetas[-1] + 0.15, AL_dists[i][-1] - 0.004), size=7, va="center", annotation_clip=False)
        plt.annotate("Type "+str(i)+" G", xy=(thetas[-1], graph_dists[i][-1]), xytext=(thetas[-1] + 0.15, graph_dists[i][-1] + 0.004), size=7, va="center", annotation_clip=False)

    else:
        plt.annotate("Type " + str(i) +" AL", xy=(thetas[-1], AL_dists[i][-1]), xytext=(thetas[-1] + 0.15, AL_dists[i][-1]), size=7, va="center", annotation_clip=False)
        plt.annotate("Type "+str(i)+" G", xy=(thetas[-1], graph_dists[i][-1]), xytext=(thetas[-1]+0.15, graph_dists[i][-1]), size=7, va="center", annotation_clip=False)

    plt.plot(thetas, graph_dists[i], color = graph_color)


plt.xlim(thetas[0], thetas[-1])
plt.show()





print(reproduction_tos_AL)
print(reproduction_froms_AL)
print(reproductions)
print(AL_dists)
print(graph_dists)


#reproduction_tos_AL = [[0.1145, 0.11172, 0.11078, 0.1093, 0.10802, 0.10636, 0.10528, 0.10849, 0.10367, 0.10642, 0.10433, 0.10065, 0.10259, 0.09955, 0.09994, 0.09841, 0.09763, 0.09761, 0.09671, 0.09678, 0.09498, 0.09243, 0.09432, 0.09387, 0.09181, 0.0931, 0.09172, 0.0908, 0.09007, 0.09086, 0.09001, 0.08931, 0.08756, 0.08774, 0.08838, 0.08707, 0.08482, 0.08638, 0.08643, 0.08633, 0.08607, 0.08445, 0.08405, 0.08278, 0.08264, 0.08408, 0.08352, 0.08207, 0.08251, 0.08338, 0.08196, 0.08137, 0.08124, 0.07893, 0.08036, 0.07863, 0.08001, 0.07858, 0.07989, 0.0794, 0.07784, 0.07758, 0.07844, 0.0778, 0.077, 0.07828, 0.078, 0.07672, 0.07494, 0.07663, 0.07773, 0.07637, 0.07473, 0.07449, 0.07418, 0.0759, 0.07458, 0.07327, 0.07377, 0.07427, 0.07372, 0.07289, 0.07292, 0.07451, 0.07341, 0.07328, 0.07297, 0.07001, 0.07093, 0.07191, 0.07309, 0.07175, 0.07227, 0.07085, 0.07025, 0.07111, 0.07067, 0.0703, 0.07064, 0.06961, 0.07001], [0.27439, 0.27401, 0.26821, 0.26698, 0.26711, 0.26005, 0.26102, 0.26064, 0.257, 0.26135, 0.25758, 0.25263, 0.25392, 0.24986, 0.24841, 0.2474, 0.24571, 0.24602, 0.24558, 0.24577, 0.24099, 0.24106, 0.24358, 0.23895, 0.23917, 0.2377, 0.23311, 0.23069, 0.23424, 0.22764, 0.22823, 0.22794, 0.2298, 0.22809, 0.22685, 0.22657, 0.2272, 0.2237, 0.22645, 0.22234, 0.22243, 0.22014, 0.22112, 0.21942, 0.22224, 0.22168, 0.21722, 0.21336, 0.21691, 0.21633, 0.2151, 0.21234, 0.2118, 0.214, 0.21442, 0.2139, 0.21254, 0.21089, 0.21112, 0.20984, 0.2107, 0.20893, 0.2077, 0.20682, 0.2028, 0.20802, 0.2069, 0.20608, 0.20683, 0.2067, 0.20623, 0.20225, 0.20257, 0.20505, 0.20491, 0.20259, 0.20298, 0.20698, 0.20252, 0.19936, 0.20039, 0.20421, 0.20003, 0.19851, 0.19832, 0.19885, 0.19751, 0.19633, 0.19674, 0.19856, 0.1993, 0.19759, 0.19608, 0.1934, 0.19552, 0.1953, 0.19528, 0.19429, 0.19112, 0.19393, 0.19531], [0.50888, 0.50854, 0.5042, 0.50162, 0.50642, 0.49432, 0.49469, 0.49408, 0.49508, 0.49378, 0.48546, 0.48476, 0.48714, 0.4848, 0.47999, 0.479, 0.48093, 0.47527, 0.47655, 0.47551, 0.46989, 0.46902, 0.47361, 0.46977, 0.46822, 0.46559, 0.46547, 0.46769, 0.45984, 0.46415, 0.45977, 0.45734, 0.45838, 0.45387, 0.45048, 0.45262, 0.45023, 0.45118, 0.45093, 0.45342, 0.44852, 0.4495, 0.44409, 0.44377, 0.44379, 0.44295, 0.4417, 0.44081, 0.4414, 0.44249, 0.44179, 0.43838, 0.441, 0.43524, 0.43872, 0.43534, 0.4364, 0.43272, 0.43984, 0.43116, 0.43456, 0.43543, 0.43141, 0.42943, 0.4303, 0.43202, 0.42992, 0.43075, 0.42863, 0.42586, 0.42853, 0.42967, 0.4232, 0.42572, 0.42048, 0.4234, 0.42593, 0.42241, 0.41969, 0.4205, 0.41943, 0.42051, 0.4179, 0.42063, 0.41645, 0.42385, 0.41598, 0.4183, 0.41857, 0.41904, 0.41703, 0.41349, 0.41402, 0.41018, 0.41549, 0.41418, 0.41413, 0.41172, 0.4083, 0.41481, 0.40929], [0.7299, 0.73023, 0.73142, 0.72423, 0.72404, 0.72249, 0.71783, 0.71765, 0.71475, 0.71779, 0.7171, 0.71145, 0.71301, 0.71401, 0.70859, 0.70153, 0.70994, 0.70851, 0.70416, 0.70212, 0.70022, 0.69848, 0.69907, 0.69864, 0.69459, 0.69363, 0.69438, 0.69247, 0.69483, 0.69668, 0.69266, 0.69055, 0.687, 0.68848, 0.68802, 0.69136, 0.68854, 0.68948, 0.68726, 0.68715, 0.68625, 0.68516, 0.6786, 0.68459, 0.68198, 0.67755, 0.67924, 0.67918, 0.67895, 0.67734, 0.6756, 0.67681, 0.67255, 0.67444, 0.67583, 0.67343, 0.67278, 0.67361, 0.67285, 0.67124, 0.66993, 0.67026, 0.66985, 0.67164, 0.66182, 0.67326, 0.67081, 0.66351, 0.66291, 0.66624, 0.67162, 0.6599, 0.65994, 0.66379, 0.66221, 0.66176, 0.66488, 0.66814, 0.66222, 0.66564, 0.66186, 0.66288, 0.66302, 0.66036, 0.66068, 0.66184, 0.66321, 0.65779, 0.66015, 0.65808, 0.66145, 0.65509, 0.65677, 0.65679, 0.65675, 0.65609, 0.65721, 0.65626, 0.65684, 0.6518, 0.65455], [3.05199, 3.04884, 3.05815, 3.05052, 3.05013, 3.04206, 3.05279, 3.05595, 3.0502, 3.05915, 3.05153, 3.0567, 3.06557, 3.05073, 3.05388, 3.05948, 3.06073, 3.05309, 3.05817, 3.05254, 3.06142, 3.0552, 3.05952, 3.06504, 3.05948, 3.0587, 3.06497, 3.05354, 3.05754, 3.05736, 3.06538, 3.05379, 3.06219, 3.05095, 3.05214, 3.07459, 3.05977, 3.06031, 3.06573, 3.06764, 3.0655, 3.06134, 3.05023, 3.0553, 3.07248, 3.0564, 3.06706, 3.05657, 3.06934, 3.06534, 3.0641, 3.05686, 3.06119, 3.06719, 3.06448, 3.06255, 3.06526, 3.06052, 3.06827, 3.06115, 3.06559, 3.06412, 3.06905, 3.05953, 3.06185, 3.0691, 3.07155, 3.07327, 3.06076, 3.06401, 3.05847, 3.07143, 3.07139, 3.06546, 3.07845, 3.0743, 3.07067, 3.07043, 3.06765, 3.06938, 3.06435, 3.07287, 3.06811, 3.06774, 3.06031, 3.07417, 3.06687, 3.06899, 3.06271, 3.0763, 3.0653, 3.07286, 3.0636, 3.06896, 3.06251, 3.06809, 3.07133, 3.06339, 3.06968, 3.06592, 3.07669]]
#reproduction_froms_AL = [3.04103, 3.04566, 3.05414, 3.05492, 3.05851, 3.05047, 3.03824, 3.0487, 3.04716, 3.05745, 3.04547, 3.04457, 3.05299, 3.05764, 3.04328, 3.05145, 3.06025, 3.04949, 3.056, 3.06482, 3.06783, 3.0574, 3.06624, 3.06278, 3.06081, 3.0692, 3.06252, 3.06132, 3.05881, 3.06043, 3.06557, 3.06719, 3.07093, 3.06277, 3.05802, 3.06584, 3.06855, 3.06001, 3.06147, 3.06477, 3.0588, 3.06597, 3.06668, 3.05222, 3.06739, 3.06287, 3.06647, 3.06117, 3.06471, 3.06365, 3.06854, 3.05976, 3.06087, 3.06673, 3.06488, 3.05786, 3.06539, 3.06457, 3.06034, 3.06835, 3.07273, 3.07487, 3.07589, 3.06069, 3.06333, 3.0802, 3.06855, 3.07553, 3.06488, 3.06806, 3.06334, 3.05819, 3.07425, 3.06787, 3.06459, 3.07397, 3.08119, 3.06645, 3.06613, 3.06885, 3.06918, 3.0648, 3.06393, 3.07398, 3.06054, 3.08665, 3.07165, 3.07163, 3.07281, 3.06343, 3.07453, 3.07477, 3.0638, 3.07138, 3.08014, 3.07062, 3.06229, 3.06889, 3.05277, 3.07448, 3.06802]
#reproductions = [[0.08416308521054161, 0.08335102705627755, 0.08216737315462364, 0.0821139131187445, 0.08132072402597455, 0.08018603060828114, 0.07971587691475238, 0.08017733308358357, 0.0787135582750587, 0.07981647866022913, 0.07903839758852296, 0.07741052350427388, 0.07772527654290197, 0.07662727369852412, 0.07569792277167313, 0.07565760292485334, 0.07514171591317212, 0.07437573770673801, 0.07484857718670244, 0.07382160125985157, 0.0739690203962707, 0.07266685667110692, 0.07285707291319819, 0.07239843951881486, 0.07209964590964615, 0.07221909988622514, 0.07160563633588658, 0.07173078002553034, 0.07170456743256771, 0.07091652433677452, 0.07004798272560799, 0.07034788421300951, 0.06944705525030542, 0.06947219008769033, 0.07023415578865597, 0.06886086044511065, 0.06788659329559354, 0.06901135037185062, 0.06856668406593422, 0.06893203395624006, 0.06802542295204812, 0.06725516669441689, 0.06748749231324247, 0.0669447724497726, 0.06661426717726736, 0.06793021385558902, 0.0668652483488735, 0.06685722746697763, 0.06683110232822753, 0.06696827045177067, 0.0668211827339329, 0.06534002320310428, 0.06493732728382744, 0.06550449658674673, 0.06614164846264861, 0.06467129274891785, 0.06506524580974594, 0.06505223507048519, 0.06519129319291839, 0.06439674517149534, 0.06487448902894513, 0.0641645351870353, 0.06468958399933412, 0.06407253850316366, 0.06341287161449671, 0.06386585274447787, 0.06452651701076707, 0.06361665762015774, 0.06300973242443839, 0.06361455504218015, 0.06321674845987356, 0.06352835613406208, 0.06297083895271406, 0.06273734797147307, 0.06264849625374631, 0.06348397022422034, 0.06250861883949398, 0.061968411602286715, 0.06146008571983584, 0.06194401745476747, 0.06230948394660902, 0.062341862197443136, 0.06215143364968372, 0.06284400616050625, 0.06133337559662565, 0.06127142687867695, 0.06161350072150081, 0.06038928187498781, 0.06109768374680881, 0.06133715369352876, 0.06088432503607507, 0.061219590007215066, 0.06126733308358313, 0.06018959360084368, 0.06015820029970032, 0.06042794960594965, 0.060092279072234994, 0.059883071789321805, 0.06023459861380451, 0.06049205400155407, 0.05966018936618939], [0.21846603084415764, 0.21885633710733862, 0.21620455399584285, 0.2160403493075572, 0.21469820437324302, 0.21158913336663554, 0.21086543878344083, 0.21098209672680493, 0.20780636167998887, 0.21058737538850256, 0.2086249422887079, 0.20589298648573873, 0.20514502113572922, 0.2059914893341974, 0.202406870439204, 0.20241606979132223, 0.20316880727605968, 0.20098093829781563, 0.19995473694361435, 0.20015168348318596, 0.20018125450938198, 0.19964238693251435, 0.19822924257686994, 0.19663502834665578, 0.19729330909368636, 0.19637170303308027, 0.1944086179653702, 0.19419729996800808, 0.1955761824466404, 0.1916448515373539, 0.19191111256798996, 0.19163364922577664, 0.19295151362526583, 0.19065663922189147, 0.19095003752212075, 0.19082089428627147, 0.19045876025363742, 0.18993096389721614, 0.18954595866633583, 0.18875710023310246, 0.18844120156232874, 0.18698106368631595, 0.18658990902153627, 0.18611566157453868, 0.18680433424908627, 0.18684868095793325, 0.1857244624027956, 0.18372602955378167, 0.18521776325472128, 0.18546335692085905, 0.18423090561236385, 0.18393422073759783, 0.18229506968032186, 0.18273194988345207, 0.18329983483183696, 0.18216988880564092, 0.18330926504459794, 0.18163645561383285, 0.1817632387889911, 0.180567692950026, 0.18076167901543103, 0.18096038762626473, 0.18050545741758459, 0.1799599086469109, 0.17833775864413573, 0.18028424757187467, 0.1818726452754781, 0.1798227608641379, 0.18079581969419672, 0.1783585128621397, 0.17889358723221424, 0.17712277751415445, 0.17791706535131743, 0.17740464894827587, 0.17831802687590392, 0.17698450574425797, 0.1768696191031211, 0.1782838864330133, 0.17727493539793737, 0.1755622963425485, 0.17607382613628395, 0.17638250219225432, 0.1755706607738686, 0.1759034041595681, 0.17531727813853, 0.17483211691086895, 0.17485455283605483, 0.1747013885003905, 0.1738526693167963, 0.17574145851371054, 0.17538618962981656, 0.17396944529490319, 0.1742944576118345, 0.17163244065656763, 0.17283891468662266, 0.17277113536871824, 0.17262845469808166, 0.17304123127281418, 0.17113530473693175, 0.17232126148851346, 0.17310606893107078], [0.44137476190474734, 0.4417549505355613, 0.43921545602027257, 0.4376518025446642, 0.43885675231711446, 0.4325952108210295, 0.43341241401652636, 0.43136762642911397, 0.4308178814004503, 0.431599640530209, 0.42643956608667993, 0.4268429794176302, 0.42625978225939615, 0.42494266487677906, 0.42239271938191486, 0.4211021563436461, 0.4213891041458451, 0.41959697813296837, 0.41926490044676573, 0.41790235272487974, 0.4155132783091008, 0.4133613906273376, 0.4166468559259274, 0.41457318888055494, 0.41499378373423074, 0.4129229871280587, 0.41192813022515906, 0.4138092428208963, 0.41136818107300366, 0.41166529982516664, 0.4082914386667181, 0.40778637298811526, 0.40838952893347713, 0.40656286577310813, 0.4061851216601949, 0.40677588428645833, 0.405240188217606, 0.404056900436974, 0.4053248040570457, 0.4048417578712059, 0.4024270708596884, 0.4027372807927296, 0.4004379479727722, 0.39987553337348203, 0.40113625695137506, 0.39967967266882654, 0.3987800914918336, 0.3983287814823996, 0.396807004939497, 0.3994103497654228, 0.39809081302438704, 0.3974785348540284, 0.39828479752191515, 0.3957764399807636, 0.39610083196378015, 0.3948561964979394, 0.39544869208568495, 0.39629139379084277, 0.3946924417804347, 0.39382956099863486, 0.3934415063131242, 0.3944864680874612, 0.39279129580549416, 0.392150637551167, 0.391253250249744, 0.39305498667998023, 0.3927058361638292, 0.39139783947016404, 0.3915326751581679, 0.3909763542429722, 0.3912920782550719, 0.3932191904108895, 0.3903402873376559, 0.38957665387797796, 0.3880997261904698, 0.3875758814420809, 0.39094601563713455, 0.38733590079669433, 0.38691161954711295, 0.3867318850455034, 0.38726169937414945, 0.38661949981961835, 0.38620144057738975, 0.38834851097512924, 0.3850096491286427, 0.3877541080575715, 0.386161674010623, 0.38469197339179717, 0.38474961064343477, 0.3848681958458147, 0.38513177031709406, 0.385127227526551, 0.38419444968919414, 0.38340466647241017, 0.3845263889582571, 0.3827354610528299, 0.3838405731253977, 0.3799813110778045, 0.38115066966366334, 0.38386450199799466, 0.38126434561271455], [0.6750293192403368, 0.6753209033784228, 0.6778197179347817, 0.6732008971762922, 0.6734737344044244, 0.6719655450325216, 0.6689327235166197, 0.6697106116521744, 0.6675297234154136, 0.6680562806816766, 0.6666147229714121, 0.6660054344960007, 0.6651106771683597, 0.6647993416484878, 0.6610614230711519, 0.6593312203629109, 0.6620244431442136, 0.6611791337175307, 0.6607520672284646, 0.6553930877871548, 0.6585816837687873, 0.6559113137735857, 0.6563520966810391, 0.6532594329836257, 0.6529554674491604, 0.6515423068679124, 0.6531754726939153, 0.652438823046177, 0.6525530610957099, 0.6534206525598005, 0.6530734992629345, 0.6504620244934233, 0.6491545530579954, 0.6501435608402466, 0.6486806225799778, 0.6515732488483169, 0.6483617028093895, 0.6486915809745233, 0.6474109706624522, 0.6470977287058771, 0.6462483646116389, 0.6465956449979209, 0.6445681051472484, 0.6451837865467307, 0.6463438199577645, 0.6443678445165401, 0.6433408733904435, 0.6448524482363481, 0.643913734529304, 0.6404168671311793, 0.641447591119609, 0.6431665342018538, 0.6415471017397095, 0.6403662411044291, 0.6418713600328856, 0.6402483915805872, 0.6389859052058519, 0.6399413275335227, 0.639848357489677, 0.6390089538043109, 0.6377420399779419, 0.6387307536351986, 0.6382970434148638, 0.635851324508771, 0.6358757680872523, 0.6379868231808492, 0.6379491201796026, 0.6358697356531811, 0.6332929073466838, 0.6338728854894574, 0.6346635806733573, 0.6357322045315266, 0.6332784701964156, 0.6333333069846281, 0.633474143212126, 0.636090131908673, 0.6334964879743897, 0.6357921342962058, 0.633001825799146, 0.6332807078239837, 0.6338800683662217, 0.6330955306955576, 0.6345190821112466, 0.6310767438435211, 0.6321298869185831, 0.6326066386652035, 0.6346092442124335, 0.6306610991826277, 0.63150672759077, 0.630114325678353, 0.632547877085279, 0.6305897974427005, 0.6302747203212926, 0.6299924054180587, 0.6298470452602432, 0.6282044340283367, 0.6306348644549368, 0.6284938072564156, 0.6300143583123861, 0.6296562382935174, 0.62776253227323], [3.073474628834808, 3.075118648275313, 3.081471858154907, 3.0790529447300883, 3.0792820118319435, 3.0748434344234137, 3.0725558346994197, 3.082359198422047, 3.07411594887119, 3.0777527847650408, 3.0702872561998626, 3.07014500486339, 3.0752589634479017, 3.0811490540758344, 3.071736842186563, 3.071854460176873, 3.0765467097834818, 3.071837432959605, 3.0763655350178807, 3.0721323624739685, 3.077859711776327, 3.0738337243703997, 3.0781917004782486, 3.076996227683881, 3.0772289001094846, 3.0800627560337994, 3.072222349355281, 3.0748737079299375, 3.074240940096822, 3.0747110687102923, 3.0756223161999228, 3.077354581828704, 3.0764777757540904, 3.069413988253373, 3.0714683019930926, 3.081108301716233, 3.0741708349916075, 3.071422963399525, 3.07801678983396, 3.079054284548374, 3.07164533436642, 3.070288489802854, 3.071754301400787, 3.071419740217082, 3.0798005804428286, 3.07145146969836, 3.0740325230427383, 3.0706269254366645, 3.072686561715635, 3.075762244893383, 3.071860552129001, 3.0711971762377654, 3.0666499400627623, 3.078930592959764, 3.077984128277593, 3.0733350992248893, 3.075099801453245, 3.0711276040109805, 3.0766037311263204, 3.073959724806449, 3.073777653007478, 3.0765007225762675, 3.0793816917057555, 3.071690396025749, 3.0693768963836106, 3.07785468823681, 3.0759616960137444, 3.0763708310667677, 3.0731427074377575, 3.0736428358796193, 3.0694497063653277, 3.0783329747676897, 3.079172196139442, 3.0722198903812274, 3.0769165727358962, 3.0784494253238144, 3.078351838067786, 3.0747142086843775, 3.076283392308455, 3.074565601531445, 3.0722660181603128, 3.0754680349295365, 3.074730519023434, 3.0797607991710065, 3.070491045089492, 3.0816631914792687, 3.077186922674763, 3.0765819432434522, 3.074239028506856, 3.075469570049839, 3.076303457976877, 3.076915425926817, 3.072953583502068, 3.072400670181922, 3.0756720136846627, 3.073001673223635, 3.0759978115599766, 3.0717425290993687, 3.070120175335089, 3.072206379954851, 3.075631270455803]]
#AL_dists = [[0.11460243876277171, 0.1115704584732169, 0.11048958254191875, 0.1089686315723569, 0.10828366918315913, 0.10633019250145512, 0.10591476642564512, 0.10561038793787325, 0.1043948138052488, 0.10552227574268182, 0.10336613887804737, 0.10188111576092362, 0.10217568263231297, 0.10028873339751919, 0.09828864117561119, 0.0985492741756516, 0.09823110610417339, 0.09686796922298432, 0.09677205303145466, 0.09491019052630043, 0.09469193376473466, 0.09379408299938516, 0.09561678586458275, 0.0925247036581309, 0.09199058238770731, 0.09202669894951092, 0.09198751564771612, 0.09100535877821955, 0.08973743326690295, 0.08949357296911545, 0.08844226477540518, 0.08834247194107622, 0.08821462671919977, 0.08777773631697247, 0.08838102063564868, 0.08661691470520207, 0.08646407584813781, 0.08578450778345942, 0.08617054854528346, 0.08546350256203403, 0.08538001356415734, 0.08465243332429305, 0.08470436898336771, 0.08375029779938425, 0.08305475404465815, 0.08401935497664277, 0.08279597087885861, 0.08178083319058123, 0.082583123245361, 0.08170455414276817, 0.08090083331813279, 0.08113459093803999, 0.08071756398979134, 0.0809289881171276, 0.0808864800470684, 0.07932669932595808, 0.08027653936841128, 0.07893078078252536, 0.07869008648385592, 0.07853892730793427, 0.07826710554675377, 0.07761382591102614, 0.07761571160372731, 0.07784930670768586, 0.07687904023775978, 0.07777561677924627, 0.0773839423356584, 0.07621397458951425, 0.07669278472741438, 0.07599431035367507, 0.0764468523245526, 0.07628547618930227, 0.07482168727879211, 0.07533303838496212, 0.07507310113829536, 0.07534338033731355, 0.07453928823953151, 0.07444534140427383, 0.07399020665770555, 0.07391803786348554, 0.0736730223809878, 0.0734514375487635, 0.07362588419457762, 0.07333280923762868, 0.07351170087733223, 0.07321408815854896, 0.07249920864922278, 0.07181456069170014, 0.07171006332955392, 0.07247972007299029, 0.07192333525883339, 0.07226103613419703, 0.07125126553324447, 0.07090719792319208, 0.07138959753361653, 0.07135267500536067, 0.07066457176641089, 0.0710323648108983, 0.07000859960935979, 0.07040010959683712, 0.07036312553663333], [0.15941137901773408, 0.16047604118341727, 0.1589373357991242, 0.15767389871075682, 0.15889241181642605, 0.15585866466971124, 0.15490199646564287, 0.1548840557470919, 0.15400163394859762, 0.15373981344380755, 0.15262957069424096, 0.15228970836440803, 0.1505082396933476, 0.1513345103634529, 0.15076307040761647, 0.15012826674086313, 0.14900102597956863, 0.14862527262632816, 0.14720083083101665, 0.14821802347400717, 0.14594576755612798, 0.1456560330380668, 0.1458648605289258, 0.14428766716747954, 0.14521538947297158, 0.1444254481885178, 0.14337973702985402, 0.14340599830425196, 0.14273361926542627, 0.14188578424585366, 0.1414852713875331, 0.1407775162121174, 0.1411784980967697, 0.13960474194897782, 0.13939732534701418, 0.1389330667039713, 0.13917937823226517, 0.13858883126795773, 0.13780587518793783, 0.13854116767085145, 0.1372091851137793, 0.13694636571612834, 0.13621482171702587, 0.13585831389168868, 0.13619017389551924, 0.13539477464549649, 0.1354746771113679, 0.1354493346126446, 0.1348829481776681, 0.13419863835180285, 0.13464708063433406, 0.1337916102075482, 0.13334058229298862, 0.13333433267813022, 0.13247629853298548, 0.13308621543759305, 0.1324808398996041, 0.1322378187489481, 0.13259596622667685, 0.13145425386951637, 0.13216022633555388, 0.13170667599489508, 0.1308661940204224, 0.1306350882430409, 0.12996651660270359, 0.1295749214103413, 0.1294879070472486, 0.1293360166230979, 0.12904484347198214, 0.12880688608133514, 0.1291258986980937, 0.1291855074692391, 0.12880080863787213, 0.12893139943074966, 0.12745361958692047, 0.12733055311809546, 0.12779357809709185, 0.12785513527848077, 0.1278834210079136, 0.12810607727287698, 0.12679860450374922, 0.12738463497405542, 0.12670337836629128, 0.12514736848435642, 0.12567519669102215, 0.1264544130827205, 0.1250528960129011, 0.12511190656644702, 0.12558813628207915, 0.12527917302249322, 0.12595016087221775, 0.12513759640171923, 0.12469218996056268, 0.12439341632786657, 0.12431054347010646, 0.12486439373735775, 0.12451144994962346, 0.12392356846853841, 0.12327462291149814, 0.1237535687403034, 0.12316021440493122], [0.2355867170317273, 0.2355793280860666, 0.23585469649993276, 0.23571021444717116, 0.23595378092637992, 0.23586878032173608, 0.23515132090980698, 0.23287658495115907, 0.23420729612367838, 0.23253525333663802, 0.2326013370196723, 0.23299079705144576, 0.23231299583429957, 0.2324073831626037, 0.2318320673761214, 0.23159867397604494, 0.2314543634539371, 0.23033246920099515, 0.23100109526076318, 0.2314599788464011, 0.23085484442219084, 0.23032655503189264, 0.23003624343226972, 0.2293385912908778, 0.22990788471985954, 0.2287132653580937, 0.22927896578871593, 0.22910593902587112, 0.22896053175449416, 0.22912582616403684, 0.2286664555159085, 0.22792630529065475, 0.22744047985007404, 0.22786701131765505, 0.22717724269407952, 0.22775278447068417, 0.22717803617404067, 0.22775509808103725, 0.22760510940435136, 0.22650450255160495, 0.22473048021165992, 0.2267411429933767, 0.22475880822564867, 0.2261190536653197, 0.22539281503384118, 0.22525568779985478, 0.22483119652019887, 0.2245911030479123, 0.22458236257967498, 0.22469928870679526, 0.22429462452607302, 0.22380702098826297, 0.22432725353745994, 0.22364119096911156, 0.2238931151062317, 0.22238310299615255, 0.22279352196957258, 0.22395351374658393, 0.22359272529627985, 0.22294837322474337, 0.22299847412189672, 0.22192481294021443, 0.2234629885770677, 0.22296875132346472, 0.2227737952859886, 0.22262785673534438, 0.22217198846717714, 0.22208987124144475, 0.22194954569233324, 0.22201058308393534, 0.2210228429731992, 0.22098677627734464, 0.22168934780915947, 0.2204433852953651, 0.22156189726012301, 0.22106396623326255, 0.22112700979448174, 0.2204131169414796, 0.22117599028726082, 0.2198610710702668, 0.2198591149276397, 0.2207153101664578, 0.21900833160316713, 0.2197642456041138, 0.21984092633064084, 0.2193466230585179, 0.21995785822618608, 0.21981217106766002, 0.21996984219604077, 0.22026565947830343, 0.21982565997206654, 0.2179428294013867, 0.21915407755724292, 0.21899414905788078, 0.21944364517035891, 0.21837331806748433, 0.21873434475577858, 0.21762476144715917, 0.2182969473610205, 0.21716128411724517, 0.21815955472916365], [0.22063309989239036, 0.22095148631265882, 0.22147347041806523, 0.22285253371770727, 0.2218178425940426, 0.22360450631010373, 0.2235609221770945, 0.2254175284745212, 0.22449825917104624, 0.2245716650323818, 0.2269484130972833, 0.2264094409501563, 0.22680555092257373, 0.22703606960645317, 0.22798737898811786, 0.22787400418502046, 0.2296150989283458, 0.2300663318712302, 0.22995616857549553, 0.2284309422885118, 0.22998410615082962, 0.23191461348037362, 0.2303872556589131, 0.23201884140409448, 0.2308377497242662, 0.2315594969922429, 0.23160987154890955, 0.23139922495514328, 0.2321727540709647, 0.23258215945147928, 0.23392387605847703, 0.23364748731827523, 0.23244434225147748, 0.23470408350172844, 0.23340048589805984, 0.23406716483345433, 0.23359282714387067, 0.23431312900121856, 0.2345129602886296, 0.23504513636484417, 0.23632489295092993, 0.2360581153163721, 0.23650701008146613, 0.23654399951249785, 0.23690572618985506, 0.23613909339344383, 0.2364586470271526, 0.23689597636859624, 0.23559072652458737, 0.23708355013148344, 0.23648584369914347, 0.23789118112794314, 0.23716127612909152, 0.2373392266741852, 0.23750051588392435, 0.23865066804212712, 0.23670243449156955, 0.23730156237444536, 0.23770493665453724, 0.23774454312427562, 0.23727504045554262, 0.23860361050844986, 0.23861501156902912, 0.2384296860915348, 0.2385434806568516, 0.2393121807956655, 0.23960070616802323, 0.24001226112503082, 0.23988026917351976, 0.23889284860591636, 0.2393519682515299, 0.23979934786510276, 0.24033467342821688, 0.24059835861841225, 0.24007156751057582, 0.23970650215314868, 0.23984240997427822, 0.23969576370009288, 0.2402995476723489, 0.24131478262895908, 0.24093484588945555, 0.24044576764291828, 0.24142334141441402, 0.24157530648863398, 0.24156962615597574, 0.24063591408640903, 0.24156384457503566, 0.24220044428800086, 0.24088420849515527, 0.2419806740313544, 0.24051637400164352, 0.24146988442316403, 0.24150408674614338, 0.2426915343773101, 0.2413196340210218, 0.24132961524360932, 0.24191439119134778, 0.24212482128308296, 0.2419959569131695, 0.24297158673868355, 0.2429261977828065], [0.26976636529537656, 0.2714226859446404, 0.27324491474095913, 0.27479472155200785, 0.27505229547999227, 0.27833785619699386, 0.28047099402181047, 0.2812114428893546, 0.2828979969514289, 0.28363099244449086, 0.28445454031075607, 0.2864289378730662, 0.2881975309174661, 0.28893330346997104, 0.29112884205253314, 0.29184978092241987, 0.29169840553397497, 0.29410795707846216, 0.29506985230127003, 0.2969808648647794, 0.2985233481061169, 0.29830871545028176, 0.2980948545153086, 0.3018301964794173, 0.3020483936951953, 0.30327509051163465, 0.3037439099848044, 0.3050834789365141, 0.3063956616422119, 0.3069126571695147, 0.30748213226267623, 0.3093062192378764, 0.310722053082479, 0.3100464269146662, 0.3116439254251978, 0.3126300692866882, 0.3135856826016857, 0.3135584338663271, 0.3139055065737978, 0.31444569085066537, 0.31635542815947354, 0.3156019426498299, 0.3178149909924916, 0.31772833513110954, 0.31845653083612635, 0.3191910891845621, 0.320439508462422, 0.3212827527802656, 0.3223608394727085, 0.32231396866715034, 0.3236716178223166, 0.32337559673820576, 0.32445332405066857, 0.32475626156144544, 0.3252435904297901, 0.3265533141981692, 0.32774666427084254, 0.3275763243474973, 0.32741628533865, 0.3293139024735304, 0.329299153540253, 0.3301510746454145, 0.32944009422975346, 0.33011716763427373, 0.3318371672166965, 0.3307094242794026, 0.3313554559818926, 0.3323478764209123, 0.33243255693475054, 0.33429537187513814, 0.3340524377526246, 0.3337428921990112, 0.3343534828459594, 0.3346938182705108, 0.33583981450408534, 0.3365555981581797, 0.3366977138946167, 0.33759064267567285, 0.33665083437477117, 0.33680003116441165, 0.3387344122981678, 0.33800284966780497, 0.33923906442154994, 0.34018027018526714, 0.339402549945029, 0.34034896161380357, 0.34092619253665435, 0.34106091738619193, 0.34184774969717086, 0.33999477339485873, 0.34178446989523886, 0.3431886536395331, 0.3433983802028066, 0.3430137023137505, 0.34353657980489627, 0.3440799979461879, 0.34417524233683927, 0.34529448399032114, 0.3464238732049521, 0.3457134508069307, 0.3453909075464653]]
#graph_dists = [[0.08483224226241722, 0.08314086700070045, 0.08264168234656959, 0.08191552428257504, 0.08092572873085592, 0.08001695346579779, 0.07981819353147823, 0.079678302405096, 0.07878840935705404, 0.0795710162131513, 0.07838255813627142, 0.07732550075685904, 0.0773567801166827, 0.07687668657601149, 0.0754819074568189, 0.07535700165330696, 0.07537497296843726, 0.07471277344835828, 0.07450391796042126, 0.07314780179338731, 0.07346726991459565, 0.07300654899474825, 0.07352507932285987, 0.07237565118637826, 0.07159787890834479, 0.07185101861909109, 0.07125149299754789, 0.07125109440682136, 0.07082941792347366, 0.07018406392320745, 0.06991734669313099, 0.06987345733091906, 0.06984117297587941, 0.06956904194366557, 0.06976321368826263, 0.06874985234213445, 0.06868224352954769, 0.06853416060803667, 0.06825444462396289, 0.06844551998685376, 0.06814882118932117, 0.06734747040288899, 0.06759835312716712, 0.06736828984858738, 0.06700102478482754, 0.06728030970441715, 0.0666549336776899, 0.06620955697928642, 0.06659622000126428, 0.0661813784634392, 0.06551798329723818, 0.06609701007131989, 0.06559437043368578, 0.06545253357879603, 0.06579078384941675, 0.06488981718303663, 0.06517772057791568, 0.06477001883951108, 0.06472758615374476, 0.06445055209011807, 0.06435884878776787, 0.06425488518006457, 0.06415120492731621, 0.06405059041506496, 0.06344792987620615, 0.06406215920855954, 0.06379311472114728, 0.06331613072561884, 0.0635059414415727, 0.06316171637013808, 0.06347207706112447, 0.06325057294455574, 0.06284152771571219, 0.0625706270129521, 0.06308912762246324, 0.06296610664838197, 0.06259457278411049, 0.06225003397456371, 0.06209282418295331, 0.06184781440232824, 0.0617618256496711, 0.06224629859830174, 0.06186285175145543, 0.06200017892503364, 0.0618092173176934, 0.061583462031510515, 0.06144100370157799, 0.06105455170513988, 0.06105156766117461, 0.061399641145668114, 0.06103195951208999, 0.06119992888997707, 0.060755958367356235, 0.06057679703157115, 0.06065500260569666, 0.06059239008772717, 0.06008433475042092, 0.06034641589845903, 0.060062338323665976, 0.0601312884238977, 0.06023927726875651], [0.1337033780370197, 0.13427882064160052, 0.133727402841125, 0.13294121390028396, 0.13330769860205746, 0.13141966791893084, 0.1309577968577298, 0.1317383716073694, 0.12974557109745058, 0.12955031609050388, 0.1295547267714376, 0.12986112765830754, 0.1282088955124134, 0.12857698304787757, 0.12819893573988153, 0.12784956185266222, 0.12702727129389874, 0.12662117365462372, 0.12585359174912886, 0.12632173035793667, 0.12552197228321355, 0.12503065361159615, 0.1249141457584092, 0.12438853300510536, 0.12428045664306264, 0.12414270932097855, 0.12405098679406405, 0.12379835450383428, 0.1233634675131002, 0.12248482399873468, 0.12246535740765674, 0.12219114988612578, 0.12183682785300662, 0.1216754391593308, 0.12120471294645334, 0.12145564177292471, 0.12089032308736494, 0.12070570964741292, 0.12053920200113895, 0.12056805294071289, 0.12006812149090144, 0.11996281151015549, 0.11911192563829402, 0.11940694651799058, 0.11931980995774868, 0.11901686134279543, 0.11895482370409664, 0.11943749984491311, 0.11867745520598258, 0.11827323580091575, 0.11898614061832921, 0.11781545885140916, 0.11770865513596933, 0.11776921598833201, 0.11736595920439671, 0.11740846987000428, 0.11731910908071401, 0.11747266319322472, 0.1168452035817544, 0.11644494297475978, 0.11667936737115543, 0.11681130480063576, 0.11634892429642596, 0.11622260478667659, 0.11584490067860823, 0.11591291406556552, 0.11580652282485823, 0.11534914530453218, 0.11536483333255931, 0.11489090440049317, 0.11512305660696635, 0.11513696306701766, 0.11524552097789624, 0.1149945161337741, 0.11424968135811238, 0.1143748932828077, 0.11447936046099667, 0.1144933261242608, 0.11484808023866186, 0.11463825472262605, 0.11414238758283227, 0.11419069954834375, 0.1141951646596701, 0.11347855387427504, 0.11361013465164094, 0.11364596502041495, 0.11307793072603264, 0.11282119651576272, 0.11325208026192628, 0.11326781375947174, 0.11344425164672474, 0.11295321803220755, 0.11302389473711405, 0.11275148556821535, 0.11265859938119607, 0.11301635471716112, 0.11249600889236847, 0.1127019269924042, 0.11219499140704833, 0.11256944142805995, 0.112361854422901], [0.222542383553143, 0.22283559290535002, 0.22269053245115702, 0.22222747797136178, 0.22287419627091679, 0.22213751038437332, 0.22166923566604718, 0.22001322572351598, 0.22082731949915851, 0.22070102110282433, 0.22009323638664813, 0.22003959655307598, 0.22050540634361773, 0.21990752089071924, 0.21940105964937792, 0.21912020528108428, 0.21935133769023424, 0.21845492145584805, 0.21852852896126418, 0.21849251719164475, 0.2183854072340917, 0.2179834892783167, 0.21806545254336704, 0.21702986344042366, 0.217700519612181, 0.21752221627309026, 0.21719932832397384, 0.2173000636646305, 0.2169217954767458, 0.2170093888380377, 0.2173395052043597, 0.21630563790673146, 0.2166991657448861, 0.21597404874399978, 0.21623873389731024, 0.2163102011542513, 0.21599623220883202, 0.21600853925687882, 0.2155677586001774, 0.21561717767045016, 0.21440156684166825, 0.21531045177616154, 0.2149059206202335, 0.2148042887608109, 0.215202179571485, 0.21481279414937168, 0.21412032272737994, 0.21390333950037171, 0.21386886102008024, 0.21434698534155153, 0.21380898918282468, 0.21376748638441678, 0.21419043271771798, 0.2132915770688387, 0.2133237031104341, 0.213111752364349, 0.213107083322107, 0.21331613271897204, 0.212913886872996, 0.213069915723784, 0.21309104633207704, 0.21250288448272836, 0.2130614404112085, 0.21284927534637954, 0.21234012592052695, 0.21238896927468148, 0.2126103637275992, 0.2126914970328888, 0.21235752388384407, 0.21262470366518887, 0.21160394688820078, 0.2119464428879465, 0.2120296861234518, 0.2116975165817987, 0.21179199756410125, 0.2109450916613202, 0.21171097583198914, 0.2112253435773972, 0.21158175716590066, 0.2112561446815408, 0.21126400430477116, 0.21161069544981595, 0.21045414192525164, 0.21084846592983336, 0.21131342272079143, 0.21081562399047288, 0.21082051214280345, 0.21102991362442447, 0.21075289517091508, 0.2108035380762603, 0.2109331312715102, 0.21022213235713938, 0.21050950910083532, 0.2105734770461943, 0.2108705758978669, 0.20993790074591204, 0.21068206541394371, 0.20981803384957115, 0.21017906486675084, 0.20980295566847076, 0.20980115293745705], [0.23474794656354706, 0.23539774591115176, 0.23546878622205641, 0.23668963296487697, 0.23569486758022692, 0.2369832856386342, 0.23680735666757197, 0.2379258031133523, 0.2380821277675806, 0.23747345999834563, 0.23832411753362875, 0.2385767397449195, 0.23869710194766705, 0.2385063013345518, 0.23868674083168262, 0.23881317135931548, 0.23981375507162506, 0.24014675243084443, 0.24031145888828606, 0.2394036938347762, 0.2400722486700268, 0.24131304734498174, 0.24002461173236234, 0.24128349932632345, 0.24070352611633053, 0.2408694066523947, 0.24108038603085197, 0.24063329334193692, 0.24159064708163952, 0.24127138005571985, 0.24248685578185264, 0.24261771289629683, 0.24159019848063057, 0.24249998114115243, 0.24226159680141404, 0.24256770574837638, 0.24253392690126624, 0.2425943445858198, 0.24289170484423378, 0.24265662846875222, 0.24381881769015762, 0.24341942748397324, 0.24341796247533282, 0.24382264232329667, 0.24330602375313154, 0.24336112198816734, 0.24345494185647576, 0.2438453409217764, 0.24345683697589565, 0.24338576270940232, 0.24369244629264236, 0.24396388588184398, 0.24380190060109733, 0.24404484099193713, 0.24461363731020686, 0.2449811439764999, 0.2438078070468761, 0.24385755770521017, 0.24459391676539566, 0.24418458994246448, 0.24420215417405539, 0.24463511362615878, 0.24506427832998848, 0.24475525473266035, 0.24494068544699657, 0.2447453125599235, 0.24505081306751694, 0.2450564210530776, 0.24542305604840622, 0.2448452216170433, 0.24517533147826942, 0.24500562995609831, 0.24549317098947138, 0.2456775100547674, 0.24524184615801134, 0.24538481530275602, 0.24483917115413742, 0.2456612005517512, 0.2455081138731318, 0.24574012276019022, 0.24562432026366093, 0.2453578791037573, 0.2459430453193127, 0.24638125549567577, 0.246097644013933, 0.24541105740304428, 0.2460445943639269, 0.24612450080378379, 0.24599519593859592, 0.24640391067499712, 0.24548732364468323, 0.24594351983041873, 0.24559233526146323, 0.2463459937602006, 0.24626367318808082, 0.2461032069342298, 0.2465608828402809, 0.24608072570973807, 0.24644341389672436, 0.24642578472102072, 0.24635837038124286], [0.324174049583873, 0.3243469735411972, 0.32547159613909205, 0.32622615088090223, 0.32719750881594284, 0.3294425825922639, 0.3307474172771729, 0.33064429715066623, 0.33255657227875624, 0.33270418659517476, 0.3336453611720141, 0.3341970352868379, 0.3352318160796191, 0.3361325081508399, 0.33823135632223894, 0.33886005985363105, 0.33843266297580465, 0.3400643790103255, 0.3408025024408996, 0.34263425682225507, 0.3425531018980723, 0.3426662607703571, 0.3434707106430015, 0.3449224530417693, 0.345717618720081, 0.34561464913444545, 0.3464178058535622, 0.34701719408277704, 0.3472946720050408, 0.3490503431843004, 0.34779093491299984, 0.34901204197992697, 0.3500326349455972, 0.3502814890118514, 0.35053174266655984, 0.3509165989823132, 0.35189727427298917, 0.35215724590185177, 0.352746889930487, 0.35271262093323097, 0.35356267278795145, 0.35395983882682075, 0.3549658381389726, 0.35459783254931443, 0.35517096193280717, 0.35552891281524845, 0.3568149780343578, 0.3566042627536523, 0.3574006267967772, 0.35781263768469124, 0.35799444060896557, 0.35835615881101024, 0.3587046411115296, 0.35944183237209615, 0.35890591652554554, 0.3596088166061102, 0.3605882799723871, 0.36058362754308193, 0.3609194066261091, 0.3618499992688736, 0.3616685833349442, 0.36179581191041266, 0.3613741520350608, 0.36212227471921854, 0.36342635807766216, 0.36289064489127, 0.36273918565887825, 0.3635868058838827, 0.3633486452936176, 0.3644774539471366, 0.364625587965439, 0.3646603911443818, 0.36439009419346846, 0.3650598302167076, 0.36562734729731183, 0.36632909310473405, 0.36637591976876627, 0.3663700957720271, 0.36596922453935243, 0.36651766343331466, 0.3672074621990646, 0.36659442729978126, 0.3675447963443101, 0.3672915457751821, 0.36716958129594135, 0.3685438915545573, 0.36861595906565897, 0.3689698373508891, 0.3689482609673881, 0.3681250963436028, 0.3691033339249919, 0.3696812008902572, 0.37011830253323114, 0.3697522465938186, 0.36955214892715954, 0.37035014751497, 0.37017670810298603, 0.3710528975498275, 0.3711201915058105, 0.37107052975855087, 0.3712393449896426]]
'''

#This block creates a graphic for mutation rates
'''
sigmass = [[],[],[],[],[]]
for sigma in [x/10 for x in range(50,101,1)]:
    sigmass[0].append(sigma)
    sigmass[1].append(sigma*3/4)
    sigmass[2].append(sigma*2/4)
    sigmass[3].append(sigma*1/4)
    sigmass[4].append(0)


theta = 6
nus = [0.01, 0.09, 0.2, 0.3, 0.4]
mut_ratess_AL = [[], [], [], [], []] # first index is type, second index is sigma.
mut_ratess = [[], [], [], [], []]
dark_red = (0.4, 0, 0)
bright_red = (0.9, 0.1, 0.1)

dark_green = (0, 0.4, 0)
bright_green = (0.1, 0.9, 0.1)

dark_blue = (0, 0, 0.4)
bright_blue = (0.2, 0.2, 1)

dark_yellow = (0.2, 0.2, 0)
bright_yellow = (0.8, 0.8, 0)

dark_purple = (0.2, 0, 0.4)
bright_purple = (0.7, 0.2, 1)



for j in range(len(sigmass[0])):
    sigmas =[sigmass[0][j], sigmass[1][j], sigmass[2][j], sigmass[3][j], sigmass[4][j]]
    _, _, _, _, mut_rates_AL, mut_rates = main(sigmas, theta, 10000, nus, 10, False)[:6]
    for i in range(len(mut_rates_AL)):
        mut_ratess_AL[i].append(mut_rates_AL[i])
        mut_ratess[i].append(mut_rates[i])

plt.xlabel("σ\u2080")
plt.ylabel("Mutation rate")
parameters = [(dark_red, bright_red), (dark_green, bright_green),(dark_blue, bright_blue),(dark_yellow, bright_yellow),(dark_purple, bright_purple)] #(colour AL, colour graph)
for i in range(len(parameters)):
    graph_color, AL_color = parameters[i]
    plt.plot(sigmass[0], mut_ratess_AL[i], color = AL_color)
    if i == 1 or i == 0:
        plt.annotate("Type " + str(i) +" AL", xy=(sigmass[0][-1], mut_ratess_AL[i][-1]), xytext=(sigmass[0][-1] + 0.15, mut_ratess_AL[i][-1]), size=7, va="center", annotation_clip=False)
    elif i ==2:
        plt.annotate("Type " + str(i) +" AL", xy=(sigmass[0][-1], mut_ratess_AL[i][-1]), xytext=(sigmass[0][-1] + 0.15, mut_ratess_AL[i][-1]+0.065), size=7, va="center", annotation_clip=False)

    elif i == 3:
        plt.annotate("Type " + str(i) +" AL", xy=(sigmass[0][-1], mut_ratess_AL[i][-1]), xytext=(sigmass[0][-1] + 0.15, mut_ratess_AL[i][-1]+0.02), size=7, va="center", annotation_clip=False)

    elif i == 4:
        plt.annotate("Type " + str(i) +" AL", xy=(sigmass[0][-1], mut_ratess_AL[i][-1]), xytext=(sigmass[0][-1] + 0.15, mut_ratess_AL[i][-1]+0.01), size=7, va="center", annotation_clip=False)

    plt.plot(sigmass[0], mut_ratess[i], color = graph_color)
    if i != 2:
        plt.annotate("Type "+str(i)+" G", xy=(sigmass[0][-1], mut_ratess[i][-1]), xytext=(sigmass[0][-1]+0.15, mut_ratess[i][-1]), size=7, va="center", annotation_clip=False)
    else:
        plt.annotate("Type "+str(i)+" G", xy=(sigmass[0][-1], mut_ratess[i][-1]), xytext=(sigmass[0][-1]+0.15, mut_ratess[i][-1]-0.025), size=7, va="center", annotation_clip=False)


plt.xlim(5, 10)
plt.show()

print(mut_ratess_AL)
print(mut_ratess)

#mut_ratess_AL = [[0.0973130591703142, 0.09786065734259863, 0.09913113651661705, 0.10128830427026768, 0.10124473274590899, 0.10192591343712874, 0.10281721712997327, 0.10352978426802534, 0.10645251933287771, 0.10707404093371502, 0.1070251926222713, 0.10936612025657359, 0.10955813396410516, 0.10874471444650664, 0.109430113495895, 0.11253019316594239, 0.11197348799318199, 0.1127823204293337, 0.11499155346114309, 0.11825588817953633, 0.11607816550435526, 0.11797943030459226, 0.11847314562304644, 0.12195546655357965, 0.12147845711244513, 0.12434866962573066, 0.12693101396732293, 0.12488346575865679, 0.125623434350736, 0.12712340479683729, 0.1281931247838621, 0.13102415246673133, 0.1324624543082861, 0.13262359896323728, 0.13479631438035805, 0.13302999371388743, 0.13639396656479202, 0.1357243731945654, 0.13842541273448672, 0.14105775350056918, 0.14335544120968183, 0.14181420261512295, 0.14419214404125097, 0.145579119668157, 0.14609038220218631, 0.14729511140953763, 0.1492749404311567, 0.14847977252599387, 0.15106951233826332, 0.15248437732338782, 0.1548751659303945], [0.7584898281352299, 0.7583417289732401, 0.7636073948246175, 0.7704815464976896, 0.7707311358502779, 0.7712601143424745, 0.7768156149868214, 0.7842626711656799, 0.7869783563370004, 0.7951406953698753, 0.8062291960371133, 0.8079963197453687, 0.8049033133108704, 0.8095703774144999, 0.821475332084499, 0.8248879407064403, 0.8217265722632405, 0.8288849352818708, 0.8422959021071862, 0.8378290522877847, 0.8474954168960275, 0.8517922508473345, 0.85366128501537, 0.8597136879671177, 0.8616220983001015, 0.8708483228381435, 0.87035615618502, 0.8813378365717606, 0.8891610918434851, 0.8884153790302043, 0.8963928203013126, 0.8984812210244653, 0.9079936479775939, 0.911612176287568, 0.914402732672494, 0.9145350966511787, 0.9245840562443972, 0.9364679601873791, 0.9261317376726268, 0.9378934735949259, 0.9466292250255225, 0.9473982190907336, 0.9541044050935552, 0.9501736679639492, 0.9626187565195445, 0.9592089023131254, 0.9663549099011762, 0.9741766093105794, 0.9831592478946357, 0.9834663285954065, 0.9855528265701282], [1.3926314190336413, 1.381511641055392, 1.382831335728649, 1.3874085111112466, 1.3969255353777292, 1.392815875603841, 1.406057644547743, 1.394319808731033, 1.395997340993048, 1.393116952734698, 1.401533156017678, 1.3982587256322632, 1.4010850565192523, 1.4060406511831072, 1.3976260484923544, 1.4029946554935313, 1.4092389006133563, 1.4041812373029638, 1.4047590708857356, 1.4004471981902853, 1.3967973806604876, 1.4121427791490404, 1.4082424479887352, 1.4040305755315798, 1.409185786340831, 1.4102654555809304, 1.406680160338833, 1.3950032723423516, 1.3968342429848832, 1.4074200618001946, 1.4063705806513327, 1.3983560629213698, 1.3889745803333209, 1.385405154719345, 1.389012052574289, 1.3957666829513933, 1.3878697540004288, 1.3881849435948315, 1.3802263676237363, 1.380822872958934, 1.384852036008314, 1.3665818925944144, 1.379346971693505, 1.370314332240784, 1.3741193677270713, 1.363725182218238, 1.3562789703045661, 1.3525280251844225, 1.3478392094509977, 1.3527738432757006, 1.3433195622526484], [1.6682394373500884, 1.663708861463482, 1.6565523399797215, 1.65025429564281, 1.6371770859806176, 1.647099254498236, 1.6343846386179002, 1.63639100507419, 1.6236992377913766, 1.6227508842866236, 1.6025319888384317, 1.6020695402883895, 1.5931274490941836, 1.5937511495316181, 1.5836172498327103, 1.5748419447971163, 1.5688362137853216, 1.5685590286829005, 1.5448837906010695, 1.541379907796111, 1.5451121607629752, 1.5418510191622223, 1.5258273058482024, 1.5328231110679245, 1.5169276020231344, 1.5096522160680257, 1.5033181634154393, 1.5024616881770236, 1.4842285214895958, 1.479821887610905, 1.4733437833551224, 1.4663071693659409, 1.4539488012938784, 1.4538839281827232, 1.4372116454568622, 1.4322444901851379, 1.4257244307766253, 1.4106653129843927, 1.4023780226333504, 1.3988491505609113, 1.391323472265938, 1.3754865188153451, 1.3711000331286731, 1.3698960134310294, 1.3570332601675565, 1.3394727542145082, 1.3398854682145809, 1.3222744180412067, 1.325601887020083, 1.3092200421714346, 1.3058850796537842], [1.8053486033353319, 1.786486532548785, 1.770953146238177, 1.7607577530881617, 1.746324648585378, 1.7345409390534494, 1.7220899563135614, 1.7067104900784555, 1.7025930928392927, 1.6930978942701551, 1.6687594349315156, 1.668211031143229, 1.6468091402544596, 1.648229744646265, 1.6332812160403918, 1.6125945499297847, 1.6084159637116422, 1.6003868842102782, 1.5882683250785736, 1.573308273887669, 1.5694208835789045, 1.5533848003663728, 1.5462055141651998, 1.5323012282353246, 1.5211098752906007, 1.517572050253319, 1.4955831835775166, 1.4871320754898756, 1.4722014403553776, 1.4574541376524295, 1.4517442061026584, 1.4456304234373085, 1.4316105059385134, 1.418549582984716, 1.4035719980002108, 1.3902002196624783, 1.3894255781044504, 1.3755279502579, 1.3724128391389447, 1.3530271127455993, 1.345863475677954, 1.3281818315702933, 1.3185223198899976, 1.3123647550458368, 1.3021258560901057, 1.2854830178920147, 1.2723743151467877, 1.2585783197155977, 1.2558037172590313, 1.243547434740581, 1.2394624479858232]]
#mut_ratess = [[0.060246159934567486, 0.060217627508180605, 0.06009465349556477, 0.060376309272610854, 0.06045398565188062, 0.06029493012847686, 0.060057726627171584, 0.05993821139890217, 0.0598412080344563, 0.06001510076294258, 0.060109235273887625, 0.06008818829323797, 0.06003513076570711, 0.059728298760161495, 0.05922939737803346, 0.06036542357202547, 0.05999120986746486, 0.05944306180760231, 0.05996341676467786, 0.060333072469893716, 0.05982966698389606, 0.06006016631801933, 0.05957107999453482, 0.06008655109047356, 0.059666571601025425, 0.06016065300910034, 0.059898142485600984, 0.05993568321044582, 0.060051787969364646, 0.05988733124457692, 0.05990054215105482, 0.060495994781607894, 0.060250691185843634, 0.06000461054839165, 0.060182946964751176, 0.05968258377148526, 0.06008253415316072, 0.06005042700906666, 0.060019377039186486, 0.059869388820682365, 0.06015749021399074, 0.06004572108419125, 0.0599738555167385, 0.06015246721914265, 0.06025126624159377, 0.05999056371286113, 0.05971596898345851, 0.059716553905365004, 0.05995763455672823, 0.05979828606938896, 0.05998281858638614], [0.5428958280605318, 0.5405706672534977, 0.5401745481040803, 0.540736902145493, 0.5418787536352643, 0.5394078379440702, 0.5400274784772945, 0.5405904603039207, 0.5383085475215419, 0.5401342279732682, 0.5410552629461585, 0.540208597534834, 0.5394180064556989, 0.5398304067385814, 0.5428155000568953, 0.5406195653536101, 0.5388786373932672, 0.5382619356698067, 0.5411035014977986, 0.5389283696929017, 0.5393682635668303, 0.5404687894215084, 0.5402633109406375, 0.5384280806753527, 0.5401965103448141, 0.5396093158890655, 0.5393358680603302, 0.5400267059262445, 0.5413223584971607, 0.5394794576274582, 0.5401872405776926, 0.539240171886189, 0.539851355703567, 0.540287397778061, 0.5418057721777358, 0.5390618728799277, 0.5390009804487798, 0.5413904189711639, 0.5395037541007085, 0.5398416117094826, 0.5403313281387501, 0.5385229272357827, 0.54065169600353, 0.5393939015661329, 0.5404629930788174, 0.5407222470952296, 0.5396785586120234, 0.5415228503363347, 0.5413937248508541, 0.5398052787830525, 0.539770213749643], [1.2037146355556767, 1.2024306342596625, 1.198573047579099, 1.2001200107349017, 1.1995687315706005, 1.2002436964407481, 1.2017388122044887, 1.2034600384646648, 1.2003884972438992, 1.1997123752764973, 1.2005149212577417, 1.199516800095977, 1.2019580485005925, 1.2017510239364002, 1.1990285914714018, 1.2021592713925253, 1.200202159320572, 1.2008971706704943, 1.1991891531133003, 1.197655549453771, 1.200473200544717, 1.2027944918848132, 1.2020894950177605, 1.199741987851002, 1.2011931400197455, 1.2004925399356636, 1.201308969470985, 1.1993367829557091, 1.1999611185895853, 1.1982959814409495, 1.2022749137865603, 1.1999287405890358, 1.1984780449414667, 1.1989396408145134, 1.1978146764822655, 1.1992779104704805, 1.200391553227572, 1.2013589589532647, 1.1999758212562208, 1.2010881432717033, 1.2001467020896346, 1.1993629405067256, 1.2017336692164626, 1.2002055150704483, 1.200359149783462, 1.2002837920627807, 1.1989857436977287, 1.1993643528541778, 1.1996215080486048, 1.2021121025653174, 1.1992813040795067], [1.8029677653979397, 1.800019322776454, 1.8005269480132016, 1.7966925613987315, 1.7955334642989194, 1.803326025493339, 1.7983018975291358, 1.802807310080596, 1.8036637634009685, 1.7986224120715086, 1.7991428943236634, 1.7971113757494228, 1.8005099988024749, 1.7986092104429405, 1.7982391374274016, 1.7975280248351617, 1.8011200282764235, 1.79670098424816, 1.799301917234727, 1.8002574963120348, 1.8029424909721155, 1.7994353904281903, 1.8001014526705648, 1.8018061784136918, 1.797796876188695, 1.800176770798699, 1.798817961847381, 1.8013077265235442, 1.7994525741728449, 1.8001912929063404, 1.8007115687959758, 1.8025133119215273, 1.8012658010355465, 1.800207691660239, 1.8006743612525482, 1.7976596618814347, 1.8014622431459064, 1.7995332254709708, 1.799678741065374, 1.7996865225773555, 1.8000393068856269, 1.80120834641548, 1.799712867894002, 1.8024921809218593, 1.799679635857522, 1.7972262393689147, 1.7999094329376306, 1.7985165523434832, 1.8012161571318712, 1.8008844504096253, 1.7995469336759264], [2.4056739796809974, 2.4031929579605333, 2.404379083073397, 2.3986233141749076, 2.400388085394486, 2.403614262046355, 2.3974961374220136, 2.4008161016598186, 2.403788035057226, 2.4024544611752687, 2.4010187602201625, 2.40051856009797, 2.3973763209948116, 2.4039136773538226, 2.4007465896995144, 2.401072357236867, 2.4011558242756754, 2.398479355432006, 2.403511167429124, 2.3938100176323696, 2.3991628126169258, 2.399430433088092, 2.398281934705681, 2.4018649156550724, 2.401330475917236, 2.4023989856226424, 2.3959870050278465, 2.399104741574897, 2.397391635143087, 2.3974246654627924, 2.4022657331986546, 2.3999180242565217, 2.402093803248807, 2.3957904170616886, 2.3981953991520095, 2.3975622905854306, 2.3997711812869653, 2.4004335137419974, 2.4044769140553175, 2.4035148179442207, 2.398199361777319, 2.400981159918066, 2.399652083488878, 2.3998705446665762, 2.4007141795982823, 2.4029060897290453, 2.3997138233896735, 2.397834322937015, 2.3994080197525385, 2.398206887071096, 2.4001628213732027]]
'''

#Blocks below compare type distributions.
#This block creates a graphic for a high sigma_0, similar to the one below but for K=2
'''
thetas = [x/10.0 for x in range(50, 151, 1)]

sigmas = [5, 0]
nus = [0.01, 0.99]
graph_dists = [[],[]] # first index is type, second index is theta.
AL_dists = [[],[]]
STD_total = [[],[]]
ATD_total = [[],[]]

dark_red = (0.4, 0, 0)
bright_red = (0.9, 0.1, 0.1)

dark_purple = (0.2, 0, 0.4)
bright_purple = (0.7, 0.2, 1)

for theta in thetas:
    graph_dist, AL_dist, ATD, STD= main(sigmas, theta, 10, nus, 10000, False)[:4]
    for i in range(len(graph_dist)):
        graph_dists[i].append(graph_dist[i]/sum(graph_dist))
        AL_dists[i].append(AL_dist[i]/sum(AL_dist))
        STD_total[i].append(STD[i]/sum(STD))
        ATD_total[i].append(ATD[i]/sum(ATD))


plt.xlabel("θ")
plt.ylabel("Type proportion in graph or AL")
parameters = [(dark_red, bright_red), (dark_purple, bright_purple)] #(colour AL, colour graph)
for i in range(len(parameters)):
    graph_color, AL_color = parameters[i]
    plt.plot(thetas, graph_dists[i], color = graph_color)
    for x in [6, 7, 8, 9, 10, 11, 12, 13, 14]:
        plt.plot(x, STD_total[i][(x-5)*10], "x", color = graph_color)
    if i == 0:
        plt.annotate("Type "+str(i)+" G", xy=(15, graph_dists[i][-1]), xytext=(15.15, graph_dists[i][-1]-0.015), size=7, va="center", annotation_clip=False)
        plt.annotate("Type "+str(i)+" AL", xy=(15, AL_dists[i][-1]), xytext=(15.15, AL_dists[i][-1]+0.015), size=7, va="center", annotation_clip=False)
    else:
        plt.annotate("Type "+str(i)+" G", xy=(15, graph_dists[i][-1]), xytext=(15.15, graph_dists[i][-1]+0.015), size=7, va="center", annotation_clip=False)
        plt.annotate("Type "+str(i)+" AL", xy=(15, AL_dists[i][-1]), xytext=(15.15, AL_dists[i][-1]-0.015), size=7, va="center", annotation_clip=False)

    plt.plot(thetas, AL_dists[i], color = AL_color)
    for x in [6, 7, 8, 9, 10, 11, 12, 13, 14]:
        plt.plot(x, ATD_total[i][(x-5)*10], "x", color = AL_color)

plt.xlim(5, 15)
plt.show()

print(graph_dists)
print(AL_dists)
print(STD_total)
print(ATD_total)
#graph_dists = [[0.030621166342984396, 0.03054234052240641, 0.028979578676459776, 0.029424524601863147, 0.02840805350997455, 0.02765315703691556, 0.027489112688199282, 0.026559715736715263, 0.026165270540545082, 0.0258710714377896, 0.025648525269914044, 0.025529130991533144, 0.024728436978002276, 0.02482263164942491, 0.024100020003844775, 0.023057967847734655, 0.023097422855169927, 0.023131651011266647, 0.022676868729537954, 0.022460022190968588, 0.02247561713004355, 0.02213604824857813, 0.021644996551417012, 0.02161912924487641, 0.02127822747441863, 0.021323854621847126, 0.02092575532182491, 0.020584464650960307, 0.02043253120013214, 0.020189727281034665, 0.019843708128170705, 0.020050480125274234, 0.019604872611111296, 0.019219437342927897, 0.019081421963350765, 0.019149644355301018, 0.018777032622956328, 0.01847185946755657, 0.018679697044041585, 0.018566083693004613, 0.0186670319631246, 0.018211305703265682, 0.01812072664827319, 0.018034534464830346, 0.017943578288305763, 0.018047618995927713, 0.017810105043744303, 0.01748491689545483, 0.017723246800483188, 0.017313812345446242, 0.01719815199572373, 0.017149914540228833, 0.016831053600539096, 0.017036541071267973, 0.016749358311636053, 0.016602312892059424, 0.0166591475458595, 0.01664072395852601, 0.016760602989297723, 0.016427619321839598, 0.01630910544308638, 0.01624157536258956, 0.0161127694073343, 0.01631386249675754, 0.01608389039508783, 0.016045117281455388, 0.015948100488602394, 0.01576655799634871, 0.015795644300322053, 0.015903552739079455, 0.015776200016844374, 0.015484179679955816, 0.015586705752337828, 0.015470243244625646, 0.015503037030264477, 0.015481892029605973, 0.015291938886379237, 0.015444342115035497, 0.015312644984175823, 0.015158293604395768, 0.015049792219456048, 0.015157094718892827, 0.015149938262419659, 0.015052804770916322, 0.014885554999991363, 0.014811096480723086, 0.014942239342573604, 0.014795233516462633, 0.01476922491371744, 0.01474848405915048, 0.01466846336289679, 0.014605101447058408, 0.014641178985941692, 0.014646453664202077, 0.014590816877134243, 0.01431499095975194, 0.014437610009524132, 0.014370079516437961, 0.014207668792611036, 0.014323999855793577, 0.014180962644265287], [0.9693788336570156, 0.9694576594775937, 0.9710204213235402, 0.9705754753981368, 0.9715919464900254, 0.9723468429630844, 0.9725108873118008, 0.9734402842632847, 0.973834729459455, 0.9741289285622104, 0.974351474730086, 0.9744708690084669, 0.9752715630219977, 0.975177368350575, 0.9758999799961552, 0.9769420321522653, 0.9769025771448301, 0.9768683489887333, 0.9773231312704621, 0.9775399778090313, 0.9775243828699565, 0.9778639517514219, 0.9783550034485831, 0.9783808707551235, 0.9787217725255813, 0.9786761453781528, 0.979074244678175, 0.9794155353490397, 0.9795674687998679, 0.9798102727189653, 0.9801562918718292, 0.9799495198747258, 0.9803951273888887, 0.980780562657072, 0.9809185780366493, 0.9808503556446989, 0.9812229673770436, 0.9815281405324435, 0.9813203029559584, 0.9814339163069954, 0.9813329680368754, 0.9817886942967342, 0.9818792733517268, 0.9819654655351696, 0.9820564217116943, 0.9819523810040723, 0.9821898949562557, 0.9825150831045452, 0.9822767531995168, 0.9826861876545537, 0.9828018480042763, 0.9828500854597712, 0.9831689463994608, 0.9829634589287319, 0.983250641688364, 0.9833976871079405, 0.9833408524541405, 0.9833592760414739, 0.9832393970107023, 0.9835723806781604, 0.9836908945569136, 0.9837584246374105, 0.9838872305926657, 0.9836861375032424, 0.9839161096049122, 0.9839548827185447, 0.9840518995113976, 0.9842334420036514, 0.984204355699678, 0.9840964472609206, 0.9842237999831556, 0.9845158203200443, 0.9844132942476621, 0.9845297567553744, 0.9844969629697354, 0.9845181079703941, 0.9847080611136207, 0.9845556578849646, 0.9846873550158242, 0.9848417063956043, 0.984950207780544, 0.9848429052811072, 0.9848500617375804, 0.9849471952290836, 0.9851144450000086, 0.9851889035192769, 0.9850577606574263, 0.9852047664835375, 0.9852307750862827, 0.9852515159408496, 0.9853315366371033, 0.9853948985529416, 0.9853588210140583, 0.985353546335798, 0.9854091831228657, 0.985685009040248, 0.9855623899904759, 0.9856299204835621, 0.985792331207389, 0.9856760001442064, 0.9858190373557347]]
#AL_dists = [[0.05138098138437408, 0.0510937101986654, 0.04881827207100575, 0.04939282515289331, 0.04724414409167708, 0.047078131532350166, 0.04631962922048867, 0.04455603120732924, 0.043614182365765385, 0.043263767824606815, 0.04267413895116396, 0.042367189345008806, 0.04093652574975842, 0.04075466553458114, 0.03953461710967406, 0.037783364295488744, 0.03765939399686828, 0.03745606264003407, 0.036457123766918204, 0.036404315173129156, 0.0356994665900367, 0.03575414876109537, 0.034455719271264014, 0.034722642437240055, 0.034276255746233955, 0.033779763678185165, 0.03302322763892245, 0.032585071589720335, 0.03246903070112009, 0.03171526636752317, 0.03153170357457678, 0.031185501965308945, 0.03074047090154202, 0.02982324659005851, 0.02973233140068874, 0.029126963525794435, 0.028770748430464545, 0.028269309236546466, 0.028970377831985503, 0.02842031867509809, 0.028439354298247004, 0.02768322754381074, 0.02776657930945966, 0.027595500118949248, 0.026957018544464143, 0.027551140004090886, 0.026732111843286086, 0.026096491806875077, 0.026146552301047968, 0.026006205807021548, 0.025696503809063017, 0.02531569113013755, 0.024673947178536614, 0.0253910214675338, 0.024636132702105046, 0.02418568309110954, 0.02440749407992384, 0.024167430355737297, 0.024584892577178823, 0.02354268790965709, 0.02388070551544236, 0.023396816636484324, 0.022916559594856504, 0.02351464583772928, 0.023205412914186638, 0.023079276429451897, 0.023138182648052754, 0.02247869581579879, 0.02240610472629486, 0.02245622350977432, 0.02272813409498759, 0.021578767104199304, 0.021994075430257887, 0.02194833264820537, 0.021601690040544387, 0.021506812716021107, 0.02138226351987449, 0.02143641785317102, 0.02128655945720458, 0.021088439349505564, 0.021042541073582565, 0.02093767234380837, 0.020788599922997284, 0.020803777439410705, 0.02049165936413754, 0.020536552911247088, 0.020393215246827114, 0.020537685621310437, 0.02016819353128838, 0.02010267770095705, 0.020170006073279956, 0.019928637852655584, 0.019897634460001954, 0.020019941028792503, 0.019801981695517504, 0.019637026871756415, 0.01930717538186956, 0.01903506361273083, 0.019028926090846957, 0.01905661235972108, 0.01931243518640998], [0.948619018615626, 0.9489062898013346, 0.9511817279289941, 0.9506071748471068, 0.9527558559083229, 0.9529218684676498, 0.9536803707795113, 0.9554439687926707, 0.9563858176342347, 0.9567362321753933, 0.957325861048836, 0.9576328106549913, 0.9590634742502415, 0.9592453344654189, 0.9604653828903259, 0.9622166357045112, 0.9623406060031318, 0.9625439373599659, 0.9635428762330818, 0.9635956848268709, 0.9643005334099632, 0.9642458512389047, 0.965544280728736, 0.9652773575627599, 0.9657237442537661, 0.9662202363218149, 0.9669767723610776, 0.9674149284102797, 0.9675309692988799, 0.9682847336324768, 0.9684682964254231, 0.968814498034691, 0.9692595290984579, 0.9701767534099416, 0.9702676685993114, 0.9708730364742055, 0.9712292515695355, 0.9717306907634535, 0.9710296221680145, 0.9715796813249019, 0.971560645701753, 0.9723167724561892, 0.9722334206905403, 0.9724044998810507, 0.9730429814555359, 0.972448859995909, 0.973267888156714, 0.9739035081931249, 0.9738534476989521, 0.9739937941929784, 0.9743034961909369, 0.9746843088698625, 0.9753260528214633, 0.9746089785324661, 0.975363867297895, 0.9758143169088904, 0.9755925059200761, 0.9758325696442628, 0.9754151074228212, 0.9764573120903429, 0.9761192944845576, 0.9766031833635157, 0.9770834404051435, 0.9764853541622708, 0.9767945870858133, 0.976920723570548, 0.9768618173519473, 0.9775213041842011, 0.9775938952737052, 0.9775437764902256, 0.9772718659050124, 0.9784212328958006, 0.9780059245697421, 0.9780516673517946, 0.9783983099594555, 0.9784931872839789, 0.9786177364801255, 0.978563582146829, 0.9787134405427954, 0.9789115606504945, 0.9789574589264174, 0.9790623276561916, 0.9792114000770028, 0.9791962225605894, 0.9795083406358626, 0.9794634470887529, 0.9796067847531729, 0.9794623143786896, 0.9798318064687116, 0.9798973222990429, 0.9798299939267201, 0.9800713621473445, 0.9801023655399981, 0.9799800589712074, 0.9801980183044825, 0.9803629731282435, 0.9806928246181303, 0.9809649363872691, 0.9809710739091531, 0.980943387640279, 0.98068756481359]]
#STD_total = [[0.0332, 0.0293, 0.0287, 0.0292, 0.0297, 0.0291, 0.0289, 0.0289, 0.0267, 0.0251, 0.0267, 0.0269, 0.0241, 0.0251, 0.0243, 0.0255, 0.0228, 0.0241, 0.0233, 0.0225, 0.0208, 0.0226, 0.022, 0.0217, 0.0252, 0.0215, 0.0206, 0.0225, 0.0209, 0.0199, 0.0218, 0.0193, 0.0183, 0.0172, 0.0199, 0.0201, 0.0181, 0.0202, 0.0191, 0.0175, 0.0208, 0.0176, 0.02, 0.0169, 0.0184, 0.0187, 0.0174, 0.0159, 0.0194, 0.0168, 0.0176, 0.0185, 0.0162, 0.0177, 0.0198, 0.0159, 0.0159, 0.0163, 0.0183, 0.0164, 0.0166, 0.015, 0.0166, 0.0151, 0.0148, 0.0191, 0.0183, 0.0147, 0.0152, 0.0169, 0.015, 0.0157, 0.0163, 0.0157, 0.014, 0.0167, 0.0152, 0.0141, 0.0143, 0.0165, 0.0137, 0.0138, 0.0155, 0.0141, 0.015, 0.0146, 0.0155, 0.0133, 0.0142, 0.0147, 0.0152, 0.0151, 0.0153, 0.0145, 0.0161, 0.0153, 0.0145, 0.0143, 0.0167, 0.0135, 0.0146], [0.9668, 0.9707, 0.9713, 0.9708, 0.9703, 0.9709, 0.9711, 0.9711, 0.9733, 0.9749, 0.9733, 0.9731, 0.9759, 0.9749, 0.9757, 0.9745, 0.9772, 0.9759, 0.9767, 0.9775, 0.9792, 0.9774, 0.978, 0.9783, 0.9748, 0.9785, 0.9794, 0.9775, 0.9791, 0.9801, 0.9782, 0.9807, 0.9817, 0.9828, 0.9801, 0.9799, 0.9819, 0.9798, 0.9809, 0.9825, 0.9792, 0.9824, 0.98, 0.9831, 0.9816, 0.9813, 0.9826, 0.9841, 0.9806, 0.9832, 0.9824, 0.9815, 0.9838, 0.9823, 0.9802, 0.9841, 0.9841, 0.9837, 0.9817, 0.9836, 0.9834, 0.985, 0.9834, 0.9849, 0.9852, 0.9809, 0.9817, 0.9853, 0.9848, 0.9831, 0.985, 0.9843, 0.9837, 0.9843, 0.986, 0.9833, 0.9848, 0.9859, 0.9857, 0.9835, 0.9863, 0.9862, 0.9845, 0.9859, 0.985, 0.9854, 0.9845, 0.9867, 0.9858, 0.9853, 0.9848, 0.9849, 0.9847, 0.9855, 0.9839, 0.9847, 0.9855, 0.9857, 0.9833, 0.9865, 0.9854]]
#ATD_total = [[0.0522, 0.0466, 0.0447, 0.0511, 0.0492, 0.0465, 0.0475, 0.0452, 0.0463, 0.0427, 0.0436, 0.0392, 0.0383, 0.0411, 0.0425, 0.0407, 0.038, 0.0391, 0.0368, 0.0374, 0.0374, 0.0374, 0.0349, 0.034, 0.034, 0.0358, 0.0305, 0.031, 0.0302, 0.0295, 0.0289, 0.0308, 0.0324, 0.0297, 0.0289, 0.0285, 0.0296, 0.0327, 0.0292, 0.0271, 0.0283, 0.0278, 0.0254, 0.0283, 0.0263, 0.0282, 0.0253, 0.0225, 0.0274, 0.0263, 0.0244, 0.0266, 0.0259, 0.0248, 0.0234, 0.0252, 0.0235, 0.0249, 0.0229, 0.0214, 0.0219, 0.0241, 0.0224, 0.0257, 0.0252, 0.0236, 0.0271, 0.0225, 0.0227, 0.023, 0.0227, 0.0225, 0.0222, 0.0218, 0.0219, 0.0228, 0.0234, 0.0202, 0.0221, 0.0211, 0.0227, 0.0218, 0.0192, 0.0189, 0.021, 0.0207, 0.0216, 0.0189, 0.0194, 0.0195, 0.0227, 0.0206, 0.0213, 0.0236, 0.0191, 0.0204, 0.0194, 0.0184, 0.0197, 0.0204, 0.018], [0.9478, 0.9534, 0.9553, 0.9489, 0.9508, 0.9535, 0.9525, 0.9548, 0.9537, 0.9573, 0.9564, 0.9608, 0.9617, 0.9589, 0.9575, 0.9593, 0.962, 0.9609, 0.9632, 0.9626, 0.9626, 0.9626, 0.9651, 0.966, 0.966, 0.9642, 0.9695, 0.969, 0.9698, 0.9705, 0.9711, 0.9692, 0.9676, 0.9703, 0.9711, 0.9715, 0.9704, 0.9673, 0.9708, 0.9729, 0.9717, 0.9722, 0.9746, 0.9717, 0.9737, 0.9718, 0.9747, 0.9775, 0.9726, 0.9737, 0.9756, 0.9734, 0.9741, 0.9752, 0.9766, 0.9748, 0.9765, 0.9751, 0.9771, 0.9786, 0.9781, 0.9759, 0.9776, 0.9743, 0.9748, 0.9764, 0.9729, 0.9775, 0.9773, 0.977, 0.9773, 0.9775, 0.9778, 0.9782, 0.9781, 0.9772, 0.9766, 0.9798, 0.9779, 0.9789, 0.9773, 0.9782, 0.9808, 0.9811, 0.979, 0.9793, 0.9784, 0.9811, 0.9806, 0.9805, 0.9773, 0.9794, 0.9787, 0.9764, 0.9809, 0.9796, 0.9806, 0.9816, 0.9803, 0.9796, 0.982]]
'''



#This block creates a figure for a linear decrease in sigmas.
'''
thetas = [x/10.0 for x in range(50, 151, 1)]

sigmas = [6, 4.5, 3, 1.5, 0]
nus = [0.01, 0.09, 0.2, 0.3, 0.4]
graph_dists = [[],[],[],[],[]] # first index is type, second index is theta.
AL_dists = [[],[],[],[],[]]
STD_total = [[],[],[],[],[]]
ATD_total = [[],[],[],[],[]]
dark_red = (0.4, 0, 0)
bright_red = (0.9, 0.1, 0.1)

dark_green = (0, 0.4, 0)
bright_green = (0.1, 0.9, 0.1)

dark_blue = (0, 0, 0.4)
bright_blue = (0.2, 0.2, 1)

dark_yellow = (0.2, 0.2, 0)
bright_yellow = (0.8, 0.8, 0)

dark_purple = (0.2, 0, 0.4)
bright_purple = (0.7, 0.2, 1)

for theta in thetas:
    graph_dist, AL_dist, ATD, STD= main(sigmas, theta, 10, nus, 10000, False)[:4]
    for i in range(len(graph_dist)):
        graph_dists[i].append(graph_dist[i]/sum(graph_dist))
        AL_dists[i].append(AL_dist[i]/sum(AL_dist))
        STD_total[i].append(STD[i]/sum(STD))
        ATD_total[i].append(ATD[i]/sum(ATD))


plt.xlabel("θ")
plt.ylabel("Type proportion in graph or AL")
parameters = [(dark_red, bright_red), (dark_green, bright_green),(dark_blue, bright_blue),(dark_yellow, bright_yellow),(dark_purple, bright_purple)] #(colour AL, colour graph)
for i in range(len(parameters)):
    graph_color, AL_color = parameters[i]
    plt.plot(thetas, graph_dists[i], color = graph_color)
    for x in [6, 7, 8, 9, 10, 11, 12, 13, 14]:
        plt.plot(x, STD_total[i][(x-5)*10], "x", color = graph_color)
    if i == 0:
        plt.annotate("Type "+str(i)+" G", xy=(15, graph_dists[i][-1]), xytext=(15.15, graph_dists[i][-1]-0.01), size=7, va="center", annotation_clip=False)
        plt.annotate("Type "+str(i)+" AL", xy=(15, AL_dists[i][-1]), xytext=(15.15, AL_dists[i][-1]), size=7, va="center", annotation_clip=False)
    elif i == 1:
        plt.annotate("Type "+str(i)+" G", xy=(15, graph_dists[i][-1]), xytext=(15.15, graph_dists[i][-1]), size=7, va="center", annotation_clip=False)
        plt.annotate("Type "+str(i)+" AL", xy=(15, AL_dists[i][-1]), xytext=(15.15, AL_dists[i][-1]), size=7, va="center", annotation_clip=False)
    elif i == 2:
        plt.annotate("Type "+str(i)+" G", xy=(15, graph_dists[i][-1]), xytext=(15.15, graph_dists[i][-1]), size=7, va="center", annotation_clip=False)
        plt.annotate("Type "+str(i)+" AL", xy=(15, AL_dists[i][-1]), xytext=(15.15, AL_dists[i][-1]), size=7, va="center", annotation_clip=False)
    elif i == 3:
        plt.annotate("Type "+str(i)+" G", xy=(15, graph_dists[i][-1]), xytext=(15.15, graph_dists[i][-1]+0.005), size=7, va="center", annotation_clip=False)
        plt.annotate("Type "+str(i)+" AL", xy=(15, AL_dists[i][-1]), xytext=(15.15, AL_dists[i][-1]-0.005), size=7, va="center", annotation_clip=False)
    elif i == 4:
        plt.annotate("Type "+str(i)+" G", xy=(15, graph_dists[i][-1]), xytext=(15.15, graph_dists[i][-1]), size=7, va="center", annotation_clip=False)
        plt.annotate("Type "+str(i)+" AL", xy=(15, AL_dists[i][-1]), xytext=(15.15, AL_dists[i][-1]), size=7, va="center", annotation_clip=False)

    plt.plot(thetas, AL_dists[i], color = AL_color)
    for x in [6, 7, 8, 9, 10, 11, 12, 13, 14]:
        plt.plot(x, ATD_total[i][(x-5)*10], "x", color = AL_color)



plt.xlim(5, 15)
plt.show()

print(graph_dists)
print(AL_dists)
print(STD_total)
print(ATD_total)
#graph_dists = [[0.024428240000988838, 0.023543831104934212, 0.023495161034949086, 0.023710800213776365, 0.023162953793996507, 0.02249543334659239, 0.022168949673872954, 0.021924737501532267, 0.022089944645392667, 0.021563992576221536, 0.02175364081487843, 0.020843195337751953, 0.020757483699537872, 0.02074119772244918, 0.02048570094706721, 0.020485194638757892, 0.02010163417315325, 0.020199699574601528, 0.019947151475845103, 0.019342342419600488, 0.018845677926270874, 0.018986158844431413, 0.019409697980547723, 0.018712643875544693, 0.01858687333353934, 0.018261371210060617, 0.01836646106426351, 0.018059712262679325, 0.018285213569290713, 0.017993334225403137, 0.0176622654194557, 0.017454521515928818, 0.017543849466992143, 0.01737030748590198, 0.01718439436808688, 0.017641261907659224, 0.01726150747029482, 0.01695969150293214, 0.01698509208057644, 0.017125530877866633, 0.016680675236217465, 0.0168221527918264, 0.01668054102634816, 0.016505234858502308, 0.016549540390368912, 0.01655250580425201, 0.016256682225977953, 0.016345539208851692, 0.01585372347706513, 0.016249992180817133, 0.01597517272770654, 0.015841474155154207, 0.015859994211122462, 0.01563567943179108, 0.015625287630595577, 0.015599232808679232, 0.015387747098002098, 0.01555301734523563, 0.015309012019127486, 0.015285057305387572, 0.015263471833152518, 0.015160844718746206, 0.015109696591275222, 0.015129632461541836, 0.014716091572671614, 0.014937924647486698, 0.014897390567016361, 0.014864702117869126, 0.015124586158449221, 0.01480444624652472, 0.014909979030119794, 0.01464338302469581, 0.014511262086569674, 0.014543948994849412, 0.01469531490539106, 0.014591923594681476, 0.014512220899735652, 0.014495134506528982, 0.014271384272319597, 0.014420443704669337, 0.01406990031174198, 0.0140968751994581, 0.014254078109376981, 0.014187269321205561, 0.014113215425976171, 0.013921141765956244, 0.014182884051065816, 0.014060582329891663, 0.01403704570822429, 0.014065855337849816, 0.013847245620024005, 0.014033008529162927, 0.013813662521415066, 0.013905527951867265, 0.0137874250623811, 0.013728389627358993, 0.013716747638603075, 0.013549986806732915, 0.013657687323610102, 0.013496572817573885, 0.01365949227230796], [0.15078704684034577, 0.14935661708267253, 0.14729788201181282, 0.14716506146179173, 0.14622451215547005, 0.14418873998361478, 0.14350324784616017, 0.14295755322977607, 0.14138713674092704, 0.14134086878803853, 0.14005036441233532, 0.1398833245141674, 0.13787341855428853, 0.13739077809793226, 0.13627346684862313, 0.13569414750089864, 0.13593146162958986, 0.13398975140922728, 0.1333659288595471, 0.13348330721542923, 0.132362382584882, 0.13181384818377664, 0.13153828921831778, 0.1310065812509781, 0.1299198120191628, 0.1296536774461842, 0.12922191335966726, 0.1291793043648182, 0.12790939789435182, 0.12747251846019558, 0.1271120924950752, 0.12597633359434346, 0.12565904652254212, 0.12582470800138093, 0.12477951181381082, 0.1246607834279209, 0.12474791632962261, 0.12388744705164327, 0.12375986991789514, 0.12283800533854634, 0.12278344665615346, 0.12231291443469594, 0.12175393264193118, 0.1217653532044053, 0.12167737284674347, 0.12071310358046329, 0.1210091908423444, 0.12008084205677458, 0.11980195533094884, 0.11999670001798333, 0.11910184627344325, 0.11882543047137809, 0.1182961362149682, 0.11814487919251845, 0.117716975601688, 0.11720838264040093, 0.11777056591852961, 0.11694754143848138, 0.11682907097014597, 0.1167137351661939, 0.11615934852727725, 0.11630837343471573, 0.11592900673618384, 0.1151988200895505, 0.11560310309060871, 0.11508256775727775, 0.11504221199424472, 0.11509348418128895, 0.11428133987859264, 0.11461061093688692, 0.11424607321194474, 0.11447175332781016, 0.11347734315789304, 0.1135007703261054, 0.11323124796751168, 0.11288587629508551, 0.11306063692188102, 0.11222382034912137, 0.11249150190503206, 0.11219560034534871, 0.11177137803481865, 0.11181679168225744, 0.1118744761725803, 0.11178616001082561, 0.11158545564603278, 0.1116076108284871, 0.11118620450750308, 0.11108890813921596, 0.11022573078868687, 0.11055206701072318, 0.11029273749784364, 0.11053495080810152, 0.11007701909871984, 0.11014587045034614, 0.11032805823786236, 0.10996543736659242, 0.10965881494332567, 0.10909232098427595, 0.10976208338987058, 0.10937662047426418, 0.10909476391108437], [0.24286456408987445, 0.2438132109676816, 0.24243617694909675, 0.24225346035041775, 0.24079551461746324, 0.24076297567208427, 0.23995647572786272, 0.23981394177794377, 0.23898478595041261, 0.23894916601462468, 0.23862899534944942, 0.2372542049177007, 0.23913522265692, 0.2368875523219028, 0.23611456086780702, 0.23596791785569965, 0.23550955762001002, 0.2348680430127936, 0.23575336475566883, 0.23523063695275057, 0.23444902583125132, 0.2341572828831994, 0.23288158468162246, 0.23302588664733537, 0.2330874322248263, 0.23241135955448897, 0.23240094830233762, 0.23156792653398411, 0.23106623163417658, 0.23119949517461705, 0.231215077765559, 0.2298801121721501, 0.23033799947310563, 0.2298150678690681, 0.2292357034487252, 0.2295827752936338, 0.22939430108879807, 0.2293499002058283, 0.22862151472902376, 0.22845518396791462, 0.2279747761830321, 0.22734878349667048, 0.22806466979952164, 0.22731785644684396, 0.22760841862243944, 0.2270283374155406, 0.2267082367943102, 0.22594946466367155, 0.2264578892135119, 0.22588128659383286, 0.22541322283526136, 0.225721823954681, 0.22557243436124647, 0.2258366145829391, 0.22494898161638763, 0.2247587340150903, 0.22396329202407464, 0.2239856213039015, 0.2243670865652334, 0.22349475056709658, 0.22393881289293688, 0.2231381505509053, 0.22320259062791367, 0.22332779335207686, 0.22321380763741827, 0.22236301610451215, 0.22302798474099575, 0.22209595240674124, 0.22243065706513068, 0.2218064846883875, 0.22207611149981446, 0.22176823163304496, 0.22174065077747776, 0.22135309374888637, 0.22154007273273424, 0.22164405927172773, 0.22070795979335042, 0.22133991542876266, 0.22092133038099646, 0.22040001948593593, 0.22107867533083028, 0.22097282011863928, 0.22019310158370414, 0.2205026110234975, 0.21996099475936387, 0.21956603142995446, 0.21940345814120335, 0.21937583145765147, 0.21958293481610688, 0.21940190051037578, 0.21889741123923356, 0.21881427411270907, 0.21935520420498203, 0.21867112041387446, 0.21871002739129947, 0.2184053458718308, 0.21867247354603817, 0.21857862548773024, 0.2178496200437588, 0.2179124672041281, 0.21769263105699382], [0.2812376393883589, 0.28068839346697627, 0.2832311125700788, 0.2822732921699314, 0.2830810978968854, 0.2841192149337106, 0.28495432970111206, 0.2842953097128909, 0.2844310984747201, 0.28489244094371924, 0.2854963762064637, 0.28565678553375723, 0.2856895964713355, 0.2871421268541679, 0.28782426419989976, 0.28765243146621045, 0.28709296485584174, 0.288009778120925, 0.28811981399651293, 0.28786855389117505, 0.28927693515539354, 0.2891498877391866, 0.28962027200879914, 0.2897093972581594, 0.29031040209237446, 0.29018938263969246, 0.28953824843056575, 0.2905699503441318, 0.2914521741148763, 0.2908529907688042, 0.29124482184100586, 0.2920768419160783, 0.29163088880421495, 0.29120009366523747, 0.292561355867021, 0.2916233382206872, 0.2918915071438972, 0.29233775062002615, 0.2923121148968899, 0.2927954724529736, 0.2926488148668869, 0.29304220277746423, 0.29220287007627427, 0.29306566803641304, 0.2925881367745374, 0.29338624725954804, 0.2933967331211642, 0.2937603035998884, 0.2935994363128272, 0.293969744666891, 0.2936157345916319, 0.2944004541496242, 0.2937528837928256, 0.29360973776064714, 0.2942449329999202, 0.29456746732634975, 0.29497771906073245, 0.2944411677285733, 0.2951505862996733, 0.2950145595592674, 0.29455961085541177, 0.2953099370059536, 0.2951112094976929, 0.29512252212956674, 0.29460038944007266, 0.2951649712948824, 0.295271103267618, 0.29503717280435177, 0.2955447608899523, 0.295480870182344, 0.29535540759942813, 0.29495228050022226, 0.29566024488748155, 0.29553224608847484, 0.2958777120268172, 0.2954495457727992, 0.2957908272255063, 0.2962778578251563, 0.29603369578631406, 0.2961341812203365, 0.29645251145928125, 0.29565928485183257, 0.2958775449044335, 0.29603761859818806, 0.29585496370003983, 0.2969591657983318, 0.2962965496460458, 0.29654665897817445, 0.29676271306060625, 0.2970200987291696, 0.29695156138217577, 0.2965605788788386, 0.2964934834397971, 0.2970588407547985, 0.29655823704076595, 0.2966749731593323, 0.29685773175124763, 0.29700197530686556, 0.29736980347576153, 0.29698221669588865, 0.29704889170874843], [0.30068250968043203, 0.3025979473777354, 0.30353966743406247, 0.30459738580408274, 0.30673592153618484, 0.30843363606399793, 0.3094169970509921, 0.311008457777857, 0.3131070341885475, 0.313253531677396, 0.3140706232168731, 0.3163624896966227, 0.31654427861791806, 0.3178383450035479, 0.3193020071366028, 0.32020030853843345, 0.3213643817214052, 0.32293272788245253, 0.32281374091242604, 0.3240751595210446, 0.32506597850220226, 0.32589282234940586, 0.3265501561107129, 0.32754549096798247, 0.328095480330097, 0.3294842091495737, 0.3304724288431659, 0.3306231064943865, 0.3312869827873046, 0.3324816613709801, 0.33276574247890417, 0.33461219080149934, 0.33482821573314514, 0.3357898229784115, 0.33623903450235604, 0.33649184115009884, 0.3367047679673873, 0.3374652106195702, 0.3383214083756148, 0.33878580736269887, 0.3399122870577101, 0.3404739464993429, 0.34129798645592485, 0.34134588745383543, 0.34157653136591076, 0.342319805940196, 0.3426291570162032, 0.3438638504708138, 0.344286995665647, 0.3439022765404757, 0.345894023571957, 0.3452108172691626, 0.34651855141983723, 0.34677308903210424, 0.34746382215140853, 0.3478661832094798, 0.34790067589866125, 0.3490726521838083, 0.3483442441458198, 0.3494918974020546, 0.35007875589122167, 0.3500826942896792, 0.3506474965469344, 0.35122123196726407, 0.35186660825922883, 0.352451520195841, 0.3517613094301251, 0.3529086884897488, 0.3526186560078751, 0.3532975879458569, 0.35341242865869293, 0.3541643515142268, 0.3546104990905779, 0.35506994084168403, 0.3546556523675458, 0.355428595065706, 0.35592835515952664, 0.3556632718904306, 0.35628208765533775, 0.35684975524370954, 0.35662753486332777, 0.35745422814781264, 0.35780079922990504, 0.35748634104628324, 0.35848537046858747, 0.3579460501772705, 0.358930903654182, 0.3589280190950665, 0.3593915756263757, 0.35896007841188166, 0.3600110442607231, 0.36005718767118783, 0.3602606307350859, 0.3602186404291136, 0.3606162522676911, 0.36122585397488555, 0.3610942321207854, 0.3617770914143953, 0.3613608057669991, 0.36223212280814526, 0.3625042210508653]]
#AL_dists = [[0.03783201346610772, 0.03627410010981255, 0.03641679790915611, 0.03654132617037692, 0.03554044285857666, 0.03449052915407364, 0.03422258114805329, 0.0337349363932319, 0.033939819219687604, 0.0329173592609318, 0.03333237384406698, 0.031838876121171616, 0.03181644713118252, 0.031550051141107954, 0.030824278665567535, 0.0312325200920633, 0.030337502710992725, 0.030428376150455502, 0.02972529377194009, 0.029201926793523392, 0.028347114002917426, 0.028102714493270613, 0.028618768207244745, 0.027727708058940745, 0.02775424069218706, 0.02716908941542722, 0.027425849790580988, 0.02618950437652386, 0.02702108930437271, 0.026368975858844824, 0.02565341182961314, 0.025535674143593534, 0.025073701395618455, 0.02540716326713631, 0.024647863850746677, 0.025820316999936324, 0.024820101220706037, 0.024248331842260582, 0.024248844442911786, 0.02440503543477678, 0.02366961472776316, 0.024102445782490264, 0.023601831541703734, 0.02324107589454036, 0.023489597580127072, 0.023316605244588166, 0.023004610057253103, 0.02320911983320356, 0.02232334489532442, 0.0225937228353658, 0.022151397754903133, 0.021986124478375776, 0.022044377939514324, 0.021682909939105384, 0.021465188454359182, 0.021614142222266063, 0.021101568254064885, 0.021663056246103308, 0.02114277441637622, 0.021002603012137144, 0.020946518650526526, 0.020899832176256367, 0.020788332378353116, 0.020641125160114623, 0.019856364591056528, 0.019827119025155698, 0.020225873078291413, 0.019856100285892936, 0.020508957678489585, 0.01973987549681251, 0.02003625414791632, 0.019728163573238214, 0.019340956818004025, 0.01961587215704852, 0.019780522688808616, 0.01954663480342006, 0.019306407881188294, 0.01916913904555397, 0.018959514459399706, 0.019046485056006875, 0.018348263679644147, 0.01841547411193898, 0.018954175011269784, 0.019005649917786388, 0.01872854301516133, 0.018123946956518536, 0.018464429480328844, 0.018166815675072202, 0.01834025387454631, 0.018355331996298966, 0.01803322173742324, 0.01817494128599542, 0.018004385145105172, 0.017884952450602593, 0.017845181789539078, 0.017696205851177087, 0.017585068512356677, 0.01723151072452351, 0.01755318227032688, 0.017225086472748483, 0.017315379630801424], [0.19999318711957517, 0.19698414173620118, 0.19484022658777866, 0.1937084092323399, 0.19188496743150743, 0.18969830446380134, 0.18862002548154164, 0.18693266311978843, 0.18624099055431972, 0.18450206928717142, 0.18320805544360166, 0.18258267525919966, 0.17866967582703225, 0.17759506098922737, 0.17613990403140023, 0.17514014650319815, 0.176051862659182, 0.17259827079734424, 0.17057628832896962, 0.17188548336443926, 0.16932380308434553, 0.16928583681145803, 0.16911908447020627, 0.16751335779899146, 0.16601858852684073, 0.16509091496105222, 0.1647683433186827, 0.16397388471375773, 0.16205229027318613, 0.16148606531797324, 0.1609734188429021, 0.15998662331643482, 0.15799106739240268, 0.15844333975454783, 0.15666111458552529, 0.15563541304143413, 0.15657710355681762, 0.15529455431602956, 0.1541164780209061, 0.15315147478456026, 0.15312595532421083, 0.1516628056656768, 0.1513254920056138, 0.15119040501356928, 0.15051283751043656, 0.14936215169473574, 0.14998369660229227, 0.1486148173538453, 0.1477517134315464, 0.14762528514536338, 0.14710311097232795, 0.1462671277043335, 0.14518793877124472, 0.14500001503595147, 0.14384068858586804, 0.1428787230148633, 0.14403262670761816, 0.14371450572142014, 0.14170941203952828, 0.14209412116717543, 0.14166107516725746, 0.14205226336234686, 0.14037338364601148, 0.13897872767383224, 0.14052783757435938, 0.13969252583406516, 0.13859765966832358, 0.13836390782830174, 0.13792180551727368, 0.13834805920689433, 0.13762812370328975, 0.13784306935957885, 0.13611087348086437, 0.13604959627759924, 0.1358032165218117, 0.13555223467819713, 0.1350680067005502, 0.13365986687537768, 0.13444213648868228, 0.13340614123522615, 0.13358663230314397, 0.13266133477961287, 0.1325380060360158, 0.13191200276070733, 0.132210781594376, 0.1315840782629211, 0.13195365957832145, 0.13122518164357652, 0.1298869535068058, 0.13099378529614747, 0.13001920620595017, 0.12989630163563345, 0.12953282391087562, 0.1300117284219625, 0.12977332010429055, 0.12879602638913917, 0.12890683060937458, 0.12791642808469914, 0.1284072988610999, 0.12839443962958955, 0.12789051598669107], [0.2676145741247145, 0.2708386427849813, 0.26787987136098307, 0.2677431984028484, 0.2676563052770341, 0.2662884198784278, 0.2652729534979085, 0.26549112408592984, 0.2644060181236193, 0.26409903748597424, 0.2629573129314494, 0.26193997319644896, 0.2644675839328015, 0.2614990075189549, 0.26068656265743756, 0.2598571961488707, 0.25991433743343445, 0.25988697186723286, 0.26044408211961423, 0.259322939557509, 0.25878718896179875, 0.25822627891358535, 0.25517639111096635, 0.2575696518753191, 0.2578984703405301, 0.25576931952699755, 0.25541986484255885, 0.2550412051241626, 0.25352458448878157, 0.25314216090131764, 0.2539143007529287, 0.25201831148906817, 0.2531937525772671, 0.25212269967551126, 0.25116886261343746, 0.2518255382918254, 0.2518243556672108, 0.2516373301365928, 0.2498523344246647, 0.25066086502765467, 0.2495839011872729, 0.24944847125622585, 0.24870727011491547, 0.24807157384399814, 0.24924813180302735, 0.24824759953934267, 0.24628330588953104, 0.2462708541371929, 0.24707579983006042, 0.24670831188321138, 0.2459708653027409, 0.24534026883866875, 0.24607522308195875, 0.24576869536374651, 0.24424925860998212, 0.24440364233703196, 0.24357870056672315, 0.24342711500707748, 0.24389782834727028, 0.2431881440656017, 0.24325487500858972, 0.24274497859164482, 0.2420788161760268, 0.24196879525269202, 0.24118161292076695, 0.24096025994750528, 0.2417264508560316, 0.2419065569134348, 0.24068758347889835, 0.24036334827033282, 0.2394056962474444, 0.23982970973382742, 0.2383032393627536, 0.2390576576316034, 0.23883175127218417, 0.2388296440789522, 0.2379693187537549, 0.2388252964877976, 0.238264573021204, 0.23695280859415585, 0.23746871294909586, 0.2378339597580316, 0.23754972937218932, 0.23808549934050524, 0.23657913858391091, 0.23592890335497746, 0.23621276424066254, 0.23590546871442186, 0.2362753333030346, 0.23573230272933593, 0.23475190022107176, 0.23544057695626594, 0.23577945399177339, 0.2339361989803971, 0.2348381645704916, 0.2341180992509018, 0.23376054870994947, 0.2344823406512449, 0.23406978034339906, 0.23306260591940667, 0.233138805362012], [0.2615256911042773, 0.25970378767946856, 0.2638939103788129, 0.2628293073881699, 0.2640206642711692, 0.2658244977192492, 0.26749719482699547, 0.26588298540593724, 0.2652078772261847, 0.2682477005012499, 0.26811526068130426, 0.2684982181091645, 0.2692600084080123, 0.27130413665101316, 0.2722996109548626, 0.2727344618403402, 0.27082199617999864, 0.2724875770713028, 0.27441859744445707, 0.2733091784238038, 0.27562907259409974, 0.27545886586185053, 0.2765647643109541, 0.27599231882516473, 0.27634675537476755, 0.27662356267657573, 0.2766963743107796, 0.2778054034391016, 0.27925632265607936, 0.279540095569638, 0.2795284294821897, 0.2793293829098663, 0.28026465326028843, 0.2800875729290285, 0.281465243970104, 0.28110494252016716, 0.2796359390384382, 0.2812942522667529, 0.28199084186841805, 0.28140464113781843, 0.2817966954636027, 0.28232522647357844, 0.2829112430522464, 0.2829514070906049, 0.2829088872733593, 0.28415423488955294, 0.28478194893717507, 0.2840768080020372, 0.28432587142689886, 0.2855391509759513, 0.28378380091253863, 0.2859326025844782, 0.2849673753445407, 0.2852055448377514, 0.2858091639012202, 0.28673938135013793, 0.28641229431107607, 0.2866014299850179, 0.28827494937123793, 0.2873649488784059, 0.28668693277811796, 0.2869992147998536, 0.2875318089201634, 0.2882691469754124, 0.28627641637099965, 0.28783561944515207, 0.2877877322422168, 0.2877851441822679, 0.28820398814623477, 0.28808013174609975, 0.2884112280801026, 0.2882108785534973, 0.29009558359456294, 0.28906261424210256, 0.2894054005449944, 0.2888113808162387, 0.289482530361777, 0.29054060191679115, 0.29002779589079414, 0.29038412874385405, 0.2900822997776846, 0.289764235682229, 0.28958828002792913, 0.2900979562136413, 0.2904856217655841, 0.2916388325536193, 0.2903048492571782, 0.29153620176646844, 0.29106525741925054, 0.29187143842623164, 0.2921081435332946, 0.2903413851188049, 0.2910655412124745, 0.29192575426527734, 0.2912988910229326, 0.29258031592436806, 0.29225851661968827, 0.29235746109464816, 0.29226472913433404, 0.29242617361949363, 0.2927067893402841], [0.23303453418532533, 0.2361993276895365, 0.2369691937632693, 0.23917775880626496, 0.2408976201617126, 0.24369824878444807, 0.24438724504550108, 0.24795829099511257, 0.25020529487618864, 0.2502338334646726, 0.25238699709957774, 0.25514025731401535, 0.2557862847009714, 0.2580517436996966, 0.26004964369073214, 0.2610356754155276, 0.2628743010163922, 0.26459880411366465, 0.264835738335019, 0.26628047186072445, 0.2679128213568385, 0.2689263039198355, 0.27052099190062856, 0.27119696344158395, 0.2719819450656745, 0.27534711341994733, 0.2756895677373978, 0.27699000234645416, 0.27814571327758025, 0.27946270235222626, 0.2799304390923664, 0.28313000814103717, 0.2834768253744233, 0.2839392243737761, 0.28605691498018665, 0.28561378914663693, 0.28714250051682727, 0.28752553143836407, 0.28979150124309944, 0.29037798361518985, 0.29182383329715034, 0.2924610508220286, 0.29345416328552054, 0.29454553815728735, 0.29384054583304975, 0.29491940863178046, 0.2959464385137486, 0.29782840067372096, 0.29852327041616994, 0.2975335291601082, 0.30099082505748936, 0.30047387639414375, 0.3017250848627415, 0.30234283482344526, 0.3046357004485705, 0.3043641110757008, 0.3048748101605178, 0.30459389304038115, 0.3049750358255873, 0.30635018287667976, 0.30745059839550837, 0.3073037110698983, 0.30922765887944526, 0.31014220493794875, 0.3121577685428174, 0.31168447574812175, 0.3116622841551366, 0.31208829079010264, 0.31267766517910367, 0.3134685852798606, 0.3145186978212469, 0.3143881787798582, 0.316149346743815, 0.31621425969164635, 0.31617910897220103, 0.3172601056231919, 0.31817373630272955, 0.3178050956744797, 0.3183059801399198, 0.32021043637075713, 0.3205140912904314, 0.32132499566818756, 0.3213698095525959, 0.32089889176735975, 0.32199591504096764, 0.32272423887196366, 0.32306429744350906, 0.323166332200461, 0.3244322018963627, 0.32304714155198605, 0.32508752830226023, 0.3261467950033003, 0.32561779573977134, 0.32624136588176045, 0.3262444425127462, 0.3268093525844139, 0.3274890355486309, 0.32801225944488427, 0.32770500939084013, 0.3288916943587617, 0.3289485096802114]]
#STD_total = [[0.0231, 0.0266, 0.0228, 0.0245, 0.0228, 0.0241, 0.0211, 0.0237, 0.0201, 0.0222, 0.0217, 0.0225, 0.0223, 0.0225, 0.0195, 0.0203, 0.02, 0.022, 0.022, 0.0187, 0.0182, 0.0195, 0.0217, 0.0207, 0.0184, 0.0176, 0.0192, 0.0179, 0.0187, 0.0175, 0.0168, 0.0183, 0.0171, 0.0176, 0.0169, 0.0161, 0.016, 0.019, 0.0164, 0.016, 0.0177, 0.0163, 0.0185, 0.0157, 0.0174, 0.018, 0.016, 0.0162, 0.0159, 0.0147, 0.0166, 0.0149, 0.0153, 0.0157, 0.0146, 0.014, 0.0152, 0.0148, 0.0135, 0.0152, 0.0151, 0.0151, 0.0149, 0.0145, 0.015, 0.0139, 0.0149, 0.0151, 0.0165, 0.0133, 0.0142, 0.0131, 0.0139, 0.0154, 0.0162, 0.0134, 0.0152, 0.0123, 0.0148, 0.013, 0.0146, 0.0131, 0.0152, 0.0149, 0.0151, 0.0138, 0.0158, 0.0149, 0.014, 0.0129, 0.0139, 0.0133, 0.0137, 0.013, 0.0125, 0.0137, 0.0108, 0.0131, 0.0146, 0.0136, 0.0158], [0.1517, 0.1505, 0.1447, 0.1482, 0.1457, 0.1401, 0.1484, 0.1431, 0.1424, 0.135, 0.1381, 0.1399, 0.1296, 0.1369, 0.1334, 0.1361, 0.1352, 0.1383, 0.1281, 0.1333, 0.1415, 0.1375, 0.1347, 0.1327, 0.1306, 0.1312, 0.1301, 0.1272, 0.128, 0.1251, 0.1309, 0.1254, 0.1258, 0.1277, 0.1223, 0.1284, 0.1222, 0.1258, 0.1246, 0.1286, 0.1214, 0.1224, 0.1244, 0.1174, 0.1148, 0.1226, 0.1212, 0.1172, 0.1174, 0.1171, 0.1197, 0.1188, 0.1249, 0.1143, 0.1201, 0.1117, 0.1158, 0.1206, 0.115, 0.1096, 0.1158, 0.1157, 0.1175, 0.1154, 0.117, 0.1242, 0.1128, 0.1143, 0.1149, 0.1162, 0.1111, 0.1169, 0.115, 0.1124, 0.1158, 0.1104, 0.1185, 0.1133, 0.1101, 0.1141, 0.1075, 0.1117, 0.1106, 0.1121, 0.1143, 0.1133, 0.1145, 0.1138, 0.1125, 0.1117, 0.1145, 0.1123, 0.1115, 0.1143, 0.1103, 0.108, 0.1125, 0.1091, 0.1093, 0.107, 0.1129], [0.2428, 0.2408, 0.2499, 0.2429, 0.2416, 0.2365, 0.2454, 0.2375, 0.2385, 0.2413, 0.2312, 0.2393, 0.2364, 0.2297, 0.2346, 0.2311, 0.2395, 0.2351, 0.2403, 0.2375, 0.2342, 0.2243, 0.2358, 0.2337, 0.2388, 0.2374, 0.2341, 0.2319, 0.2334, 0.2254, 0.2377, 0.2373, 0.2231, 0.2375, 0.2344, 0.2323, 0.2298, 0.2262, 0.2323, 0.2283, 0.231, 0.223, 0.2239, 0.2278, 0.2286, 0.2225, 0.2315, 0.2255, 0.2345, 0.2275, 0.2353, 0.2281, 0.2228, 0.2281, 0.2278, 0.223, 0.2253, 0.228, 0.2309, 0.2298, 0.22, 0.2227, 0.2205, 0.2211, 0.223, 0.2242, 0.225, 0.2279, 0.22, 0.2216, 0.2284, 0.2249, 0.223, 0.2235, 0.223, 0.2256, 0.2162, 0.2229, 0.2169, 0.2251, 0.2183, 0.2175, 0.2218, 0.2174, 0.2127, 0.2186, 0.2215, 0.2199, 0.2284, 0.2171, 0.2205, 0.2099, 0.2179, 0.2209, 0.2163, 0.2216, 0.2225, 0.2182, 0.2202, 0.2116, 0.2161], [0.2807, 0.277, 0.2797, 0.2792, 0.2834, 0.2918, 0.2849, 0.2862, 0.2814, 0.2879, 0.2887, 0.283, 0.2838, 0.2836, 0.2913, 0.2863, 0.2886, 0.2856, 0.2913, 0.2845, 0.2877, 0.29, 0.2765, 0.2899, 0.2905, 0.2838, 0.2888, 0.2948, 0.288, 0.2935, 0.291, 0.2832, 0.2838, 0.2863, 0.294, 0.2905, 0.2953, 0.2963, 0.2993, 0.2919, 0.2875, 0.2924, 0.2891, 0.2909, 0.2959, 0.2938, 0.2939, 0.3007, 0.2885, 0.2982, 0.2846, 0.296, 0.2882, 0.2934, 0.2927, 0.3007, 0.2955, 0.2926, 0.2959, 0.2929, 0.2897, 0.2976, 0.2965, 0.3015, 0.2926, 0.2836, 0.2952, 0.2945, 0.3009, 0.2916, 0.293, 0.2916, 0.2927, 0.2941, 0.2908, 0.2905, 0.2877, 0.2944, 0.2981, 0.2964, 0.299, 0.2968, 0.2898, 0.2923, 0.3029, 0.2885, 0.2967, 0.2972, 0.2929, 0.2972, 0.2958, 0.3008, 0.2887, 0.2912, 0.296, 0.291, 0.293, 0.3018, 0.2983, 0.2992, 0.2941], [0.3017, 0.3051, 0.3029, 0.3052, 0.3065, 0.3075, 0.3002, 0.3095, 0.3176, 0.3136, 0.3203, 0.3153, 0.3279, 0.3273, 0.3212, 0.3262, 0.3167, 0.319, 0.3183, 0.326, 0.3184, 0.3287, 0.3313, 0.323, 0.3217, 0.33, 0.3278, 0.3282, 0.3319, 0.3385, 0.3236, 0.3358, 0.3502, 0.3309, 0.3324, 0.3327, 0.3367, 0.3327, 0.3274, 0.3352, 0.3424, 0.3459, 0.3441, 0.3482, 0.3433, 0.3431, 0.3374, 0.3404, 0.3437, 0.3425, 0.3438, 0.3422, 0.3488, 0.3485, 0.3448, 0.3506, 0.3482, 0.344, 0.3447, 0.3525, 0.3594, 0.3489, 0.3506, 0.3475, 0.3524, 0.3541, 0.3521, 0.3482, 0.3477, 0.3573, 0.3533, 0.3535, 0.3554, 0.3546, 0.3542, 0.3601, 0.3624, 0.3571, 0.3601, 0.3514, 0.3606, 0.3609, 0.3626, 0.3633, 0.355, 0.3658, 0.3515, 0.3542, 0.3522, 0.3611, 0.3553, 0.3637, 0.3682, 0.3606, 0.3649, 0.3657, 0.3612, 0.3578, 0.3576, 0.3686, 0.3611]]
#ATD_total = [[0.0385, 0.0378, 0.0348, 0.0382, 0.0333, 0.0362, 0.0352, 0.0354, 0.0344, 0.0337, 0.0339, 0.0296, 0.0285, 0.0316, 0.0316, 0.0311, 0.0338, 0.0318, 0.0293, 0.0302, 0.0267, 0.0267, 0.0289, 0.0273, 0.0282, 0.0272, 0.0263, 0.0262, 0.0278, 0.0289, 0.0262, 0.0281, 0.0276, 0.0245, 0.0268, 0.0277, 0.024, 0.0281, 0.0226, 0.0262, 0.0225, 0.0228, 0.0221, 0.022, 0.0269, 0.0222, 0.0242, 0.0215, 0.0216, 0.0213, 0.0206, 0.0254, 0.0244, 0.0217, 0.021, 0.0214, 0.0228, 0.0209, 0.0217, 0.0228, 0.0203, 0.022, 0.0198, 0.0216, 0.0208, 0.0216, 0.0204, 0.0213, 0.0215, 0.0212, 0.0186, 0.0183, 0.0194, 0.0177, 0.0191, 0.0201, 0.0203, 0.0193, 0.0206, 0.0193, 0.0158, 0.0185, 0.0179, 0.0188, 0.0188, 0.0191, 0.0185, 0.0194, 0.019, 0.0202, 0.021, 0.0171, 0.0156, 0.0187, 0.0211, 0.0191, 0.0172, 0.0166, 0.0172, 0.0177, 0.0191], [0.2046, 0.2025, 0.1971, 0.1909, 0.1878, 0.1909, 0.1868, 0.1831, 0.1787, 0.1862, 0.1829, 0.1876, 0.1867, 0.1844, 0.1758, 0.1734, 0.1751, 0.173, 0.1711, 0.1701, 0.172, 0.1701, 0.1694, 0.1627, 0.1584, 0.1618, 0.1633, 0.1638, 0.1593, 0.1574, 0.1566, 0.1609, 0.1578, 0.1538, 0.1614, 0.1549, 0.1572, 0.1555, 0.1664, 0.1492, 0.1498, 0.1548, 0.1451, 0.1553, 0.1447, 0.1502, 0.1526, 0.1456, 0.14, 0.1447, 0.149, 0.1441, 0.1433, 0.1441, 0.1445, 0.147, 0.1435, 0.1435, 0.1361, 0.1477, 0.138, 0.1366, 0.1367, 0.1425, 0.1361, 0.1408, 0.1403, 0.1321, 0.1398, 0.1372, 0.1389, 0.1398, 0.1296, 0.1384, 0.1363, 0.1363, 0.1326, 0.1367, 0.1384, 0.1274, 0.1306, 0.1366, 0.1354, 0.1374, 0.1293, 0.1335, 0.13, 0.1363, 0.1298, 0.1329, 0.1305, 0.1264, 0.1334, 0.1362, 0.131, 0.1272, 0.1288, 0.1282, 0.1284, 0.1305, 0.13], [0.2751, 0.2708, 0.2684, 0.2733, 0.2641, 0.2673, 0.2608, 0.2739, 0.2612, 0.265, 0.2666, 0.2677, 0.2617, 0.261, 0.2558, 0.2585, 0.2678, 0.2594, 0.2566, 0.2636, 0.2606, 0.2516, 0.257, 0.2514, 0.2579, 0.2539, 0.2536, 0.2612, 0.2517, 0.256, 0.2558, 0.2507, 0.2527, 0.2545, 0.2479, 0.2542, 0.2548, 0.2516, 0.2408, 0.2568, 0.2469, 0.2423, 0.2464, 0.2537, 0.2389, 0.2445, 0.2484, 0.2464, 0.2519, 0.2487, 0.2504, 0.2381, 0.2463, 0.2387, 0.2503, 0.2432, 0.2397, 0.2452, 0.2474, 0.2421, 0.2512, 0.2468, 0.244, 0.2434, 0.2456, 0.2398, 0.2432, 0.2462, 0.244, 0.2423, 0.2416, 0.238, 0.242, 0.2332, 0.2427, 0.2336, 0.242, 0.2355, 0.2322, 0.2419, 0.2415, 0.2361, 0.2372, 0.2344, 0.2369, 0.2358, 0.2349, 0.2249, 0.2316, 0.231, 0.2333, 0.2317, 0.2293, 0.2296, 0.2343, 0.2364, 0.232, 0.2303, 0.2386, 0.2328, 0.2349], [0.2495, 0.2568, 0.2619, 0.2644, 0.2693, 0.2645, 0.2673, 0.2656, 0.2721, 0.2605, 0.2637, 0.2634, 0.2729, 0.267, 0.2735, 0.2745, 0.2649, 0.2701, 0.2795, 0.2725, 0.273, 0.2756, 0.2768, 0.2835, 0.2843, 0.279, 0.2737, 0.2746, 0.2815, 0.2793, 0.2853, 0.2823, 0.2776, 0.2769, 0.2792, 0.2796, 0.2791, 0.2801, 0.2751, 0.2792, 0.2923, 0.2829, 0.2865, 0.2875, 0.293, 0.2866, 0.2808, 0.2866, 0.2836, 0.2774, 0.2859, 0.2873, 0.2928, 0.2862, 0.2791, 0.2808, 0.2875, 0.2871, 0.2888, 0.2855, 0.284, 0.2886, 0.2896, 0.2772, 0.2825, 0.2892, 0.2832, 0.2849, 0.2866, 0.2983, 0.2909, 0.2846, 0.2901, 0.2996, 0.2882, 0.2882, 0.2871, 0.2928, 0.2918, 0.2914, 0.2883, 0.2873, 0.2838, 0.2887, 0.2938, 0.2877, 0.2901, 0.2917, 0.2966, 0.2941, 0.2892, 0.2965, 0.2936, 0.2948, 0.2881, 0.2862, 0.2997, 0.2927, 0.2895, 0.2895, 0.2937], [0.2323, 0.2321, 0.2378, 0.2332, 0.2455, 0.2411, 0.2499, 0.242, 0.2536, 0.2546, 0.2529, 0.2517, 0.2502, 0.256, 0.2633, 0.2625, 0.2584, 0.2657, 0.2635, 0.2636, 0.2677, 0.276, 0.2679, 0.2751, 0.2712, 0.2781, 0.2831, 0.2742, 0.2797, 0.2784, 0.2761, 0.278, 0.2843, 0.2903, 0.2847, 0.2836, 0.2849, 0.2847, 0.2951, 0.2886, 0.2885, 0.2972, 0.2999, 0.2815, 0.2965, 0.2965, 0.294, 0.2999, 0.3029, 0.3079, 0.2941, 0.3051, 0.2932, 0.3093, 0.3051, 0.3076, 0.3065, 0.3033, 0.306, 0.3019, 0.3065, 0.306, 0.3099, 0.3153, 0.315, 0.3086, 0.3129, 0.3155, 0.3081, 0.301, 0.31, 0.3193, 0.3189, 0.3111, 0.3137, 0.3218, 0.318, 0.3157, 0.317, 0.32, 0.3238, 0.3215, 0.3257, 0.3207, 0.3212, 0.3239, 0.3265, 0.3277, 0.323, 0.3218, 0.326, 0.3283, 0.3281, 0.3207, 0.3255, 0.3311, 0.3223, 0.3322, 0.3263, 0.3295, 0.3223]]
'''


#Block for graph K=5, sigma_0 high, all others very low.
'''
thetas = [x/10.0 for x in range(50, 151, 1)]

sigmas = [5, 0.5, 0.3, 0.1, 0]
nus = [0.01, 0.09, 0.2, 0.3, 0.4]
graph_dists = [[],[],[],[],[]] # first index is type, second index is theta.
AL_dists = [[],[],[],[],[]]
STD_total = [[],[],[],[],[]]
ATD_total = [[],[],[],[],[]]
dark_red = (0.4, 0, 0)
bright_red = (0.9, 0.1, 0.1)

dark_green = (0, 0.4, 0)
bright_green = (0.1, 0.9, 0.1)

dark_blue = (0, 0, 0.4)
bright_blue = (0.2, 0.2, 1)

dark_yellow = (0.2, 0.2, 0)
bright_yellow = (0.8, 0.8, 0)

dark_purple = (0.2, 0, 0.4)
bright_purple = (0.7, 0.2, 1)

for theta in thetas:
    graph_dist, AL_dist, ATD, STD = main(sigmas, theta, 10, nus, 10000, False)[:4]
    for i in range(len(graph_dist)):
        graph_dists[i].append(graph_dist[i]/sum(graph_dist))
        AL_dists[i].append(AL_dist[i]/sum(AL_dist))
        STD_total[i].append(STD[i]/sum(STD))
        ATD_total[i].append(ATD[i]/sum(ATD))



plt.xlabel("θ")
plt.ylabel("Type proportion in graph or AL")
parameters = [(dark_red, bright_red), (dark_green, bright_green),(dark_blue, bright_blue),(dark_yellow, bright_yellow),(dark_purple, bright_purple)] #(colour AL, colour graph)
for i in range(len(parameters)):
    graph_color, AL_color = parameters[i]
    plt.plot(thetas, graph_dists[i], color = graph_color)
    for x in [6, 7, 8, 9, 10, 11, 12, 13, 14]:
        plt.plot(x, STD_total[i][(x-5)*10], "x", color = graph_color)
    if i == 0 or i == 2:
        plt.annotate("Type "+str(i)+" G", xy=(15, graph_dists[i][-1]), xytext=(15.15, graph_dists[i][-1]-0.01), size=7, va="center", annotation_clip=False)
    elif i == 1:
        plt.annotate("Type "+str(i)+" G", xy=(15, graph_dists[i][-1]), xytext=(15.15, graph_dists[i][-1]-0.005), size=7, va="center", annotation_clip=False)
    elif i == 3:
        plt.annotate("Type "+str(i)+" G", xy=(15, graph_dists[i][-1]), xytext=(15.15, graph_dists[i][-1]+0.0085), size=7, va="center", annotation_clip=False)
        plt.annotate("Type "+str(i)+" AL", xy=(15, AL_dists[i][-1]), xytext=(15.15, AL_dists[i][-1]-0.0075), size=7, va="center", annotation_clip=False)
    elif i == 4:
        plt.annotate("Type "+str(i)+" G", xy=(15, graph_dists[i][-1]), xytext=(15.15, graph_dists[i][-1]+0.005), size=7, va="center", annotation_clip=False)
        plt.annotate("Type "+str(i)+" AL", xy=(15, AL_dists[i][-1]), xytext=(15.15, AL_dists[i][-1]-0.005), size=7, va="center", annotation_clip=False)

    plt.plot(thetas, AL_dists[i], color = AL_color)
    for x in [6, 7, 8, 9, 10, 11, 12, 13, 14]:
        plt.plot(x, ATD_total[i][(x-5)*10], "x", color = AL_color)
    if i == 0:
        plt.annotate("Type "+str(i)+" AL", xy=(15, AL_dists[i][-1]), xytext=(15.15, AL_dists[i][-1]), size=7, va="center", annotation_clip=False)
    elif i == 1 or i == 2:
        plt.annotate("Type "+str(i)+" AL", xy=(15, AL_dists[i][-1]), xytext=(15.15, AL_dists[i][-1]+0.008), size=7, va="center", annotation_clip=False)


plt.xlim(5, 15)
plt.show()

print(graph_dists)
print(AL_dists)
print(STD_total)
print(ATD_total)
#graph_dists = [[0.02962931389168789, 0.02832054140407585, 0.02826030027476105, 0.02771305744431041, 0.027307720462217102, 0.026718092792693958, 0.026018008064124357, 0.025442540792737663, 0.0254900388420476, 0.02470815764989268, 0.02442002079614773, 0.024188390019764354, 0.023493687955479146, 0.023686575827547345, 0.023115306771141337, 0.022815811386516463, 0.022160718257412344, 0.02243073898100004, 0.0220056762801067, 0.022244152985777525, 0.02113921232439688, 0.021292740039333208, 0.020741364410010496, 0.020806491228604243, 0.02076991439420187, 0.020434084507892584, 0.02024048348825388, 0.020217380561120595, 0.0198219816114378, 0.019850871878721164, 0.019351443555868417, 0.01932364271346438, 0.01919435789851894, 0.01882366742137345, 0.019063696793260976, 0.01861268918265638, 0.0186589803369599, 0.018656109252802033, 0.018545911840107898, 0.018140870433186556, 0.018068610704247215, 0.017941742145828863, 0.01786526222031845, 0.017717497276158154, 0.017778651199258408, 0.017490467909712315, 0.017383956251575565, 0.017441050677608406, 0.017322930151394623, 0.01689735305919483, 0.016948702953264574, 0.016807046636241017, 0.016807600353656096, 0.016545503484671726, 0.016752427409556948, 0.016740697639749537, 0.01646863894280187, 0.016421367263893177, 0.01610409402895659, 0.016288085222732368, 0.01612247333049754, 0.015881115959998107, 0.016009582084809435, 0.015806135856042493, 0.016145648850974446, 0.015824626914520416, 0.015480293120944759, 0.015684527043119182, 0.015602631943730088, 0.01558739756975905, 0.015332702989326194, 0.015330542820589746, 0.015116676569996835, 0.015247790750459811, 0.015366252576399156, 0.015057428607958024, 0.015241670690531435, 0.015066074256384414, 0.014915213527316278, 0.014990636152933287, 0.015013554023530967, 0.01490566874253449, 0.014915074359835932, 0.014768246602318237, 0.014655802492797493, 0.01480839076731638, 0.014583756430317271, 0.014495710347641067, 0.014646491388689627, 0.014665572182460812, 0.014290192764296467, 0.014359140054113394, 0.014346261490225398, 0.014390920419163874, 0.01439600355494754, 0.014203964050984539, 0.014420176768110988, 0.014092824963710256, 0.01409197228381101, 0.013978478812759989, 0.014154872983926637], [0.09378696722829769, 0.09376070283024357, 0.09344945141450405, 0.09356528637590343, 0.09376719946410322, 0.09375996570400018, 0.09412702809861105, 0.09341878690054782, 0.093332107015797, 0.09400821483863228, 0.09291585586934861, 0.09353361235080579, 0.09260711056186202, 0.0931424797547318, 0.09344405154317162, 0.09303054712861591, 0.09344488672607938, 0.09292449030069576, 0.09354482479926478, 0.09319307318545475, 0.09330733012340124, 0.09303292644228467, 0.0929060217473721, 0.09311546540213606, 0.0930421519708422, 0.09227539496808793, 0.09285134970167071, 0.09251697106885294, 0.09270347935196009, 0.09314975078428236, 0.09284888664926441, 0.0931240340019439, 0.09270020361769435, 0.09233629003980183, 0.0928373924567724, 0.09252875391363924, 0.09243297169006415, 0.092448660021773, 0.09300057568044771, 0.09234137223788935, 0.09216979616512812, 0.09280696003607422, 0.09235478335024207, 0.09236242868929666, 0.09250295176636382, 0.09274171874488817, 0.09226245834165116, 0.09285349385843007, 0.09310040493043072, 0.09232922627766128, 0.09223299623428999, 0.09285432736115158, 0.09216180369582866, 0.09171588473653376, 0.09224128444573802, 0.09236104115961999, 0.09212272235587012, 0.09223423762224046, 0.09226751947776542, 0.09235127269504835, 0.09218937366037128, 0.09219069093207184, 0.09237456122846419, 0.09198521359290109, 0.09208692100897316, 0.09160493258175023, 0.09190081051022521, 0.09232595797225411, 0.09212918901699904, 0.09196178804239194, 0.09215692365988994, 0.09152317443474989, 0.09194372779030682, 0.09189203409768068, 0.09168256765643966, 0.09230065377818342, 0.0920159893763293, 0.0919121053501489, 0.09197941263778901, 0.09164233461675052, 0.0917778015511042, 0.09190250612380031, 0.09196943215353084, 0.09180790848395252, 0.0917915525912048, 0.09155292241718688, 0.09191677816858468, 0.09184258769355348, 0.09145789783591879, 0.0920618460614112, 0.09173873825593964, 0.09176858656631359, 0.09184366498859502, 0.09191399298136715, 0.09153410563242625, 0.09184997235944971, 0.09214315325322812, 0.09184383755703573, 0.09171348955213926, 0.0916984443938388, 0.09166721506715705], [0.2019617923877794, 0.20054414933184747, 0.20162236428769173, 0.20093566058515833, 0.20055924939554898, 0.20195634788509473, 0.20181904965078223, 0.20117364394601472, 0.2007822829457208, 0.20104057883896997, 0.20102144765783042, 0.20182163852862353, 0.20196196310338893, 0.20169509978248276, 0.20116510078539848, 0.2014647715465628, 0.20198834197500018, 0.20182290372962952, 0.20169752064606306, 0.20144344175642748, 0.20206143409964622, 0.20177570393000838, 0.20181944236363422, 0.2012328475335639, 0.2022515350770311, 0.20213394339736113, 0.20066911528552153, 0.20178153168581198, 0.20276027950573755, 0.20161633413259802, 0.20165178762063987, 0.2015011516578786, 0.20184750585487585, 0.2023899115845941, 0.2011383949936984, 0.2017570581232655, 0.20230316415246027, 0.2015947872659575, 0.20165475594207286, 0.20150099966984006, 0.2017454368880438, 0.2016362504926359, 0.20188995963976006, 0.2014263576396781, 0.2013083248908385, 0.20143582031348092, 0.20205772169456795, 0.20125203028636268, 0.20125901759536569, 0.20139246305247868, 0.20163446501406157, 0.20136144187855592, 0.20112609638408796, 0.20194936884244682, 0.20156498992175378, 0.2011471877454295, 0.20125388608777314, 0.20127449378006895, 0.2017385190322494, 0.20175980996975737, 0.20133911854278558, 0.20100688016128077, 0.20137440872137694, 0.20170380165984508, 0.20124906140266724, 0.20176412553581008, 0.20179527532163008, 0.2008934679407706, 0.2014641555328906, 0.20099467846002897, 0.20118563308709023, 0.2013526995882123, 0.2013002672852189, 0.2014820187601048, 0.2014196687925039, 0.20089982986098295, 0.20124370872149716, 0.20131693153787444, 0.20165490102648828, 0.20132701784102414, 0.201426131069182, 0.20141397849056442, 0.20125992830636646, 0.20157883793051665, 0.20170074199522253, 0.2011853001707324, 0.20122923215905064, 0.20137984749973326, 0.20163318486678905, 0.20076400845772086, 0.20139701514144948, 0.20126546517212526, 0.20138616544423865, 0.20109893831020528, 0.20136461355549917, 0.20122871852213042, 0.20094820346464348, 0.20109468012283913, 0.20152445282815637, 0.20146767070024055, 0.2012416538509706], [0.29228144120035154, 0.2923831402600218, 0.29296803954223655, 0.29319908794958327, 0.29404411700123656, 0.2922977379951837, 0.29353203184747656, 0.2945487600415428, 0.2941607484934495, 0.29395372879883874, 0.2944837368383834, 0.293708351513565, 0.29455809822152784, 0.2939366967853378, 0.29481458868211247, 0.2949629238675493, 0.293833931255053, 0.29531574349230677, 0.2951286595318012, 0.29459008529782704, 0.2955521952660645, 0.2949936452999483, 0.29567625377388695, 0.29552006592132946, 0.2946638321320005, 0.29550203330740504, 0.2961152504491348, 0.2952426483528864, 0.2959086427754787, 0.2954874346475391, 0.2956689373781751, 0.29611061296581287, 0.29574750026390934, 0.2954456318029549, 0.296431297139431, 0.29642065396127076, 0.29599586396775307, 0.2963181587481816, 0.2956188204506743, 0.2959544472127675, 0.2964381882754826, 0.29604215293416464, 0.2962699793315227, 0.29656472604704387, 0.2962782455793722, 0.2964557291080655, 0.2966193900340544, 0.2961242279772166, 0.29604748446430856, 0.2965248972655686, 0.2959311418456574, 0.2971000603501937, 0.2974362423808048, 0.2964189030925785, 0.29697528457358696, 0.29692892745479726, 0.2975052566069588, 0.2971428900118229, 0.2972883719832956, 0.29671761902597843, 0.2970586183666139, 0.2973698259222512, 0.2970421230728215, 0.2968651405065977, 0.29707518671112737, 0.2972298761253579, 0.2967541230472358, 0.2969484812963913, 0.2980354213539954, 0.2971455042567215, 0.2978432689263412, 0.29774437881896587, 0.29777158813331905, 0.29745675349146605, 0.2974422829243687, 0.29741935293647564, 0.2973644403234845, 0.29765267744316243, 0.29770012327722223, 0.29736510765352936, 0.2974438510674417, 0.29747787666695136, 0.2976769521145576, 0.298135161770555, 0.29801069769373295, 0.29792875105455086, 0.2976301042283703, 0.2978442751472225, 0.2977609043970159, 0.29776611746621534, 0.2978584210413237, 0.2977760186946091, 0.2980396099878862, 0.2975556558839443, 0.29814304297450456, 0.298234032009809, 0.2980571714301208, 0.29805620313720954, 0.2975441172316671, 0.29758732730021115, 0.2982958342109425], [0.3823404852918835, 0.38499146617381136, 0.3836998444808066, 0.38458690764504455, 0.3843217136768941, 0.3852678556230274, 0.38450388233900584, 0.38541626831915693, 0.38623482270298504, 0.38628931987366644, 0.3871589388382897, 0.3867480075872413, 0.38737914015774205, 0.3875391478499004, 0.38746095221817606, 0.38772594607075556, 0.388572121786455, 0.3875061234963679, 0.3876233187427643, 0.3885292467745132, 0.3879398281864911, 0.38890498428842546, 0.3888569177050963, 0.3893251299143663, 0.3892725664259243, 0.38965454381925324, 0.390123801075419, 0.39024146833132806, 0.38880561675538583, 0.38989560855685934, 0.3904789447960522, 0.38994055866090016, 0.39051043236500144, 0.3910044991512758, 0.39052921861683715, 0.3906808448191682, 0.3906090198527626, 0.3909822847112858, 0.3911799360866973, 0.3920623104463165, 0.3915779679670983, 0.39157289439129633, 0.3916200154581568, 0.39192899034782325, 0.39213182656416706, 0.39187626392385305, 0.391676473678151, 0.3923291972003823, 0.3922701628585004, 0.3928560603450967, 0.3932526939527265, 0.3918771237738578, 0.3924682571856225, 0.39337033984376923, 0.39246601364936434, 0.39282214600040377, 0.3926494960065961, 0.3929270113219745, 0.392601495477733, 0.39288321308648355, 0.39329041609973164, 0.393551487024398, 0.3931993248925279, 0.3936397083846136, 0.39344318202625783, 0.39357643884256144, 0.39406949799996416, 0.3941475657474649, 0.39276860215238485, 0.3943106316710985, 0.3934814713373524, 0.39404920433748225, 0.3938677402211584, 0.3939214029002886, 0.39408922805028856, 0.39432273481640007, 0.39413419088815754, 0.3940522114124298, 0.3937503495311843, 0.3946749037357626, 0.3943386622887411, 0.39429996997614947, 0.39417861306570906, 0.39370984521265767, 0.3938412052270422, 0.39452463559021356, 0.3946401290136772, 0.39443757931184964, 0.3945015215115865, 0.39474245583219175, 0.3947156327969907, 0.3948307895128387, 0.3943842980890547, 0.39504049240531947, 0.39456223428262244, 0.39448331305762624, 0.39443129508389674, 0.39491245421920546, 0.39512596810422623, 0.39526807879294945, 0.3946404238870032]]
#AL_dists = [[0.049560996469727135, 0.047036753502307904, 0.04694880551092579, 0.04619594274488195, 0.04546334744409376, 0.04455285858399294, 0.04351036911233982, 0.041807208077656914, 0.04174445283962402, 0.04046502347326471, 0.0401187400876898, 0.03969691434954855, 0.03829684155142091, 0.0384769180224911, 0.03740607154068873, 0.036820843280082026, 0.035664516565876186, 0.035880874538545215, 0.03496143988310627, 0.03536444159273716, 0.03342219160323158, 0.033405218749228256, 0.03297843175055005, 0.032980883268457724, 0.03279853476262882, 0.03182184457559375, 0.031946780957030095, 0.031574612533318586, 0.03094790091271861, 0.03129365227543739, 0.029905376481620095, 0.030163252527324304, 0.029760126143493687, 0.028968181799777542, 0.029326667287194564, 0.028460062888388597, 0.028690345548775052, 0.028140118845059375, 0.028049704012228366, 0.027502156323266566, 0.02711874182503291, 0.026331271638929787, 0.02696373100156742, 0.026770178590055635, 0.026609341203488776, 0.025962554924977246, 0.02581334343704079, 0.025908959150373986, 0.025162815021679566, 0.02482371688325138, 0.024946964768974626, 0.024668342908302006, 0.02445651637066661, 0.024065789678050505, 0.024407541217317495, 0.024260373891159055, 0.023969298295410113, 0.02348654744010876, 0.023284399994490085, 0.023103351255224835, 0.023300673632700667, 0.022782718371231362, 0.022985417852375418, 0.022297218571804323, 0.023199858498858656, 0.02226765914611995, 0.022082110958793085, 0.022150900330796343, 0.021954696363567092, 0.022295008219292287, 0.02156234468491874, 0.021549107830825476, 0.021521587298271836, 0.02143919042906417, 0.021446936800651635, 0.02115143678860076, 0.021284684496245005, 0.020770082445236718, 0.0204512889083546, 0.02067258655674155, 0.0203626923559818, 0.02049264336846929, 0.020451710840982483, 0.020099272992499265, 0.020191421033923376, 0.020056113586097893, 0.02000404405416862, 0.01970044332206531, 0.019763808354039947, 0.019857412276775618, 0.019338923692779193, 0.019284119187253392, 0.019392359721020415, 0.01931005462315507, 0.019563870510160116, 0.019144130589464375, 0.019174613887677997, 0.01887128304785059, 0.018513918857755815, 0.018637764677536958, 0.018975260045269175], [0.09653342529702572, 0.09661401858320859, 0.09541804641124463, 0.09569883897782018, 0.09655285428799405, 0.09592339977040631, 0.09612062951827773, 0.09555115607535411, 0.09534016000993359, 0.09644166813746635, 0.09467223285831403, 0.09584618547877588, 0.09446593390611013, 0.09509140079633051, 0.09609629580060632, 0.09519209577766043, 0.09522739431233693, 0.09503992934634871, 0.0955770702302421, 0.09594065797488285, 0.09575947699141292, 0.09542858201505042, 0.09463910512116777, 0.09509555202987564, 0.09474053710116094, 0.09429478995229205, 0.09428654356630631, 0.09438393058120662, 0.09488075540160328, 0.09526460984348871, 0.09493740812870233, 0.09500140054307936, 0.0942674881990359, 0.09412511358436816, 0.09493714459524943, 0.09449406356794077, 0.09403436644652344, 0.0942942691816776, 0.09459795037671663, 0.0941819097141817, 0.09330898347022558, 0.09459589143401186, 0.09412151518441976, 0.09399248054254894, 0.09448435248628127, 0.09447345925138043, 0.09354743854759476, 0.09397879782949775, 0.0944740924214701, 0.09423686448719645, 0.0936572717473661, 0.09424629516270884, 0.09401135932178976, 0.09337476363187647, 0.09399123726562612, 0.09462413683357825, 0.09385324526578427, 0.09432761388134617, 0.09337652259701135, 0.0943470631103069, 0.0938932835794715, 0.09398280506656165, 0.09426763991886258, 0.0938690675631274, 0.09372893808628943, 0.09325078636878036, 0.0931890615971004, 0.09395356475072943, 0.09388314755375511, 0.09387551052723268, 0.09364912008862922, 0.0928844635311029, 0.09391888944948289, 0.09366217984393532, 0.09295203466765134, 0.0936519154560962, 0.0938217678543873, 0.0931480668362921, 0.09310913146721102, 0.09292795747704068, 0.09386420367429701, 0.09364288999906636, 0.09369178573430884, 0.09355663111555163, 0.09349879401023385, 0.09297569580129426, 0.09336490848831022, 0.09349240838755436, 0.09343925594155902, 0.09323477345147911, 0.09323478461218694, 0.09311087653042553, 0.09380514874891033, 0.09339536849478185, 0.09233067091274158, 0.09316407373948708, 0.0934908700606598, 0.0931239294836721, 0.09349313281587232, 0.09391080029161643, 0.09307756627731778], [0.20210297807302324, 0.2001055708277015, 0.20185797766526514, 0.20017368098741448, 0.20004478157526973, 0.20170048692371242, 0.20152259408154066, 0.20096284938946835, 0.2004987146388402, 0.20147663744418282, 0.20110438760439162, 0.20177305167306608, 0.20232735655610307, 0.2021317243547159, 0.20069097372421865, 0.2019884133501121, 0.20262569693508983, 0.20242389635676097, 0.20227997976040013, 0.20207156604859086, 0.2024040264596801, 0.20221802246586018, 0.20210774056757672, 0.20157254776467737, 0.2026315496411285, 0.20201692678899863, 0.2013193167523948, 0.2020999404425515, 0.2034491486405647, 0.20236202262876574, 0.20164171193289926, 0.20182730267908183, 0.20219737263041196, 0.2028761948719854, 0.20204444820544445, 0.20297788265928143, 0.2040427059438008, 0.20230127439636564, 0.2023482361609497, 0.20157445919573014, 0.2019750294028354, 0.20204529986630682, 0.2027241300375096, 0.20145653949263528, 0.2019135582520863, 0.20144617503893553, 0.2031291388797183, 0.20261685768535526, 0.20232206489255575, 0.20231340395954903, 0.20307100721673071, 0.2021842161629776, 0.20149993639380667, 0.20287287272893534, 0.2020216710297094, 0.20143247117212593, 0.2018177715512588, 0.20178853747588033, 0.20341649744023263, 0.20317211090455875, 0.201924166681844, 0.2020609595275186, 0.20294406459986658, 0.2027017792757509, 0.2016297360851612, 0.2020971928499537, 0.20283492046408466, 0.2017169052958966, 0.20252526148154826, 0.20157240812253616, 0.20138758725193814, 0.20246235352018446, 0.20192434461254138, 0.20259972336913334, 0.201865785470636, 0.2018724696555936, 0.20140432692910015, 0.20334381437455645, 0.20257040713232705, 0.20311951492779717, 0.201869481657121, 0.20218426817066715, 0.20220760123096945, 0.20251028929568804, 0.2030583488599636, 0.20283368351437267, 0.20212801949020476, 0.20294320432546034, 0.20184369145966152, 0.20048649475190006, 0.20213751931053384, 0.20244553260796347, 0.2021407844300245, 0.2011487902663561, 0.20237858460254418, 0.20198891812085412, 0.20211689676300518, 0.20151389752084387, 0.20208407360752442, 0.2021229415668775, 0.2024911511438954], [0.28435497108302954, 0.2849227096166998, 0.28649713606470395, 0.28559798489145666, 0.28729360612654076, 0.28563233974992047, 0.287362290975244, 0.2888604222510104, 0.2870296038788841, 0.28717355410080464, 0.2888250782201374, 0.2885000631834304, 0.28874819064731244, 0.28800627599149214, 0.2891407052725519, 0.2888304343121039, 0.2889475925976661, 0.2903858366229429, 0.2908583055368511, 0.2892095931088113, 0.29053643446850713, 0.28986407758388577, 0.29095810743375844, 0.2899941542819838, 0.289692536040376, 0.2913592774243833, 0.29151810648699744, 0.2908323410378266, 0.29162212771093216, 0.29071232851344325, 0.292131929618645, 0.29204775137666666, 0.292151718165259, 0.292195794237258, 0.29120551757615454, 0.29216480458034844, 0.2905090235021874, 0.29272782558631716, 0.29147521151529293, 0.29287582037835674, 0.2926027299410782, 0.2929151000205718, 0.2927286862604339, 0.2929994025451543, 0.2924419133848532, 0.29374772311719266, 0.2934150773762733, 0.29210989896126444, 0.2927537608862664, 0.29355706289533573, 0.29202427040448176, 0.2938174355890145, 0.2941043181677067, 0.29321970925318086, 0.29374468111215485, 0.29444527403480564, 0.29457477491148953, 0.29444082206410677, 0.2946955849980669, 0.29445204248741247, 0.2942572561559238, 0.2958004202402475, 0.2941366241536965, 0.2936506092720931, 0.2947337464998671, 0.2947943321977937, 0.2936925972838498, 0.29479994051254527, 0.2951803484917622, 0.2939700466244565, 0.2954888212118672, 0.29481651935276193, 0.2948864580035523, 0.2948209693433731, 0.2951622641199753, 0.2938614189368043, 0.2951729621017951, 0.2937843559893391, 0.29566686839779843, 0.29491813518298066, 0.29463071835881893, 0.29445088850673073, 0.29531864762883564, 0.29569823471658696, 0.29503011635040854, 0.2958723675217269, 0.2948213186734823, 0.2944574671813455, 0.2956389645429623, 0.29613240341626096, 0.2961865337914342, 0.2957494020877226, 0.29507208278597474, 0.2964635062740704, 0.2957685607627353, 0.29587661560595646, 0.2960041280215667, 0.2963656735484596, 0.2962101668250403, 0.29488750116906604, 0.2957645914490479], [0.3674476290771943, 0.3713209474700822, 0.3692780343478605, 0.37233355239842675, 0.37064541056610173, 0.3721909149719678, 0.3714841163125978, 0.3728183642065102, 0.37538706863271815, 0.37444311684428144, 0.37527956122946715, 0.37418378531517904, 0.3761616773390534, 0.3762936808349703, 0.3766659536619344, 0.3771682132800416, 0.37753479958903097, 0.37626946313540216, 0.3763232045894004, 0.3774137412749779, 0.37787787047716825, 0.3790840991859754, 0.37931661512694714, 0.38035686265500557, 0.38013684245470575, 0.38050716125873235, 0.38092925223727125, 0.3811091754050967, 0.3791000673341813, 0.3803673867388649, 0.3813835738381333, 0.38096029287384775, 0.3816232948617995, 0.38183471550661086, 0.3824862223359569, 0.38190318630404074, 0.38272355855871326, 0.38253651199058014, 0.3835288979348124, 0.3838656543884648, 0.38499451536082796, 0.3841124370401797, 0.3834619375160693, 0.3847813988296058, 0.3845508346732905, 0.3843700876675142, 0.3840950017593729, 0.3853854863735086, 0.38528726677802816, 0.38506895177466743, 0.3863004858624468, 0.38508371017699694, 0.38592786974603027, 0.3864668647079568, 0.38583486937519207, 0.3852377440683312, 0.38578490997605724, 0.385956479138558, 0.3852269949701991, 0.384925432242497, 0.3866246199500601, 0.3853730967944409, 0.385666253475199, 0.3874813253172243, 0.3867077208298237, 0.3875900294373524, 0.3882013096961721, 0.3873786891100323, 0.38645654610936736, 0.3882870265064823, 0.38791212676264664, 0.3882875557651252, 0.3877487206361516, 0.3874779370144941, 0.38857297894108567, 0.38946275916290507, 0.38831625861847247, 0.38895368035457556, 0.38820230409430895, 0.38836180585544, 0.3892729039537812, 0.3892293099550665, 0.38833025456490355, 0.38813557187967407, 0.38822131974547064, 0.38826213957650824, 0.38968170929383406, 0.3894064767835745, 0.3893142797017772, 0.39028891610358435, 0.38910223859306586, 0.389410069586635, 0.38958962431406996, 0.38968228034163654, 0.38995831321181884, 0.3898262619442379, 0.3892134912670903, 0.3901252163991739, 0.3896987078938071, 0.390440992294903, 0.38969143108446985]]
#STD_total = [[0.0328, 0.0304, 0.0317, 0.0265, 0.0294, 0.028, 0.0251, 0.0235, 0.0259, 0.0245, 0.0272, 0.027, 0.0245, 0.0235, 0.0229, 0.0239, 0.0233, 0.0216, 0.0203, 0.0208, 0.0209, 0.0216, 0.0198, 0.0224, 0.019, 0.0204, 0.0225, 0.0186, 0.0187, 0.0176, 0.0206, 0.0221, 0.0164, 0.0205, 0.0164, 0.019, 0.019, 0.0201, 0.0188, 0.0204, 0.0165, 0.0187, 0.0194, 0.0186, 0.0203, 0.0184, 0.0148, 0.0172, 0.0182, 0.0162, 0.0173, 0.0164, 0.0156, 0.0156, 0.0153, 0.0165, 0.0151, 0.0137, 0.0142, 0.0163, 0.015, 0.0169, 0.0184, 0.0185, 0.0171, 0.0164, 0.0139, 0.0149, 0.0162, 0.0145, 0.0168, 0.0164, 0.0179, 0.0164, 0.0152, 0.0167, 0.0154, 0.0128, 0.0156, 0.0143, 0.017, 0.0136, 0.0126, 0.0154, 0.0136, 0.0153, 0.0148, 0.014, 0.013, 0.0137, 0.0133, 0.0143, 0.0133, 0.0148, 0.0154, 0.0145, 0.0125, 0.0113, 0.0138, 0.0136, 0.013], [0.0894, 0.089, 0.0941, 0.0932, 0.0988, 0.0902, 0.0866, 0.0975, 0.0978, 0.0926, 0.0971, 0.0942, 0.0908, 0.0905, 0.0906, 0.0949, 0.0949, 0.0915, 0.0873, 0.0923, 0.0919, 0.0952, 0.0931, 0.09, 0.0908, 0.0942, 0.0938, 0.0963, 0.0911, 0.0922, 0.0949, 0.0919, 0.0916, 0.0943, 0.0926, 0.0899, 0.0912, 0.0853, 0.0919, 0.0932, 0.0968, 0.0949, 0.0974, 0.098, 0.0921, 0.0924, 0.0933, 0.0894, 0.0926, 0.0936, 0.0908, 0.0875, 0.0944, 0.094, 0.0942, 0.092, 0.0937, 0.0935, 0.0924, 0.0938, 0.0942, 0.0889, 0.0908, 0.0938, 0.0935, 0.0866, 0.0877, 0.091, 0.0903, 0.0921, 0.086, 0.0902, 0.0948, 0.0909, 0.0919, 0.0901, 0.0917, 0.0936, 0.0935, 0.0901, 0.0911, 0.092, 0.089, 0.0884, 0.0921, 0.0925, 0.0923, 0.0925, 0.0895, 0.0883, 0.0946, 0.0888, 0.0939, 0.0908, 0.0899, 0.0919, 0.0932, 0.0924, 0.0906, 0.0906, 0.0905], [0.2141, 0.2062, 0.2051, 0.1951, 0.2036, 0.2092, 0.2079, 0.1999, 0.2039, 0.2002, 0.1958, 0.1996, 0.2043, 0.2037, 0.2078, 0.2041, 0.2047, 0.2005, 0.2019, 0.201, 0.2069, 0.1974, 0.2022, 0.201, 0.2017, 0.2004, 0.202, 0.2002, 0.2018, 0.2124, 0.2011, 0.2012, 0.2041, 0.2022, 0.2032, 0.2097, 0.1986, 0.204, 0.2016, 0.1998, 0.1998, 0.2023, 0.2067, 0.2006, 0.2021, 0.2026, 0.1978, 0.1977, 0.2006, 0.2032, 0.2076, 0.2145, 0.1935, 0.1973, 0.2017, 0.2025, 0.2018, 0.2029, 0.205, 0.2027, 0.1999, 0.1974, 0.2016, 0.2026, 0.1988, 0.203, 0.2105, 0.1945, 0.1937, 0.1994, 0.2043, 0.2049, 0.199, 0.2073, 0.1998, 0.2091, 0.1984, 0.2012, 0.2029, 0.2019, 0.2061, 0.1997, 0.1994, 0.203, 0.2056, 0.2007, 0.2056, 0.2012, 0.2074, 0.1968, 0.2051, 0.1966, 0.2011, 0.2016, 0.1967, 0.1985, 0.2031, 0.2017, 0.1998, 0.1979, 0.2082], [0.2853, 0.2993, 0.2921, 0.2918, 0.292, 0.29, 0.2839, 0.3023, 0.2946, 0.2954, 0.2981, 0.2972, 0.2968, 0.2966, 0.2912, 0.2864, 0.2983, 0.2998, 0.2992, 0.3008, 0.2912, 0.2981, 0.2914, 0.2971, 0.3008, 0.2895, 0.2908, 0.2956, 0.2966, 0.29, 0.2954, 0.2902, 0.2885, 0.3, 0.2931, 0.2909, 0.2952, 0.2955, 0.2918, 0.2925, 0.2985, 0.2954, 0.2869, 0.2932, 0.3001, 0.3063, 0.3025, 0.3016, 0.2965, 0.2912, 0.2971, 0.2933, 0.3061, 0.3012, 0.2906, 0.2972, 0.2988, 0.3019, 0.2881, 0.3, 0.297, 0.303, 0.2987, 0.2849, 0.3024, 0.3031, 0.2966, 0.2977, 0.3039, 0.2947, 0.3072, 0.3016, 0.2934, 0.2945, 0.2912, 0.2991, 0.2944, 0.3021, 0.2938, 0.2972, 0.2974, 0.2951, 0.3011, 0.3021, 0.3034, 0.2962, 0.2981, 0.2979, 0.2921, 0.3044, 0.2999, 0.3032, 0.2978, 0.296, 0.2935, 0.3019, 0.2999, 0.2967, 0.3008, 0.2998, 0.2938], [0.3784, 0.3751, 0.377, 0.3934, 0.3762, 0.3826, 0.3965, 0.3768, 0.3778, 0.3873, 0.3818, 0.382, 0.3836, 0.3857, 0.3875, 0.3907, 0.3788, 0.3866, 0.3913, 0.3851, 0.3891, 0.3877, 0.3935, 0.3895, 0.3877, 0.3955, 0.3909, 0.3893, 0.3918, 0.3878, 0.388, 0.3946, 0.3994, 0.383, 0.3947, 0.3905, 0.396, 0.3951, 0.3959, 0.3941, 0.3884, 0.3887, 0.3896, 0.3896, 0.3854, 0.3803, 0.3916, 0.3941, 0.3921, 0.3958, 0.3872, 0.3883, 0.3904, 0.3919, 0.3982, 0.3918, 0.3906, 0.388, 0.4003, 0.3872, 0.3939, 0.3938, 0.3905, 0.4002, 0.3882, 0.3909, 0.3913, 0.4019, 0.3959, 0.3993, 0.3857, 0.3869, 0.3949, 0.3909, 0.4019, 0.385, 0.4001, 0.3903, 0.3942, 0.3965, 0.3884, 0.3996, 0.3979, 0.3911, 0.3853, 0.3953, 0.3892, 0.3944, 0.398, 0.3968, 0.3871, 0.3971, 0.3939, 0.3968, 0.4045, 0.3932, 0.3913, 0.3979, 0.395, 0.3981, 0.3945]]
#ATD_total = [[0.0525, 0.0475, 0.0491, 0.0442, 0.0477, 0.0443, 0.0427, 0.043, 0.0414, 0.042, 0.0423, 0.0399, 0.0363, 0.0401, 0.0391, 0.0359, 0.0359, 0.0355, 0.0375, 0.037, 0.0312, 0.0369, 0.0346, 0.0346, 0.0308, 0.0333, 0.0308, 0.0305, 0.0299, 0.0314, 0.0278, 0.0292, 0.0324, 0.0284, 0.0291, 0.0285, 0.027, 0.0299, 0.0276, 0.0268, 0.0273, 0.0276, 0.0275, 0.0252, 0.0284, 0.0271, 0.0271, 0.027, 0.0272, 0.0236, 0.0246, 0.0274, 0.0249, 0.0258, 0.025, 0.0262, 0.0265, 0.0241, 0.023, 0.0238, 0.0234, 0.0219, 0.0238, 0.0232, 0.0241, 0.0192, 0.0227, 0.02, 0.0197, 0.0226, 0.0194, 0.0212, 0.0218, 0.0227, 0.0232, 0.0199, 0.0236, 0.0223, 0.0183, 0.0206, 0.0194, 0.0232, 0.0206, 0.0188, 0.0187, 0.018, 0.0178, 0.0218, 0.0202, 0.0184, 0.0182, 0.0202, 0.0194, 0.0194, 0.0188, 0.0186, 0.0195, 0.0198, 0.0177, 0.0175, 0.021], [0.0944, 0.0995, 0.0975, 0.0969, 0.099, 0.0976, 0.09, 0.0935, 0.0975, 0.0947, 0.1001, 0.0931, 0.0917, 0.1007, 0.0969, 0.0906, 0.0959, 0.1001, 0.0916, 0.0974, 0.0961, 0.0961, 0.098, 0.0985, 0.0978, 0.0955, 0.0925, 0.0946, 0.0925, 0.0965, 0.0918, 0.0901, 0.0941, 0.0904, 0.0938, 0.0921, 0.0964, 0.0902, 0.0906, 0.0949, 0.0971, 0.0937, 0.0976, 0.1006, 0.0945, 0.0917, 0.0945, 0.0975, 0.0907, 0.0956, 0.0925, 0.0936, 0.094, 0.0913, 0.0919, 0.0922, 0.0953, 0.0897, 0.0919, 0.0966, 0.0919, 0.0889, 0.0917, 0.0977, 0.0923, 0.0922, 0.1001, 0.0909, 0.1012, 0.0979, 0.0945, 0.0914, 0.0949, 0.0935, 0.0966, 0.0912, 0.0983, 0.0939, 0.0966, 0.0947, 0.0991, 0.0958, 0.096, 0.0959, 0.0968, 0.0941, 0.0911, 0.0922, 0.0913, 0.0919, 0.0957, 0.095, 0.0959, 0.0986, 0.0915, 0.0932, 0.0932, 0.0925, 0.0948, 0.0925, 0.0938], [0.2011, 0.2001, 0.1962, 0.1985, 0.1941, 0.1979, 0.2002, 0.2017, 0.1999, 0.1962, 0.1981, 0.1969, 0.2034, 0.1926, 0.1976, 0.2012, 0.202, 0.1992, 0.2018, 0.1971, 0.2039, 0.2083, 0.2077, 0.1991, 0.2076, 0.2012, 0.1971, 0.1974, 0.205, 0.2058, 0.2086, 0.201, 0.2006, 0.203, 0.199, 0.2005, 0.2054, 0.2005, 0.2006, 0.2049, 0.2041, 0.2104, 0.208, 0.2049, 0.2021, 0.198, 0.2047, 0.2035, 0.2097, 0.1999, 0.1984, 0.2065, 0.2034, 0.202, 0.2044, 0.2013, 0.1998, 0.2066, 0.2046, 0.193, 0.201, 0.2043, 0.195, 0.1921, 0.1992, 0.2036, 0.2012, 0.2047, 0.1976, 0.2025, 0.2003, 0.2081, 0.201, 0.2033, 0.2042, 0.1998, 0.1945, 0.1992, 0.2078, 0.2018, 0.2036, 0.2051, 0.1978, 0.1958, 0.2004, 0.2079, 0.2002, 0.207, 0.2015, 0.2055, 0.2053, 0.2023, 0.203, 0.2029, 0.2028, 0.1959, 0.2056, 0.2044, 0.2052, 0.2039, 0.2001], [0.2917, 0.2847, 0.2823, 0.2875, 0.2892, 0.2852, 0.2915, 0.2862, 0.2802, 0.2902, 0.289, 0.2948, 0.2973, 0.2911, 0.2853, 0.29, 0.2906, 0.2974, 0.2862, 0.29, 0.2901, 0.2848, 0.2805, 0.2896, 0.2877, 0.2899, 0.2933, 0.2838, 0.2952, 0.2901, 0.2952, 0.2952, 0.2909, 0.3009, 0.295, 0.2921, 0.2853, 0.2953, 0.2984, 0.2915, 0.2907, 0.2896, 0.2866, 0.2965, 0.2907, 0.2984, 0.2867, 0.2921, 0.2882, 0.2895, 0.2939, 0.2862, 0.2944, 0.2902, 0.2916, 0.2891, 0.292, 0.2957, 0.2918, 0.2955, 0.3042, 0.2983, 0.2988, 0.2904, 0.3011, 0.2937, 0.2936, 0.295, 0.2962, 0.2887, 0.2939, 0.2981, 0.299, 0.2928, 0.2947, 0.301, 0.2968, 0.2955, 0.2963, 0.2922, 0.3047, 0.2911, 0.2952, 0.3026, 0.3002, 0.2903, 0.3041, 0.2932, 0.2936, 0.3027, 0.2969, 0.2887, 0.293, 0.2925, 0.2975, 0.2971, 0.2946, 0.3009, 0.2923, 0.3013, 0.2963], [0.3603, 0.3682, 0.3749, 0.3729, 0.37, 0.375, 0.3756, 0.3756, 0.381, 0.3769, 0.3705, 0.3753, 0.3713, 0.3755, 0.3811, 0.3823, 0.3756, 0.3678, 0.3829, 0.3785, 0.3787, 0.3739, 0.3792, 0.3782, 0.3761, 0.3801, 0.3863, 0.3937, 0.3774, 0.3762, 0.3766, 0.3845, 0.382, 0.3773, 0.3831, 0.3868, 0.3859, 0.3841, 0.3828, 0.3819, 0.3808, 0.3787, 0.3803, 0.3728, 0.3843, 0.3848, 0.387, 0.3799, 0.3842, 0.3914, 0.3906, 0.3863, 0.3833, 0.3907, 0.3871, 0.3912, 0.3864, 0.3839, 0.3887, 0.3911, 0.3795, 0.3866, 0.3907, 0.3966, 0.3833, 0.3913, 0.3824, 0.3894, 0.3853, 0.3883, 0.3919, 0.3812, 0.3833, 0.3877, 0.3813, 0.3881, 0.3868, 0.3891, 0.381, 0.3907, 0.3732, 0.3848, 0.3904, 0.3869, 0.3839, 0.3897, 0.3868, 0.3858, 0.3934, 0.3815, 0.3839, 0.3938, 0.3887, 0.3866, 0.3894, 0.3952, 0.3871, 0.3824, 0.39, 0.3848, 0.3888]]
'''


#This Block creates a graph for K=5 with a staggered decrease of the sigmas. Takes 3 days or so.
'''
thetas = [x/10.0 for x in range(50, 151, 1)]

sigmas = [10, 5, 3, 1.5, 0]
nus = [0.01, 0.09, 0.2, 0.3, 0.4]
graph_dists = [[],[],[],[],[]] # first index is type, second index is theta.
AL_dists = [[],[],[],[],[]]
STD_total = [[],[],[],[],[]]
ATD_total = [[],[],[],[],[]]
dark_red = (0.4, 0, 0)
bright_red = (0.9, 0.1, 0.1)

dark_green = (0, 0.4, 0)
bright_green = (0.1, 0.9, 0.1)

dark_blue = (0, 0, 0.4)
bright_blue = (0.2, 0.2, 1)

dark_yellow = (0.2, 0.2, 0)
bright_yellow = (0.8, 0.8, 0)

dark_purple = (0.2, 0, 0.4)
bright_purple = (0.7, 0.2, 1)

for theta in thetas:
    graph_dist, AL_dist, ATD, STD = main(sigmas, theta, 10, nus, 10000, False)[:4]
    for i in range(len(graph_dist)):
        graph_dists[i].append(graph_dist[i]/sum(graph_dist))
        AL_dists[i].append(AL_dist[i]/sum(AL_dist))
        STD_total[i].append(STD[i]/sum(STD))
        ATD_total[i].append(ATD[i]/sum(ATD))

plt.xlabel("θ")
plt.ylabel("Type proportion in graph or AL")
parameters = [(dark_red, bright_red), (dark_green, bright_green),(dark_blue, bright_blue),(dark_yellow, bright_yellow),(dark_purple, bright_purple)] #(index, colour AL, colour graph, label)
for i in range(len(parameters)):
    graph_color, AL_color = parameters[i]
    plt.plot(thetas, graph_dists[i], color = graph_color)
    for x in [6, 7, 8, 9, 10, 11, 12, 13, 14]:
        plt.plot(x, STD_total[i][(x-5)*10], "x", color = graph_color)
    if i == 3:
        plt.annotate("Type "+str(i)+" G", xy=(15, graph_dists[i][-1]), xytext=(15.15, graph_dists[i][-1]+0.0025), size=7, va="center", annotation_clip=False)
        plt.annotate("Type "+str(i)+" AL", xy=(15, AL_dists[i][-1]), xytext=(15.15, AL_dists[i][-1]-0.003), size=7, va="center", annotation_clip=False)
    else:
        plt.annotate("Type "+str(i)+" G", xy=(15, graph_dists[i][-1]), xytext=(15.15, graph_dists[i][-1]), size=7, va="center", annotation_clip=False)
        plt.annotate("Type "+str(i)+" AL", xy=(15, AL_dists[i][-1]), xytext=(15.15, AL_dists[i][-1]), size=7, va="center", annotation_clip=False)
    plt.plot(thetas, AL_dists[i], color = AL_color)
    for x in [6, 7, 8, 9, 10, 11, 12, 13, 14]:
        plt.plot(x, ATD_total[i][(x-5)*10], "x", color = AL_color)
    plt.xlim(5, 15)
plt.show()

print(graph_dists)
print(AL_dists)
print(STD_total)
print(ATD_total)

#Stats for sigmas = [10, 5, 3, 1.5, 0], nus = [0.01, 0.09, 0.2, 0.3, 0.4],  theta 5 to 15 in 0.1 increments.
#graph_dists = [[0.08754342992596147, 0.08558912375171956, 0.08093815884220011, 0.07844319238400413, 0.07518131242382736, 0.07356872377898724, 0.07090140798528641, 0.06872169392012824, 0.06580065800529855, 0.06443766549585488, 0.06259155911886737, 0.061248064868424226, 0.058744212175237155, 0.058277553108920334, 0.05666832540159406, 0.05487764934054379, 0.0529055828215386, 0.05195367055903719, 0.05040292627823714, 0.04914354748822889, 0.048797082284202, 0.046952849712586696, 0.045423259011695596, 0.04531488852863418, 0.043701194582613984, 0.04353052338425255, 0.04204909593988748, 0.041262846006743605, 0.04037479191750539, 0.039472559632052526, 0.03906726348848334, 0.037904788730089616, 0.037209917519587576, 0.03685213975986235, 0.03634736766512452, 0.036123155383398706, 0.03513188253247603, 0.03472859338275802, 0.03394938649248706, 0.03389308244806794, 0.03321808086926292, 0.03250143286431205, 0.03211928466313795, 0.03201546280361449, 0.03165265357823549, 0.031008227803808405, 0.030310822158420417, 0.03032172626011525, 0.030133970236092184, 0.029262043179340412, 0.02898566266790299, 0.028318966582929723, 0.028233107564385237, 0.02795612630998632, 0.027753386360821877, 0.027315976149223795, 0.02674399944948711, 0.026607704275986844, 0.026515179866239795, 0.026340204344161483, 0.02593688897676736, 0.02576836531372589, 0.025466738711673587, 0.02522752305567097, 0.02508057982870782, 0.024661492781370413, 0.024920080223525, 0.024137616267246947, 0.02392264033618409, 0.023760848225190177, 0.023582695722832364, 0.023509731650345856, 0.023424418230916472, 0.023107092976079695, 0.022930183833205785, 0.02278680444096924, 0.022633853987841374, 0.022638256758172742, 0.022233535030857583, 0.021961221863984533, 0.022032344722224484, 0.022057992837343623, 0.02172407039083219, 0.02169496652450296, 0.021264333500549043, 0.021304449379670017, 0.02105516606905001, 0.020794464834617072, 0.020864648172686052, 0.02067489545041391, 0.02056525393458712, 0.02015145598247446, 0.02032812448320155, 0.02030111389480958, 0.020293263768268958, 0.019902385011369414, 0.019683932143526466, 0.019664893528233845, 0.0196639986831797, 0.0196609732782725, 0.019381172816951446], [0.1519603143997549, 0.15044024358388008, 0.14939783512763477, 0.14980497075419638, 0.1483952373786567, 0.1474131810334948, 0.1461627185773712, 0.14599684206567468, 0.1451544397053817, 0.14422997366118875, 0.1441246905384201, 0.1428335102073956, 0.14223503111987337, 0.1410553631288727, 0.1414308318693088, 0.13985145782356986, 0.13975228100454365, 0.13825598651918036, 0.13825393399261188, 0.13758612106168966, 0.13646410766474085, 0.1360745206196786, 0.13569995558382503, 0.13515842531997033, 0.1343283657801674, 0.1337655749177608, 0.13307218701304105, 0.1333315864187108, 0.13275680157009015, 0.13143899469379863, 0.13205717856581276, 0.13128884917573616, 0.13038535772405582, 0.1298261721145038, 0.12949454229504578, 0.1286892637441861, 0.12805426944611217, 0.12813006369256516, 0.1279996180723617, 0.12773427182709557, 0.12698594273783945, 0.1263869692386999, 0.12627101171753427, 0.12553030915934157, 0.12496246329630016, 0.12481375671084359, 0.12459957895891982, 0.12427764223846409, 0.12383289957427131, 0.12310737554813422, 0.123151779055099, 0.12275163639896364, 0.12280741875641238, 0.12208289645100596, 0.1219315328622119, 0.12175131274607962, 0.1211049831450521, 0.12096941604613046, 0.12084873210787477, 0.12041987907658955, 0.12037281625691282, 0.12013976985548645, 0.11975125988855474, 0.11935378925003347, 0.11924245998140233, 0.1189620027616245, 0.11801877533554539, 0.11833628398503188, 0.1177190312784932, 0.11797396161483364, 0.11774694118137928, 0.11747194896869385, 0.11718958506430245, 0.11648616733308055, 0.11663266927395802, 0.11663908018713198, 0.11638862636171464, 0.11608191011497039, 0.11580746281488437, 0.11573811447129087, 0.11549584170501233, 0.11505978693354763, 0.11532227855813244, 0.11492178763855217, 0.11449551138667285, 0.11434182481569373, 0.11452697761649591, 0.11402608330963622, 0.11371320862133805, 0.11348846060244605, 0.11366161868610558, 0.11365237563712342, 0.11334456821493756, 0.1129830375107071, 0.11292245146864655, 0.11250933491443046, 0.11279414362157787, 0.11258434862884932, 0.11215194258161756, 0.11223071786370058, 0.11201866556097786], [0.22221316580063322, 0.22153425276182023, 0.2231842810518689, 0.22265073658315876, 0.2235359263553179, 0.2230432951711387, 0.22330306116810383, 0.22404821110370834, 0.22400498502180377, 0.22349425399068784, 0.22294559470164305, 0.22424732840168418, 0.2245530660502954, 0.22430049443140482, 0.2234009754713128, 0.2243632720879738, 0.22387635394387212, 0.2243743414203438, 0.22393246204311773, 0.22408678887923947, 0.2233001092520619, 0.22402579821309293, 0.2239086857114891, 0.2239658058607849, 0.22388994706060858, 0.22371770075233288, 0.22327172492764433, 0.22325818349272258, 0.2235201974317751, 0.2240551589759338, 0.22245308233980748, 0.22295183245230848, 0.22312048916001057, 0.222512528259431, 0.22284407866794312, 0.22226555836112283, 0.222916567214313, 0.22183855334805233, 0.22230936477931537, 0.22221081432527143, 0.22196918175423247, 0.22173794335330685, 0.22172909429082935, 0.22223537282314323, 0.22196677423949232, 0.22159011138679474, 0.22143354510675475, 0.22077743665688748, 0.22041361638470033, 0.22155739350975595, 0.22086762484087474, 0.22083712469130415, 0.22079999645976672, 0.2209226854971056, 0.22080732156747007, 0.2199258972403665, 0.22019854616090503, 0.2205094656866093, 0.21974704412617585, 0.21950118903517732, 0.21948316732297515, 0.21986502718067644, 0.2191078652418472, 0.21950545834418025, 0.2193378284658933, 0.21920658615658925, 0.2188809596862636, 0.21922862288790856, 0.21892239138207018, 0.21877342651111994, 0.21915200453178854, 0.21811678808200163, 0.2186348464492313, 0.21838863972259417, 0.21797904447459185, 0.21807266838296502, 0.21785868450847673, 0.2174522055265806, 0.21758535269026727, 0.2177571234457882, 0.21748978440064018, 0.21717552228940368, 0.2172555157391652, 0.2170131042813483, 0.21697999024848047, 0.2174442267059114, 0.21712897764436095, 0.21659946006495998, 0.21649171035061254, 0.21676807866914644, 0.21606735101622537, 0.21679038084789562, 0.216809439103449, 0.21641567824353863, 0.21591027501406598, 0.2160702339088208, 0.21644436900205247, 0.21606809415349879, 0.21610407794607633, 0.2158624987775502, 0.21575052548298904], [0.258279812258734, 0.2608600587529516, 0.2616648250836383, 0.2629968949516815, 0.26433611250760314, 0.264918910136908, 0.26649079841241186, 0.26730495549222827, 0.2685275512289136, 0.2699152469637462, 0.2709310481290274, 0.27121691767220946, 0.27213114732548477, 0.27247976030993987, 0.2736374995367758, 0.2745056455323244, 0.2752033598001057, 0.2755828369697494, 0.27654158304495524, 0.27697086978153646, 0.2777154639359995, 0.27816977126186304, 0.278659015248765, 0.27851671247492016, 0.28040313275137563, 0.28019269399698293, 0.2809362024428019, 0.28117005670351203, 0.2811898858698554, 0.2818500848550915, 0.28204682718214985, 0.28294703661658654, 0.2833640317759965, 0.2834214741471776, 0.28426290163003687, 0.28416122680788825, 0.2844351548966881, 0.28491479819244425, 0.28479588723916727, 0.2851742970508543, 0.285420053243022, 0.2858568444713891, 0.2857968679277514, 0.2861431046403515, 0.2869793972092287, 0.28671674743635117, 0.2874189161376617, 0.28734839446784466, 0.28783113135618016, 0.2878860059029115, 0.2879684098836386, 0.2886478481627529, 0.2884082767902029, 0.28880472218991854, 0.2886613113209154, 0.28926427452929476, 0.2895668337319215, 0.2893109213226086, 0.2896841916286634, 0.2897876726639315, 0.28961440600114974, 0.2895332239978304, 0.29044756076148726, 0.2905650196909043, 0.29017936029030006, 0.29035347582419957, 0.2907528299842895, 0.2909692830244528, 0.29124402653477255, 0.29095895539682964, 0.2913072001864696, 0.29146502289317305, 0.2915211616872055, 0.2917535096691544, 0.29240184313197376, 0.2915050594478459, 0.2921061608450774, 0.2919406719699964, 0.2925033280320105, 0.2922721482567327, 0.2925042930598678, 0.2926793701064055, 0.2926402224887649, 0.29251426140913267, 0.29281618709192314, 0.2929112837898611, 0.2926275387666912, 0.2931937494456366, 0.29310653033251294, 0.29319685365153697, 0.2933810208455671, 0.29371618986207476, 0.29302141699416046, 0.2932673238096693, 0.29384540273282345, 0.2937312273696918, 0.2936499320993368, 0.2939165285623382, 0.2939264575395995, 0.29407809373008864, 0.2939418771920334], [0.28000327761491645, 0.28157632114962855, 0.28481489989465786, 0.28610420532695924, 0.2885514113345949, 0.29105588987947134, 0.29314201385682664, 0.2939282974182605, 0.2965123660386025, 0.2979228598885223, 0.29940710751204197, 0.3004541788502866, 0.3023365433291092, 0.3038868290208622, 0.3048623677210085, 0.3064019752155882, 0.30826242242993995, 0.3098331645316892, 0.310869094641078, 0.31221267278930553, 0.31372323686299575, 0.3147770601927788, 0.3163090844442253, 0.3170441678156905, 0.3176773598252345, 0.3187935069486708, 0.32067078967662527, 0.320977327378311, 0.322158323210774, 0.32318320184312355, 0.3243756484237466, 0.3249074930252791, 0.3259202038203495, 0.32738768571902527, 0.32705110974184975, 0.32876079570340416, 0.32946212591041063, 0.3303879913841802, 0.33094574341666855, 0.3309875343487108, 0.3324067413956432, 0.333516810072292, 0.334083741400747, 0.3340757505735492, 0.33443871167674327, 0.33587115666220213, 0.33623713763824337, 0.3372748003766885, 0.337788382448756, 0.3381871818598578, 0.33902652355248475, 0.3394444241640497, 0.33975120042923274, 0.3402335695519836, 0.3408464478885808, 0.3417425393350354, 0.3423856375126342, 0.3426024926686647, 0.3432048522710462, 0.34395105488014005, 0.34459272144219494, 0.3446936136522809, 0.3452265753964372, 0.34534820965921104, 0.3461597714336964, 0.3468164424762162, 0.3474273547703765, 0.3473281938353598, 0.3481919104684801, 0.3485328082520266, 0.3482111583775303, 0.3494365084057855, 0.3492299885683443, 0.3502645902990912, 0.35005625928627065, 0.350996387541088, 0.35101267429689, 0.35188695563027994, 0.3518703214319802, 0.35227139196220364, 0.35247773611225514, 0.3530273278332996, 0.3530579128231052, 0.35385588014646396, 0.35444397777237446, 0.35399821530886366, 0.3546613399034019, 0.35538624234515015, 0.35582390252285034, 0.3558717116264566, 0.35632475551751475, 0.3556895976704318, 0.35649645120425144, 0.35703284654127543, 0.3570286070161951, 0.3577868187956876, 0.3574276231335064, 0.35776613512707994, 0.358153523249527, 0.3581677163503882, 0.35890775894704835]]
#AL_dists = [[0.16594762582608097, 0.16227151251336738, 0.15356562286822023, 0.15001554990293411, 0.14468626609252966, 0.14183006907757917, 0.1377261063291742, 0.13306141226828175, 0.12854895453928133, 0.12592473860296347, 0.12292794769838132, 0.12106051707168948, 0.1154287948237295, 0.11425706272843313, 0.11202396802720653, 0.10876603418146456, 0.10494475290223577, 0.10255176900004309, 0.09983330649740142, 0.09703840785125478, 0.09681798580634061, 0.09320293033546263, 0.09013082717891285, 0.0899877317042366, 0.08687876342421044, 0.08634958297930848, 0.08328253858476546, 0.08105805042025058, 0.0804990068991811, 0.07789775294356906, 0.07726125726644241, 0.07448722922505792, 0.07334737062145776, 0.07239973150865257, 0.07153910214682974, 0.07014313120469778, 0.06874848916656164, 0.06729924970994361, 0.06632546199429305, 0.06574956404714447, 0.06404796978364187, 0.06267714569967954, 0.061282479030934534, 0.06176555229324064, 0.06054283351117426, 0.05948680758595741, 0.05828681618311799, 0.05805178636876546, 0.057145520492354863, 0.055124818924268966, 0.05501905609372198, 0.05314636330534275, 0.05316101076629294, 0.05271962498170393, 0.052270971170998076, 0.05093782892025042, 0.04932352347493315, 0.04941036288485175, 0.049047091294987535, 0.04892088689222437, 0.04771158307034505, 0.0475256305441837, 0.04622247836777176, 0.046192010157419326, 0.04593231952132559, 0.04474132601037177, 0.04520054825895969, 0.04374169213343403, 0.04325561834851077, 0.04241814852850957, 0.04252661644285287, 0.04190559517322065, 0.0417419386876304, 0.04087675455292889, 0.040612514720399395, 0.04031176851355749, 0.04004224369686588, 0.039930208077088095, 0.03869460191402956, 0.038035446997817586, 0.038362446529982275, 0.038077438395909345, 0.037737887591560326, 0.037502122025320876, 0.03670580539524113, 0.036601825980176715, 0.035943296180649335, 0.03563929745344665, 0.035630129348091504, 0.03534242785522248, 0.03488303351175768, 0.03376045266340779, 0.033971330177662344, 0.03423652823109523, 0.03423851289062686, 0.03329842102167244, 0.03282340114350113, 0.0329446960193096, 0.032663954265032664, 0.03265157327660648, 0.03184794610956561], [0.1979624375379457, 0.19456917564831208, 0.19415279555247844, 0.19368802295899915, 0.19285105041468986, 0.19084443351226044, 0.189268848902678, 0.1882467542395195, 0.18743325688299622, 0.1869621588652072, 0.18640515373734254, 0.18484999017161463, 0.18401268170888344, 0.18179291100325448, 0.1821161684655683, 0.17938993790476582, 0.1801672375078708, 0.1779066832193934, 0.17808219769069478, 0.1771819011851915, 0.17506970701043767, 0.1757860044961874, 0.17414137766845586, 0.1735437664948704, 0.1711471558148093, 0.17111259784460295, 0.1701751606777003, 0.17126475777302147, 0.16974948690541247, 0.16640778389096447, 0.16780319090339577, 0.16698185581280536, 0.1650181167203545, 0.16432801276511239, 0.1634164147268999, 0.16290368915886358, 0.16224355426287, 0.1623015607713129, 0.16190280336880808, 0.16073972269410375, 0.16064096800623734, 0.15953995537609958, 0.15923684705574048, 0.1572260569108522, 0.15585716120816467, 0.1566576927934026, 0.1556922036952163, 0.15566476657863718, 0.15511260429329565, 0.15283830370141224, 0.15388422350931033, 0.15296907428913473, 0.1530720806266086, 0.1511316758690701, 0.1514481315942683, 0.15166342865539803, 0.15056133939921773, 0.15013499546131584, 0.14821468061238344, 0.1487870216678658, 0.148778766348606, 0.14843821341605587, 0.14791178642495015, 0.14696399037453248, 0.14619440104949466, 0.14648225629290143, 0.1441149244787102, 0.14499168151724903, 0.14387115081482726, 0.14401049409757202, 0.14325900796097532, 0.14354493596197052, 0.14340605685476684, 0.14198541247299132, 0.1420565698791605, 0.1421117262894252, 0.141311734728208, 0.14113092593666243, 0.14050567734617506, 0.14061537272563956, 0.13966202158008778, 0.1385059707736734, 0.139199345427306, 0.1383202038232376, 0.1375897324889912, 0.13710330793893274, 0.1383314836140546, 0.1368035204988139, 0.1365215907220554, 0.13695800994431054, 0.13690654724457862, 0.1364560952989915, 0.13559905878428916, 0.13557429359823048, 0.1347832445351332, 0.1335962446593176, 0.13408067350212485, 0.13403700861905482, 0.13331928813694727, 0.13335931183950697, 0.13344700752787195], [0.2250917212780855, 0.22503317545676266, 0.2273068130620191, 0.22723731472766628, 0.22904645959062583, 0.22804400713389247, 0.22914937881075387, 0.23143206494121046, 0.23160672754549955, 0.23052837946807148, 0.2301578230600041, 0.2321221143886202, 0.23396840880712202, 0.23375261213249288, 0.23189236490942564, 0.23330694267031704, 0.23315896947996997, 0.2340277618079317, 0.23312883046399122, 0.23413955351830418, 0.2334838183945767, 0.2345043434335928, 0.23497557348334097, 0.235023537304586, 0.2355247637973548, 0.23433841754683832, 0.23418436794025554, 0.23494314287870785, 0.23374630636940077, 0.2374552280253982, 0.23426406289513646, 0.23490945465398197, 0.235695764727295, 0.23347566146440388, 0.23501881276542572, 0.23428399366482516, 0.235075847138092, 0.23348043548132488, 0.23371959443645254, 0.23509230413889443, 0.23546739175200268, 0.23449627875900148, 0.23499120776818896, 0.23499467297957083, 0.23534586847862238, 0.23415358677995007, 0.23430950497653638, 0.2332418885093708, 0.23243140172988414, 0.23411141022067816, 0.23377911241755503, 0.2328951888165148, 0.23310936917189665, 0.23384894663960057, 0.23390040499197257, 0.23254252042511814, 0.23308961794793281, 0.23369769374137195, 0.23275160009266463, 0.2321575999526508, 0.23201763880540424, 0.2322900650154304, 0.23122764619165123, 0.23282911176458268, 0.23248866362562717, 0.23270607292110923, 0.23163160829900475, 0.23213523904028818, 0.23237693310783095, 0.23237502386203637, 0.2318644518340717, 0.2310141974186128, 0.23117638024625345, 0.23165054254498707, 0.23052257530235165, 0.23115100844510822, 0.22998963565306635, 0.2302030439237577, 0.23063407909004624, 0.23126300653684134, 0.230468934545097, 0.2296584307755547, 0.22914331590408088, 0.2301550769151373, 0.23019662600605748, 0.22977800293396372, 0.22984530107863158, 0.2286648750743998, 0.22940264585823977, 0.2283006731127199, 0.22791668335380694, 0.22971564783470602, 0.22983685041389906, 0.2286346212607968, 0.22792840528268246, 0.22845490491614448, 0.22896030946610005, 0.22839223195467734, 0.22836198166361568, 0.22778117574873968, 0.2276445316330814], [0.21540982946524703, 0.21959748408170124, 0.2226255436857417, 0.22326495616479927, 0.2255202888923025, 0.22691871366955527, 0.2290872016427021, 0.2319747489150986, 0.23363779557090494, 0.23508148856284383, 0.23743040810598173, 0.23735016956883548, 0.23979474825822733, 0.24017141628630576, 0.24255707702207138, 0.24391656853825439, 0.24444017059987164, 0.2456623727439862, 0.24866473467886957, 0.24912401846855092, 0.24946220489515541, 0.25093589295702023, 0.25197789958237526, 0.2529984395930087, 0.2542420955504389, 0.2549756285396103, 0.2558419700751973, 0.2558717925250278, 0.25754838622395165, 0.2580635997239125, 0.25866601700759745, 0.26097322878739476, 0.2607822316688981, 0.26159685089483803, 0.26360526370205584, 0.262776148895095, 0.2628766773868008, 0.26551126463083424, 0.26570490491832743, 0.2646803038184511, 0.2644229798932098, 0.2669504822127156, 0.26676382759875916, 0.2677349563586596, 0.26928781019852455, 0.2687645372020589, 0.270482676730996, 0.26997795610262043, 0.2707376791174094, 0.2718192526144319, 0.2713982612628286, 0.27332845329239625, 0.27256450270812904, 0.2737432207014383, 0.27249957950891546, 0.2735395537523406, 0.2740522751978173, 0.2745015534370374, 0.2756324956033005, 0.27551876688085225, 0.27569018438093984, 0.2753111250163798, 0.2767191329157707, 0.27639969573528406, 0.27668979484521383, 0.2762398114065772, 0.2775795087957999, 0.2779049691176299, 0.27827033302630066, 0.27840441237243024, 0.27915956930105557, 0.2788012996233012, 0.27919224148032484, 0.27954970250842515, 0.2809257166425431, 0.2798134363209584, 0.2803195303647149, 0.2800334722581566, 0.28123441372061203, 0.28057892804337503, 0.28157835243846796, 0.282018299222609, 0.28286738663112126, 0.2816549475871008, 0.28273636633561255, 0.28303125032093196, 0.2822614475043069, 0.2832303029884988, 0.2833506043292451, 0.2835620455871144, 0.283730870902908, 0.28385961211009814, 0.28266401109696554, 0.2841144204624497, 0.28428776197038436, 0.28475070909998546, 0.2848000685456598, 0.2846194516496104, 0.2851056209273152, 0.28595717361018436, 0.2852786049644536], [0.1955883858926408, 0.19852865229985664, 0.2023492248315405, 0.20579415624560113, 0.2078959350098521, 0.21236277660671268, 0.2147684643146918, 0.21528501963588964, 0.21877326546131787, 0.22150323450091397, 0.2230786673982903, 0.22461720879924016, 0.2267953664020378, 0.2300259978495137, 0.23141042157572814, 0.23462051670519823, 0.23728886951005182, 0.2398514132286456, 0.24029093066904306, 0.24251611897669864, 0.24516628389348957, 0.2455708287777369, 0.24877432208691508, 0.2484465249032983, 0.2522072214131866, 0.25322377308964, 0.2565159627220813, 0.25686225640299226, 0.258456813602054, 0.2601756354161557, 0.26200547192742785, 0.26264823152075994, 0.2651565162619947, 0.2681997433669932, 0.2664204066587888, 0.2698930370765184, 0.2710554320456755, 0.27140748940658443, 0.27234723528211885, 0.2737381053014062, 0.27542069056490837, 0.2763361379525038, 0.2777256385463768, 0.27827876145767677, 0.2789663266035142, 0.280937375638631, 0.28122879841413334, 0.2830636024406061, 0.284572794367056, 0.28610621453920865, 0.28591934671658403, 0.2876609202966115, 0.2880930367270728, 0.2885565318081871, 0.2898809127338456, 0.29131666824689284, 0.29297324398009905, 0.29225539447542304, 0.29435413239666386, 0.2946157246064068, 0.29580182739470484, 0.29643496600795016, 0.29791895609985614, 0.29761519196818154, 0.2986948209583387, 0.29983053336904036, 0.3014734101675255, 0.3012264181913988, 0.3022259647025304, 0.30279192113945175, 0.30319035446104453, 0.30473397182289486, 0.3044833827310245, 0.30593758792066766, 0.30588262345554534, 0.30661206043095063, 0.3083368555571448, 0.3087023498043352, 0.3089312279291371, 0.3095072456963264, 0.309928244906365, 0.3117398608322535, 0.3110520644459315, 0.31236764964920344, 0.3127714697740976, 0.3134856128259948, 0.31361847162235756, 0.3156620039848408, 0.3150950297423682, 0.31583684350063274, 0.31656286498694886, 0.31620819209279655, 0.317928749527184, 0.3174401364474277, 0.3187620753211732, 0.31989972030287994, 0.31933554734261416, 0.32000661175734785, 0.3205491550070892, 0.32025076552496257, 0.32178190976502746]]
#STD_total = [[0.0844, 0.087, 0.0764, 0.0748, 0.0746, 0.0754, 0.0742, 0.0684, 0.0661, 0.0663, 0.0627, 0.0596, 0.0639, 0.0545, 0.0603, 0.0576, 0.0567, 0.0516, 0.0507, 0.0503, 0.0481, 0.0487, 0.0476, 0.0444, 0.0443, 0.0419, 0.0417, 0.04, 0.0403, 0.0411, 0.0396, 0.0392, 0.038, 0.035, 0.0401, 0.0389, 0.0361, 0.0296, 0.0346, 0.0299, 0.0344, 0.0346, 0.0315, 0.0305, 0.0339, 0.0316, 0.032, 0.0297, 0.0288, 0.0297, 0.0283, 0.0266, 0.0276, 0.0272, 0.0286, 0.0274, 0.0271, 0.0268, 0.0257, 0.0252, 0.0266, 0.0261, 0.0254, 0.0237, 0.0245, 0.0241, 0.0267, 0.0242, 0.0225, 0.0239, 0.023, 0.0233, 0.0229, 0.0235, 0.0252, 0.0234, 0.0228, 0.0232, 0.0229, 0.0234, 0.0209, 0.0236, 0.0244, 0.02, 0.0206, 0.0232, 0.0228, 0.0226, 0.0193, 0.02, 0.0209, 0.0213, 0.0198, 0.0194, 0.019, 0.0205, 0.0176, 0.0194, 0.0194, 0.0207, 0.0185], [0.1546, 0.1505, 0.1498, 0.1487, 0.1481, 0.1493, 0.1423, 0.1466, 0.1455, 0.1491, 0.1479, 0.1421, 0.1421, 0.1362, 0.1436, 0.1381, 0.1457, 0.1359, 0.143, 0.1359, 0.1341, 0.14, 0.1324, 0.1399, 0.1345, 0.1335, 0.1337, 0.131, 0.1332, 0.1352, 0.1249, 0.1359, 0.1328, 0.1355, 0.1334, 0.1349, 0.1298, 0.1306, 0.1294, 0.1257, 0.125, 0.1252, 0.1277, 0.126, 0.1222, 0.1296, 0.1207, 0.1201, 0.1262, 0.1239, 0.125, 0.1284, 0.1204, 0.1217, 0.1199, 0.1215, 0.1205, 0.1238, 0.1238, 0.1207, 0.119, 0.1234, 0.1236, 0.121, 0.121, 0.1217, 0.1181, 0.1164, 0.116, 0.117, 0.1169, 0.1155, 0.1214, 0.1184, 0.1127, 0.1163, 0.1111, 0.1144, 0.1215, 0.1131, 0.1164, 0.1171, 0.1173, 0.1115, 0.1159, 0.1127, 0.1143, 0.1094, 0.1114, 0.1108, 0.111, 0.1179, 0.1193, 0.1086, 0.1177, 0.1223, 0.1109, 0.1144, 0.1144, 0.1078, 0.1087], [0.2166, 0.2168, 0.2245, 0.2276, 0.2241, 0.2254, 0.2244, 0.2206, 0.2262, 0.2177, 0.2242, 0.2232, 0.2212, 0.2217, 0.2184, 0.2174, 0.2264, 0.222, 0.2231, 0.2217, 0.2251, 0.2221, 0.2281, 0.222, 0.2231, 0.2271, 0.2201, 0.2312, 0.229, 0.2189, 0.2257, 0.2237, 0.2251, 0.2215, 0.2182, 0.2139, 0.2275, 0.2221, 0.2206, 0.2311, 0.2241, 0.224, 0.2222, 0.2214, 0.2189, 0.2233, 0.2256, 0.2215, 0.2217, 0.2264, 0.2166, 0.2278, 0.2242, 0.2191, 0.2135, 0.2203, 0.2213, 0.218, 0.2238, 0.2212, 0.2217, 0.224, 0.2191, 0.2092, 0.2224, 0.2153, 0.2213, 0.2132, 0.2186, 0.2221, 0.2278, 0.2187, 0.2157, 0.2252, 0.2148, 0.2203, 0.2155, 0.2284, 0.2246, 0.2232, 0.2217, 0.2131, 0.2125, 0.215, 0.2207, 0.2218, 0.2202, 0.2201, 0.2182, 0.2084, 0.2143, 0.2147, 0.2181, 0.2211, 0.2154, 0.2153, 0.2193, 0.2153, 0.217, 0.2242, 0.2159], [0.2589, 0.2626, 0.264, 0.2683, 0.2588, 0.2629, 0.2629, 0.2661, 0.2695, 0.2682, 0.2749, 0.27, 0.2742, 0.2807, 0.2797, 0.2768, 0.2655, 0.2738, 0.2676, 0.282, 0.2798, 0.2783, 0.2761, 0.2802, 0.2785, 0.2802, 0.2839, 0.2792, 0.2854, 0.2831, 0.2829, 0.2797, 0.2868, 0.2781, 0.2854, 0.2875, 0.2806, 0.2869, 0.2836, 0.2837, 0.2793, 0.2819, 0.2899, 0.285, 0.2851, 0.283, 0.2895, 0.2906, 0.2841, 0.2882, 0.2947, 0.2857, 0.2904, 0.2884, 0.2906, 0.2863, 0.2901, 0.2991, 0.291, 0.2951, 0.2874, 0.2905, 0.2928, 0.2897, 0.284, 0.291, 0.2901, 0.2947, 0.2916, 0.2893, 0.283, 0.2915, 0.2984, 0.2865, 0.296, 0.2917, 0.2947, 0.2859, 0.2901, 0.2842, 0.2923, 0.2944, 0.2894, 0.2917, 0.2926, 0.2951, 0.2947, 0.2902, 0.2981, 0.2965, 0.2989, 0.2948, 0.2886, 0.2944, 0.2921, 0.2954, 0.2915, 0.2946, 0.2906, 0.2924, 0.2887], [0.2855, 0.2831, 0.2853, 0.2806, 0.2944, 0.287, 0.2962, 0.2983, 0.2927, 0.2987, 0.2903, 0.3051, 0.2986, 0.3069, 0.298, 0.3101, 0.3057, 0.3167, 0.3156, 0.3101, 0.3129, 0.3109, 0.3158, 0.3135, 0.3196, 0.3173, 0.3206, 0.3186, 0.3121, 0.3217, 0.3269, 0.3215, 0.3173, 0.3299, 0.3229, 0.3248, 0.326, 0.3308, 0.3318, 0.3296, 0.3372, 0.3343, 0.3287, 0.3371, 0.3399, 0.3325, 0.3322, 0.3381, 0.3392, 0.3318, 0.3354, 0.3315, 0.3374, 0.3436, 0.3474, 0.3445, 0.341, 0.3323, 0.3357, 0.3378, 0.3453, 0.336, 0.3391, 0.3564, 0.3481, 0.3479, 0.3438, 0.3515, 0.3513, 0.3477, 0.3493, 0.351, 0.3416, 0.3464, 0.3513, 0.3483, 0.3559, 0.3481, 0.3409, 0.3561, 0.3487, 0.3518, 0.3564, 0.3618, 0.3502, 0.3472, 0.348, 0.3577, 0.353, 0.3643, 0.3549, 0.3513, 0.3542, 0.3565, 0.3558, 0.3465, 0.3607, 0.3563, 0.3586, 0.3549, 0.3682]]
#ATD_total = [[0.1691, 0.1654, 0.1531, 0.1469, 0.144, 0.1378, 0.137, 0.1307, 0.1292, 0.1329, 0.1211, 0.1198, 0.1144, 0.1107, 0.1114, 0.1035, 0.1066, 0.1025, 0.1025, 0.1002, 0.0948, 0.0917, 0.092, 0.0898, 0.0905, 0.0867, 0.0839, 0.0803, 0.08, 0.0779, 0.0793, 0.0732, 0.0716, 0.0734, 0.0677, 0.0684, 0.0649, 0.0691, 0.0665, 0.0636, 0.0617, 0.0656, 0.0629, 0.0586, 0.0618, 0.0567, 0.0563, 0.0558, 0.059, 0.0558, 0.0547, 0.0592, 0.0542, 0.0488, 0.055, 0.0503, 0.0538, 0.0495, 0.0524, 0.0478, 0.0464, 0.0455, 0.0466, 0.0486, 0.048, 0.0446, 0.043, 0.0431, 0.0432, 0.0392, 0.0385, 0.0391, 0.0398, 0.042, 0.0391, 0.0371, 0.0382, 0.0391, 0.041, 0.0365, 0.0406, 0.0363, 0.0355, 0.0395, 0.0357, 0.037, 0.0349, 0.0348, 0.0409, 0.0348, 0.0333, 0.032, 0.0352, 0.0348, 0.0344, 0.0353, 0.0312, 0.0348, 0.0351, 0.0294, 0.0316], [0.1926, 0.1944, 0.1972, 0.1978, 0.1963, 0.1951, 0.1882, 0.187, 0.185, 0.1787, 0.1923, 0.1865, 0.1869, 0.1855, 0.1771, 0.1857, 0.1863, 0.1739, 0.1839, 0.1839, 0.1743, 0.1729, 0.1696, 0.1729, 0.1661, 0.1789, 0.1723, 0.1658, 0.1678, 0.168, 0.1664, 0.164, 0.1731, 0.1598, 0.1656, 0.1658, 0.1589, 0.1673, 0.1617, 0.1587, 0.1621, 0.1606, 0.1625, 0.1608, 0.1617, 0.1622, 0.1574, 0.1554, 0.1508, 0.1569, 0.1532, 0.1522, 0.1471, 0.1534, 0.1491, 0.1513, 0.1542, 0.1565, 0.149, 0.145, 0.1508, 0.1448, 0.1453, 0.1488, 0.1468, 0.1484, 0.1461, 0.1394, 0.1438, 0.1429, 0.1451, 0.1456, 0.1489, 0.1407, 0.1489, 0.1339, 0.1405, 0.1443, 0.1415, 0.1412, 0.1442, 0.1451, 0.141, 0.1398, 0.1403, 0.1366, 0.1386, 0.1412, 0.1385, 0.1357, 0.1416, 0.1379, 0.1282, 0.1351, 0.1353, 0.1361, 0.1315, 0.1319, 0.131, 0.1342, 0.1349], [0.2245, 0.2295, 0.2275, 0.228, 0.2271, 0.2307, 0.2303, 0.2284, 0.2308, 0.2332, 0.2315, 0.2342, 0.2318, 0.2381, 0.2331, 0.2338, 0.2312, 0.2384, 0.238, 0.2205, 0.2418, 0.2325, 0.2382, 0.2278, 0.2406, 0.2292, 0.2301, 0.2323, 0.2325, 0.2311, 0.2313, 0.241, 0.2289, 0.2339, 0.2302, 0.2304, 0.2384, 0.2266, 0.2384, 0.2353, 0.2335, 0.2338, 0.2359, 0.2282, 0.2377, 0.237, 0.2306, 0.2363, 0.2296, 0.2298, 0.2375, 0.2277, 0.2379, 0.2423, 0.231, 0.2345, 0.2332, 0.2305, 0.2343, 0.2357, 0.2338, 0.2357, 0.2319, 0.2355, 0.2287, 0.2267, 0.233, 0.2352, 0.2357, 0.2431, 0.2296, 0.2336, 0.2358, 0.2344, 0.229, 0.2392, 0.2305, 0.2336, 0.226, 0.2369, 0.2298, 0.2362, 0.233, 0.23, 0.2292, 0.229, 0.2359, 0.2359, 0.2279, 0.2277, 0.2352, 0.233, 0.2336, 0.2318, 0.2255, 0.2279, 0.2305, 0.2221, 0.2273, 0.2279, 0.237], [0.2152, 0.2115, 0.219, 0.2216, 0.2277, 0.2294, 0.2295, 0.2335, 0.2368, 0.2301, 0.2303, 0.2347, 0.2443, 0.2404, 0.2493, 0.2418, 0.2419, 0.2406, 0.2423, 0.246, 0.2512, 0.2567, 0.251, 0.2548, 0.2484, 0.2534, 0.2578, 0.2612, 0.2537, 0.2609, 0.2639, 0.2619, 0.2576, 0.268, 0.2638, 0.2608, 0.272, 0.2663, 0.2659, 0.2717, 0.2601, 0.2726, 0.2647, 0.2677, 0.2659, 0.2619, 0.2668, 0.2662, 0.2716, 0.2716, 0.2796, 0.267, 0.274, 0.2696, 0.2736, 0.2692, 0.2724, 0.2739, 0.2709, 0.2764, 0.2712, 0.2828, 0.2787, 0.2766, 0.2797, 0.2698, 0.2724, 0.2835, 0.2784, 0.2767, 0.2882, 0.2842, 0.2733, 0.2716, 0.2797, 0.2836, 0.2805, 0.2812, 0.2803, 0.2765, 0.2847, 0.2773, 0.2813, 0.2774, 0.2769, 0.2898, 0.2808, 0.2764, 0.284, 0.2818, 0.2754, 0.2835, 0.2753, 0.2791, 0.2833, 0.2872, 0.2904, 0.2851, 0.2886, 0.2874, 0.2844], [0.1986, 0.1992, 0.2032, 0.2057, 0.2049, 0.207, 0.215, 0.2204, 0.2182, 0.2251, 0.2248, 0.2248, 0.2226, 0.2253, 0.2291, 0.2352, 0.234, 0.2446, 0.2333, 0.2494, 0.2379, 0.2462, 0.2492, 0.2547, 0.2544, 0.2518, 0.2559, 0.2604, 0.266, 0.2621, 0.2591, 0.2599, 0.2688, 0.2649, 0.2727, 0.2746, 0.2658, 0.2707, 0.2675, 0.2707, 0.2826, 0.2674, 0.274, 0.2847, 0.2729, 0.2822, 0.2889, 0.2863, 0.289, 0.2859, 0.275, 0.2939, 0.2868, 0.2859, 0.2913, 0.2947, 0.2864, 0.2896, 0.2934, 0.2951, 0.2978, 0.2912, 0.2975, 0.2905, 0.2968, 0.3105, 0.3055, 0.2988, 0.2989, 0.2981, 0.2986, 0.2975, 0.3022, 0.3113, 0.3033, 0.3062, 0.3103, 0.3018, 0.3112, 0.3089, 0.3007, 0.3051, 0.3092, 0.3133, 0.3179, 0.3076, 0.3098, 0.3117, 0.3087, 0.32, 0.3145, 0.3136, 0.3277, 0.3192, 0.3215, 0.3135, 0.3164, 0.3261, 0.318, 0.3211, 0.3121]]
'''


#This block is used to create the graphs comparing the simulated wright distribution to known approximations. This takes 4 hours or so.
'''

R = 1000
repeats = 1000

v_thetas = [0.1,0.2,0.4,0.6,0.8,1,2,3,6,9] #Werte von Valentin gegeben.
#nu_1 = 0.5
num_1 = [0.7119725072118052, 0.6957749954837704, 0.6697737893650771, 0.6498263168237766, 0.6340442619469369, 0.6212498062904156, 0.5819767068693265, 0.5618589641650846, 0.5355734760867416, 0.5249481020305815]
mon_1 = [0.6758324240324383, 0.693929294906331, 0.6683083728960554, 0.6469312314036597, 0.6301717694896575, 0.6246365975632896, 0.5878866613085397, 0.5640520614284776, 0.5361178924342253, 0.5237119916754287]
amon_1 = [0.673, 0.6816, 0.6725, 0.6576, 0.6311, 0.6261, 0.5835, 0.5561, 0.5376, 0.5234]

#nu_1 = 0.7
num_2 = [0.5164485207797755, 0.49823458444530966, 0.46935706268740496, 0.44755155161985893, 0.43054772479404746, 0.4169436679207351, 0.3763832790978482, 0.35644485172394347, 0.33145598709453206, 0.3217494452758858]
mon_2 = [0.5031167807250224, 0.49975175933980354, 0.4771497472760027, 0.44778078140157795, 0.4338975560600203, 0.42157725633749604, 0.38273153732174425, 0.35764292256490754, 0.33131470822432363, 0.32098951850093943]
amon_2 = [0.4883, 0.4896, 0.4672, 0.4319, 0.4241, 0.4153, 0.368, 0.3576, 0.339, 0.3207]


thetas = [x / 10.0 for x in range(1, 91, 1)] #from 0.1 to 9
for (nus, num, mon, amon) in [([0.5, 0.5], num_1, mon_1, amon_1), ([0.3, 0.7], num_2, mon_2, amon_2)]:
    wright = []
    s = [1, 0]
    K = 2
    for theta in thetas:
        total_dist = [0,0]
        for i in range(repeats):
            print(i)
            L_R, eventlist = generate_graph(s, theta, R, nus)
            ancestors = generate_potential_ancestors(L_R, theta, nus, s, dirichlet=False)

            type_dist= type_graph(ancestors, eventlist, K, R)[0]
            type_dist = [x/sum(type_dist) for x in type_dist]
            total_dist = [sum(x) for x in zip(total_dist, type_dist)]
        wright.append(total_dist[0]/repeats)

    plt.plot(thetas, wright, color = 'tab:red', label = "Simulation")
    plt.plot(v_thetas, num, "x", color = 'tab:green', label = "Numerical integration")
    plt.plot(v_thetas, amon, "d", color = 'tab:blue', label = "Wright estimator")
    plt.plot(v_thetas, mon, "+", color = 'tab:orange', label = "Monte-Carlo estimator")

    title = "Wright distributed approximation of Type 0 with ν\u2081 = " + str(nus[1])
    plt.title(title)
    plt.legend(loc="upper right")
    plt.xlabel("θ")
    plt.ylabel("Type 0 proportion")
    print(wright)
    plt.show()

#Values used for the plots:
#nu_1 = 0.5: [0.7097450491544322, 0.6941172683292449, 0.6802355741327356, 0.6695187979255046, 0.6588276128098219, 0.6491373111254265, 0.6420323205660435, 0.6320396283025614, 0.6265599648146473, 0.6214029442101235, 0.6164162813368836, 0.6090473151900656, 0.6051004136291624, 0.6019158964198073, 0.5977427524006831, 0.593385150923638, 0.5903211565398574, 0.5874497134666018, 0.5845673335626741, 0.5816929495117871, 0.5797647944439721, 0.576698985893421, 0.5748234489946459, 0.5724929815626884, 0.5701762477591161, 0.5683872451114461, 0.5672193810735482, 0.5648441559183205, 0.5634635146965711, 0.5618311122328359, 0.5602004609048068, 0.5587271847331367, 0.5581086179177096, 0.5558525583023399, 0.5548971939031684, 0.5543158732809993, 0.552981314001065, 0.5517043950534087, 0.550651385044, 0.5494058532217762, 0.5487005517526017, 0.547512927186553, 0.5468770360649933, 0.5456026826587287, 0.5455395478808831, 0.544079623461915, 0.5431205107643876, 0.5434358451383616, 0.5423164303614403, 0.5420899087681392, 0.5411240674704465, 0.5398003953512308, 0.5395088966685333, 0.5384464284267029, 0.5384279990581994, 0.5377401113931964, 0.5373320757229298, 0.536780772344471, 0.5358837830377233, 0.5355655269599683, 0.5350490066952388, 0.5345930995435336, 0.5340679291486246, 0.5338137963644364, 0.5329676895813531, 0.5329246132597877, 0.5325227884461498, 0.5316946544798726, 0.5312727805282159, 0.5312184977008094, 0.5309756099759171, 0.5306452026470885, 0.5299280481687532, 0.5297129617747286, 0.5290079788846301, 0.5292132342858364, 0.5283411830005702, 0.5285312937808888, 0.5280854911064978, 0.5277740202607334, 0.5275528646837587, 0.5269982298270995, 0.5265943639677058, 0.5266525641902063, 0.5260507714179048, 0.5257907825585367, 0.5256515529611226, 0.5254129317135847, 0.5254086974785355, 0.5249680415093921]
#nu_1 = 0.7: [0.5111598016921808, 0.5001193308121601, 0.48046071265620904, 0.4658772023877831, 0.4576678102550987, 0.44742557068277267, 0.4385560391985007, 0.4305075876913022, 0.42373026266254604, 0.41602520325251713, 0.4094265803090974, 0.406337943001574, 0.40197315513724646, 0.39655054115146066, 0.3919022926695121, 0.3885264137134085, 0.38545969406850844, 0.3819688631113325, 0.3788268652952946, 0.3764809162700989, 0.3739647504222352, 0.37066086797882175, 0.3692407097862311, 0.366836151650701, 0.3651508273560101, 0.3628561530101619, 0.3614735984415934, 0.35968940825164336, 0.3579850846319422, 0.3561873597808828, 0.35465756190583037, 0.35348968580267537, 0.3522441317618935, 0.35145501105274174, 0.34970565983800905, 0.34883338795154006, 0.34786630370108873, 0.3463666718027909, 0.345245184109034, 0.34432873871013436, 0.34414786970766825, 0.3429840290956091, 0.3417216934857639, 0.34102634322475467, 0.3406242732963814, 0.33983247397966554, 0.33865056387327336, 0.3383452554302026, 0.3374114154517988, 0.3369970458309655, 0.33604587238267974, 0.33607345900981356, 0.3348255158236317, 0.33466263716043804, 0.3341944448107845, 0.33356057594284716, 0.33282766449365986, 0.33234972093901355, 0.3317062427274511, 0.33103680022233517, 0.33107014790930794, 0.33042847227676514, 0.33026147309235604, 0.32950587104369744, 0.329129770727899, 0.3289435152286459, 0.32870178856538407, 0.32785000654539115, 0.3276761295734396, 0.3272912022818055, 0.3267080924538734, 0.326824082444032, 0.32620524846742316, 0.325668364286234, 0.3255921063315481, 0.3253359387173733, 0.32525865634238715, 0.3244314022862017, 0.32476862261234374, 0.3242736870358942, 0.32405273974999427, 0.32368754318328113, 0.3235509163917804, 0.3231610489291896, 0.3229463958860067, 0.32246228395833293, 0.3223842846910146, 0.32221940222294904, 0.321923869012554, 0.3214118437772405]
'''

#Code segment used to generate comparison of Wright distributions and ancestral type distribution for different Ns. This takes 2 hours or so.
'''
from infinite import wright_expected_value #E[X_inf]
from infinite import altbigp #E[h(X_inf)]
import math

def special_z (theta, sigma0, nu0): #z_inf
    return 1/2*(1-(theta/sigma0)+math.sqrt( math.pow(1-(theta/sigma0), 2) + 4*(theta/sigma0)*nu0 ) )

def special_p (theta, sigma0, nu1):
    first = (theta+sigma0)/(theta*nu1)
    first_sq = ((theta+sigma0)/(theta*nu1))**2
    second_sq = 4*sigma0/(theta*nu1)
    return 1/2*(first-math.sqrt(first_sq-second_sq))


def special_h (theta, sigma0, v): #h(z_inf)
    sum = 0
    n = 0
    while True:
        p = special_p(theta, sigma0, v[1])
        z = special_z (theta, sigma0, v[0])
        new_v = z*(1-z)**n*p**n
        n += 1
        sum += new_v
        if new_v < 0.001:
            return sum

from infinite import generate_graph, generate_potential_ancestors
import numpy.random as random

rng = random.default_rng()

def simple_sim(R, sigmas, theta, nus):#Only take rates / ASG distribution for a factor of R and above 
    L_R, eventlist = generate_graph(sigmas, theta, R, nus)
    individuals = generate_potential_ancestors(L_R, theta, nus, sigmas, False)
    asgen_type_distribution = [0, 0]
    last_r = R

    for event in reversed(eventlist):
        for individual in individuals:
            asgen_type_distribution[individual.typ] += last_r - event.r
        last_r = event.r
        event.apply_event_forward(individuals)

    for individual in individuals:#Finally, add the time from the last event
        asgen_type_distribution[individual.typ] += last_r


    return individuals[0].ancestor_type, asgen_type_distribution

parameters = [(500, 100), (1000, 100), (2000, 100)]
wright_calc = [[],[],[]]
atd_calc = [[],[],[]]
wright_sim = [[],[],[]]
atd_sim = [[],[],[]]
v = [0.1, 0.9]
thetas = 0
sigmas = 0
sim_thetas=0
repeats = 35000

for i in range(len(parameters)):
    N, R= parameters[i]
    thetas = [(x / 100000.0) * N for x in range(1, 151, 1)]
    sigmas = [N*0.001, 0]
    wright_calc[i] = [wright_expected_value(sigmas[0], theta, v) for theta in thetas]
    atd_calc[i] = [altbigp(theta, sigmas[0], v) for theta in thetas]
    sim_thetas = [(x / 100000.0) * N for x in range(15, 151, 15)]
    for theta in sim_thetas:
        total_wright_dist = [0,0]
        total_anc_dist = [0,0]

        for j in range(repeats):
            print("Curve:", i, "Theta:", theta, "Repeat:",j)
            anc_type, graph_dist = simple_sim(R, sigmas, theta, v)
            graph_dist = [x/sum(graph_dist) for x in graph_dist]
            total_wright_dist = [sum(x) for x in zip(total_wright_dist, graph_dist)]
            total_anc_dist[anc_type] += 1

        total_wright_dist = [x/repeats for x in total_wright_dist]
        wright_sim[i].append(total_wright_dist)
        atd_sim[i].append(total_anc_dist)
    wright_sim[i] = [x[0]/sum(x) for x in wright_sim[i]]
    atd_sim[i] = [x[0]/sum(x) for x in atd_sim[i]]
    
thetas = [x/sigmas[0] for x in thetas]
sim_thetas = [x/sigmas[0] for x in sim_thetas]

plt.figure(1)
plt.xlabel("θ/σ")
plt.ylabel("Type 0 proportion in graph")
plt.plot(thetas, wright_calc[0], color = 'tab:red', label = "N=500")
plt.plot(thetas, wright_calc[1], color = 'tab:green', label = "N=1000")
plt.plot(thetas, wright_calc[2], color = 'tab:purple', label = "N=2000")
plt.plot(sim_thetas, wright_sim[0], "x", color = 'tab:red')
plt.plot(sim_thetas, wright_sim[1], "x", color = 'tab:green')
plt.plot(sim_thetas, wright_sim[2], "x", color = 'tab:purple')
plt.legend(loc="upper right")
plt.show()

plt.figure(2)
plt.xlabel("θ/σ")
plt.ylabel("Type 0 proportion in ATD")
plt.plot(thetas, atd_calc[0], color = 'tab:red', label = "N=500")
plt.plot(thetas, atd_calc[1], color = 'tab:green', label = "N=1000")
plt.plot(thetas, atd_calc[2], color = 'tab:purple', label = "N=2000")
plt.plot(sim_thetas, atd_sim[0], "x", color = 'tab:red')
plt.plot(sim_thetas, atd_sim[1], "x", color = 'tab:green')
plt.plot(sim_thetas, atd_sim[2], "x", color = 'tab:purple')
plt.legend(loc="upper right")
plt.show()
print(wright_sim)
print(atd_sim)


#Values used for crosses as in the prints above
#[0.14975221798650795, 0.14845219881555566, 0.14409541983105956, 0.1416665046590333, 0.13865030167453601, 0.1361253498459502, 0.13445252281766698, 0.13278841963539947, 0.13151725173660045, 0.1301500719100052]
#[0.2137726184430556, 0.19675966847452522, 0.1855832179994481, 0.17590572489795261, 0.16872649527789924, 0.16253929027055694, 0.15702259616833963, 0.15251427094286038, 0.14904675628824454, 0.14532940315438275]
#[0.35908703955279825, 0.3015015694105335, 0.26287851566718196, 0.23488984259671453, 0.21445151237358656, 0.19916251174726773, 0.186995236572517, 0.17725616748121997, 0.16923025410435524, 0.16300038343721465]
#[0.1523142857142857, 0.15265714285714285, 0.14662857142857144, 0.1486, 0.14534285714285713, 0.14225714285714286, 0.13711428571428572, 0.14037142857142856, 0.1384857142857143, 0.13845714285714286]
#[0.22237142857142858, 0.21042857142857144, 0.20605714285714286, 0.19617142857142858, 0.19108571428571428, 0.18405714285714286, 0.17868571428571428, 0.17331428571428573, 0.16685714285714287, 0.1606]
#[0.38754285714285713, 0.3482857142857143, 0.3166, 0.29045714285714286, 0.26685714285714285, 0.24774285714285715, 0.2344857142857143, 0.22337142857142858, 0.21448571428571428, 0.20782857142857142]
#Assignment ready to copy:

#[[0.1499925400274473, 0.1476205906288912, 0.14402823280519061, 0.1410068533693815, 0.13800042588192998, 0.13632195747102768, 0.1345392399334798, 0.13289224973202265, 0.13072753569606327, 0.1300621565587653], [0.2104336451958716, 0.196979664516361, 0.18536590785050516, 0.17576298898499407, 0.16791680239138435, 0.16178055301175087, 0.15753198921069916, 0.15268393319903883, 0.14895701803609684, 0.14521919271760877], [0.35830876046306787, 0.300990041500324, 0.2616381431783026, 0.2343662584061483, 0.21401726026166654, 0.19874767448746122, 0.18676799583002898, 0.1769981777071855, 0.16925377912078365, 0.16252683409056398]]
#[[0.14957142857142858, 0.14868571428571428, 0.14685714285714285, 0.14811428571428573, 0.144, 0.1422857142857143, 0.14245714285714287, 0.13768571428571427, 0.13854285714285713, 0.14085714285714285], [0.2184, 0.21254285714285714, 0.2014857142857143, 0.19505714285714285, 0.18857142857142858, 0.1808, 0.17525714285714286, 0.177, 0.16934285714285716, 0.16385714285714287], [0.39074285714285717, 0.34822857142857144, 0.3162857142857143, 0.2881142857142857, 0.2668285714285714, 0.2504, 0.23737142857142857, 0.22477142857142857, 0.2134, 0.20768571428571428]]
'''


#Code segment used to prove the validity of the analytical methods. Compare Baake, Wakolbinger 2018. This should only take a few minutes
'''
import math
from infinite import wright_expected_value #E[X_inf]
from infinite import altbigp #E[h(X_inf)]

def special_z (theta, sigma0, nu0): #z_inf
    return 1/2*(1-(theta/sigma0)+math.sqrt( math.pow(1-(theta/sigma0), 2) + 4*(theta/sigma0)*nu0 ) )

def special_p (theta, sigma0, nu1):
    first = (theta+sigma0)/(theta*nu1)
    first_sq = ((theta+sigma0)/(theta*nu1))**2
    second_sq = 4*sigma0/(theta*nu1)
    return 1/2*(first-math.sqrt(first_sq-second_sq))

def special_h (theta, sigma0, v): #h(z_inf)
    sum = 0
    n = 0
    while True:
        p = special_p(theta, sigma0, v[1])
        z = special_z (theta, sigma0, v[0])
        new_v = z*(1-z)**n*p**n
        n += 1
        sum += new_v
        if new_v < 0.001:
            return sum

parameters = [(20000, 15), (60000, 2), (200000, 0.5)]
wright_calc = [[],[],[],[]]
atd_calc = [[],[],[],[]]
wright_sim = [[],[],[]]
atd_sim = [[],[],[]]
v = [0.005, 0.995]
thetas = 0
sigmas = 0

for i in range(len(parameters)):
    N, R= parameters[i]
    thetas = [(x / 100000.0) * N for x in range(1, 151, 1)]
    sigmas = [N*0.001, 0]
    wright_calc[i] = [wright_expected_value(sigmas[0], theta, v) for theta in thetas]
    atd_calc[i] = [altbigp(theta, sigmas[0], v) for theta in thetas]

wright_calc[3] = [special_z(theta, sigmas[0], v[0]) for theta in thetas]
atd_calc[3] = [special_h(theta, sigmas[0], v) for theta in thetas]
thetas = [x/sigmas[0] for x in thetas]

plt.figure(1)
plt.xlabel("θ/σ", fontsize = 13)
plt.ylabel("E[X ͚]", fontsize = 20)
plt.plot(thetas, wright_calc[0], color = 'tab:red', label = "N=2000")
plt.plot(thetas, wright_calc[1], color = 'tab:green', label = "N=6000")
plt.plot(thetas, wright_calc[2], color = 'tab:purple', label = "N=20000")
plt.plot(thetas, wright_calc[3], color = 'tab:blue', label = "z ͚")
plt.legend(loc="upper right")
plt.xticks([0,0.5,1,1.5])
plt.yticks([0,0.5,1])
plt.xlim(-0.02, 1.52)
plt.ylim(-0.02, 1.05)
plt.show()

plt.figure(2)
plt.xlabel("θ/σ", fontsize = 13)
plt.ylabel("E[h(X ͚)]", fontsize = 20)
plt.plot(thetas, atd_calc[0], color = 'tab:red', label = "N=2000")
plt.plot(thetas, atd_calc[1], color = 'tab:green', label = "N=6000")
plt.plot(thetas, atd_calc[2], color = 'tab:purple', label = "N=20000")
plt.plot(thetas, atd_calc[3], color = 'tab:blue', label = "z ͚")
plt.legend(loc="upper right")
plt.xticks([0,0.5,1,1.5])
plt.yticks([0,0.5,1])
plt.xlim(-0.02, 1.52)
plt.ylim(-0.02, 1.05)
plt.show()
'''

#Code Segment used to compare the L_r distributions.

'''
R = 100
sigmas = [3, 0]
theta = 0.5
nus = [0.3, 0.7]
repeats = 100000

anc_dist = 0
L_R_dist = [0]*20
L_r_calculated_dist = [0]*20

for i in range(repeats):
    print(i)
    _, L_R, _= generate_graph(sigmas, theta, R, nus)
    L_R_dist[L_R] += 1
for i in range(len(L_r_calculated_dist)):
    L_r_calculated_dist[i] = L_inf_dist(i, sigmas[0])
L_R_dist = [x/sum(L_R_dist) for x in L_R_dist]
print(L_R_dist)
#Values used for Graph. L_R_dist = [0.0, 0.15726, 0.23496, 0.23693, 0.17707, 0.10541, 0.053, 0.02264, 0.00869, 0.00272, 0.00091, 0.00034, 5e-05, 1e-05, 1e-05, 0.0, 0.0, 0.0, 0.0, 0.0]



x = np.arange(1,11)
values = {
    'x=∞' : tuple(L_r_calculated_dist)[1:11],
    'x=R' : tuple(L_R_dist)[1:11],
}

width = 0.25
multiplier = 0

plt.figure(1)

for name, values in values.items():
    offset = width * multiplier
    plt.bar(x + offset-width/2, values, width, label=name)
    multiplier += 1

plt.xlabel('n')
plt.ylabel('P(L\u2093 = n)')
plt.xticks(x, [str(i) for i in x])
plt.legend(loc='upper right')
plt.show()
'''


#This block compares the average L_R to the analytical value for a sliding theta
'''

R = 100
sigmass = [[x/10, 0] for x in range(1,51)]
theta = 0.5
nus = [0.3, 0.7]
repeats = 10000
L_R_dist = [0]*20
L_r_calculated_dist = [0]*20
calculated_avg = []
L_R_avg = []



for sigmas in sigmass:
    
    for i in range(repeats):
        print("sigma:", sigmas, "repeat:", i)
        _, L_R, _= generate_graph(sigmas, theta, R, nus) [:3]
        L_R_dist[L_R] += 1 
    for i in range(1,len(L_r_calculated_dist)):
        L_r_calculated_dist[i] = L_inf_dist(i, sigmas[0])
    L_R_dist = [x/sum(L_R_dist) for x in L_R_dist][0:]
    avg = 0
    for i in range(len(L_r_calculated_dist)):
        avg += i*L_r_calculated_dist[i]
    calculated_avg.append(avg)
    avg = 0
    for i in range(len(L_R_dist)):
        avg += i*L_R_dist[i]
    L_R_avg.append(avg)
print(L_R_avg)
#L_R_avg = [1.0489, 1.1054943405659434, 1.1521953299010663, 1.2177934401889712, 1.2737943999040287, 1.3364937300669837, 1.392694379935013, 1.4575935100869846, 1.5156941899320155, 1.570594509967996, 1.638893170133983, 1.724491440172996, 1.7828941597280448, 1.8658917002459485, 1.9180947796920556, 1.997692040273942, 2.0684929199120368, 2.1476920800839827, 2.237491020105998, 2.30839290981103, 2.403390500240957, 2.4912912099290314, 2.567992329888004, 2.647192080024986, 2.7021944997580265, 2.818188400609915, 2.8847933395061105, 2.967391740159935, 3.0417925599180244, 3.155088670388953, 3.246490859781061, 3.340690580027976, 3.4405900100569973, 3.5173923197690287, 3.6278889503369434, 3.7203907498200524, 3.827589280146967, 3.8782949294350715, 3.9755902704658963, 4.052292329794066, 4.155089720260953, 4.26358915005702, 4.394486910223984, 4.458793569334088, 4.537592120144919, 4.647888970314982, 4.766688120085026, 4.875689099902018, 4.919695599350055, 5.0511868508748465]


sigmass = [x[0] for x in sigmass]

plt.plot(sigmass, calculated_avg, color = 'tab:green', label = "x=∞", linewidth=3)
plt.plot(sigmass, L_R_avg, color = 'tab:red', label = "x=R", linewidth=1.5)

plt.xlabel('σ\u2080')
plt.ylabel('E[L\u2093]')
plt.legend(loc='upper left')
plt.show()
'''
